{"version":3,"file":"index.js","sources":["../src/interface/canvas.js","../src/interface/node.js","../src/interface/endpoint.js","../src/endpoint/baseEndpoint.js","../src/node/baseNode.js","../src/utils/link.js","../src/utils/arrow.js","../src/utils/link_animate.js","../src/interface/edge.js","../src/edge/baseEdge.js","../src/interface/group.js","../src/utils/scopeCompare.js","../src/group/baseGroup.js","../src/utils/layout/circleLayout.js","../src/utils/layout/fruchterman.js","../src/utils/layout/gridLayout.js","../src/utils/layout/forceLayout.js","../src/utils/layout/concentLayout.js","../src/utils/layout/drageLayout.js","../src/utils/layout/radial/mds.js","../src/utils/layout/radial/radialNonoverlapForce.js","../src/utils/layout/radial/math.js","../src/utils/layout/radial/radial.js","../src/utils/layout/layout.js","../src/utils/selectCanvas.js","../src/utils/coordinate.js","../src/utils/girdService.js","../src/utils/guidelineService.js","../src/utils/minimap.js","../src/canvas/baseCanvas.js","../src/node/treeNode.js","../src/utils/layout/hierarchy/index.js","../src/canvas/treeCanvas.js","../src/utils/toolTip.js","../index.js"],"sourcesContent":["'use strict';\n\nconst EventEmit3 = require('eventemitter3');\n\nclass Canvas extends EventEmit3 {\n  constructor() {\n    // root             根节点\n    // layout           布局支持\n    // zoomable         是否可放大缩小\n    // moveable         是否可移动\n    // draggable        是否可拖动节点\n    // linkable         是否可连接线条\n    // disLinkable      是否可取消连线\n    // theme            主题配置\n    // global           公共配置\n    super();\n  }\n\n  // 渲染节点\n  draw() {}\n\n  // 获取节点\n  getNode() {}\n\n  // 获取线条\n  getEdge() {}\n\n  // 获取节点组\n  getGroup() {}\n\n  // 添加节点\n  addNode() {}\n\n  // 批量添加节点\n  addNodes() {}\n\n  // 添加线条\n  addEdge() {}\n\n  // 批量添加线条\n  addEdges() {}\n\n  // 批量添加节点组\n  addGroups() {}\n\n  // 删除节点\n  removeNode() {} \n\n  // 批量删除节点\n  removeNodes() {}\n\n  // 删除线条\n  removeEdge() {}\n\n  // 批量删除线条\n  removeEdges() {}\n\n  // 删除节点组\n  removeGroup() {}\n\n  // 获取相邻的线条\n  getNeighborEdges() {}\n\n  // 获取相邻的节点\n  getNeighborNodes() {}\n\n  // 获取无环血缘图\n  getNeighborNodesAndEdgesByLevel() {}\n  getAdjcentTable() {} // 需要改为内部方法\n\n  // 获取缩放值\n  getZoom() {}\n  // 动态设置可缩放\n  setZoomable() {}\n  // 动态设置缩放值\n  zoom() {}\n\n  // 获取偏移值\n  getOffset() {}\n  // 动态设置可移动\n  setMoveable() {}\n  // 动态设置移动\n  move() {}\n\n  // 获取中心点\n  getOrigin() {}\n  // 动态设置中心点\n  setOrigin() {}\n\n  // 获取数据结构\n  getDataMap() {}\n\n  // 设置网格模式\n  setGirdMode() {}\n  // 设置网格线条\n  setGuideLine() {}\n  // 设置辅助线\n  justifyCoordinate() {}\n\n  // 设置框选模式\n  setSelectMode() {}\n\n  // 设置某些联合值，即框选的元素\n  getUnion() {}\n  // 设置所有联合值，即框选的元素\n  getAllUnion() {}\n\n  // 添加联合值\n  add2Union() {}\n  // 删除某些联合值\n  removeUnion() {}\n  // 删除所有联合值\n  removeAllUnion() {}\n\n  // 聚焦单个节点（看看需要合并不）\n  focusNodeWithAnimate() {}\n  // 聚焦某些节点\n  focusNodesWithAnimate() {}\n\n  // 画布坐标转换为终端坐标\n  canvas2terminal() {}\n  // 终端坐标转换为画布坐标\n  terminal2canvas() {}\n\n  // 保存为图片\n  save2img() {}\n\n  // ********* 需要优化的api ********* \n  \n  // 更新画布的大小 \n  updateRootResize() {}\n\n  // ********* 需要新增的api ********* \n\n  // 单击的回调\n  click() {}\n\n  // 双击的回调\n  doubleClick() {}\n\n  // 右键的回调\n  onContextmenu() {}\n\n  // 集成menu\n\n  // 生成/关闭缩略图\n  \n}\n\n\nexport default Canvas;\n","'use strict';\n\nconst EventEmit3 = require('eventemitter3');\n\nclass Node extends EventEmit3 {\n  constructor() {\n    // id        节点唯一标志\n    // top       坐标y\n    // left      坐标x\n    // group     存在于哪个节点组上\n    // dom       节点的dom元素\n    // draggable 该节点是否能拖动标志，可覆盖全局的\n    // options   数据的透传\n    // _on       节点发送事件\n    // _emit     节点发送事件\n    // _global   全局的配置\n\n\n    // 需要优化的\n    // scope           scope相同可拉进group里面\n    // endpoints       endpoint对象\n    // _endpointsData  真实的endpoint数据\n    // _isMoving       标识是否在移动做，兼容冒泡\n    super();\n  }\n\n  // 渲染节点\n  draw() {}\n\n  // 获取锚点\n  getEndpoint() {}\n\n  // 添加锚点\n  addEndpoint() {}\n\n  // 删除锚点\n  removeEndpoint() {}\n\n  // 移动节点\n  moveTo() {}\n\n  // 获取宽度\n  getWidth() {}\n\n  // 获取高度\n  getHeight() {}\n\n  // 设置该节点是否能拖动，能覆盖全局\n  setDraggable() {}\n\n  // remove的方法\n  remove() {}\n\n  // 销毁的方法\n  destroy() {}\n\n\n  // ********* 需要新增的api ********* \n\n\n  // focus回调\n  focus() {}\n\n  // unFocus回调\n  unFocus() {}\n\n  // 单击的回调\n  click() {}\n\n  // 双击的回调\n  doubleClick() {}\n\n  // 右键的回调\n  onContextmenu() {}\n\n  // hover的回调\n  hover() {}\n\n}\n\nexport default Node;\n","'use strict';\n\nconst EventEmit3 = require('eventemitter3');\n\nclass Endpoint extends EventEmit3 {\n  constructor() {\n    super();\n  }\n}\n\nexport default Endpoint;","\n\nconst $ = require('jquery');\nconst _ = require('lodash');\n\nimport './baseEndpoint.less';\n\nimport Endpoint from '../interface/endpoint';\n\nclass BaseEndpoint extends Endpoint {\n  constructor(opts) {\n    super(opts);\n    this.id = opts.id;\n    this.options = opts;\n    this.orientation = opts.orientation;\n    this.pos = opts.pos;\n    this.type = opts.type;\n    this.nodeType = _.get(opts, 'nodeType', 'node');\n    this.nodeId = _.get(opts, '_node.id');\n    this.root = opts.root;\n    this.scope = opts.scope;\n    this.expandArea = opts.expandArea;\n    this.limitNum = opts.limitNum;\n    this.options = opts;\n    // 鸭子辨识手动判断类型\n    this.__type = 'endpoint';\n    // 假如锚点在节点上则有值\n    this._node = opts._node;\n    this._global = opts._global;\n    this._on = opts._on;\n    this._emit = opts._emit;\n    // 相对坐标\n    this._top = 0;\n    this._left = 0;\n    // 相对于画布的绝对坐标\n    this._posTop = 0;\n    this._posLeft = 0;\n    this._width = 0;\n    this._height = 0;\n    // 拉线时候可连接的标志\n    this._linkable = false;\n\n    this._coordinateService = null;\n\n    this.dom = null;\n    // 判断自定义锚点\n    this._isInitedDom = false;\n    if (opts.dom) {\n      this.dom = opts.dom;\n      this._isInitedDom = true;\n    }\n  }\n\n  _init(obj) {\n    this._coordinateService = obj._coordinateService;\n    \n    if (obj.nodeType) {\n      this.nodeType = obj.nodeType;\n    }\n    // 计算锚点起始值\n    if (!this._isInitedDom) {\n      this.dom = this.draw({\n        id: this.id,\n        orientation: this.orientation,\n        pos: this.pos,\n        dom: this.dom,\n        root: this.root,\n        type: this.type,\n        options: this.options\n      });\n    } else {\n      // 计算width,height,left,top\n      this._width = $(this.dom).outerWidth();\n      this._height = $(this.dom).outerHeight();\n      \n      this._left = this._coordinateService._terminal2canvas('x', $(this.dom).offset().left + this._coordinateService.scrollLeft);\n      this._top = this._coordinateService._terminal2canvas('y', $(this.dom).offset().top + this._coordinateService.scrollTop);\n\n      this._posTop = this._top;\n      this._posLeft = this._left;\n    }\n\n    this.attachEvent();\n  }\n\n  draw(obj) {\n    let _dom = obj.dom;\n    if (!_dom) {\n      _dom = $('<div class=\"butterflie-circle-endpoint\"></div>').attr('id', this.id);\n    } else {\n      _dom = $(_dom);\n    }\n    return _dom[0];\n  }\n\n  updatePos(dom = this.dom, orientation = this.orientation, pos = this.pos) {\n    if (this._isInitedDom) {\n      // 计算width,height,left,top\n      this._width = $(this.dom).outerWidth();\n      this._height = $(this.dom).outerHeight();\n\n      // 计算锚点起始值\n      this._left = this._coordinateService._terminal2canvas('x', $(this.dom).offset().left + this._coordinateService.scrollLeft);\n      this._top = this._coordinateService._terminal2canvas('y', $(this.dom).offset().top + this._coordinateService.scrollTop);\n\n      this._posLeft = this._left;\n      this._posTop = this._top;\n    } else {\n      let _currentNode = this._node;\n      let _currentDom = $(this._node.dom);\n      let _currentNodeType = this.nodeType;\n\n      // 分情况弄好方向和位置\n      const nodeW = _currentDom.outerWidth();\n      const nodeH = _currentDom.outerHeight();\n\n      let targetDom = null;\n      let targetDomW = 0;\n      let targetDomH = 0;\n      if (this.root) {\n        targetDom = _currentDom.find(this.root);\n        targetDomW = targetDom.width();\n        targetDomH = targetDom.height();\n      }\n\n      this._width = $(dom).outerWidth();\n      this._height = $(dom).outerHeight();\n\n      // 计算节点本身的偏移量\n      const eOffsetX = this._width / 2;\n      const eOffsetY = this._height / 2;\n\n      let _offsetTop = 0;\n      let _offsetLeft = 0;\n\n      const _orientation = orientation || this.orientation || [0, -1];\n      const _pos = pos || this.pos || [_orientation[0] === 0 ? 0.5 : 0, _orientation[1] === 0 ? 0.5 : 0];\n\n      const result = [0, 0];\n\n      const _ox = _orientation[0];\n      const _oy = _orientation[1];\n      const _px = _pos[0];\n      const _py = _pos[1];\n      if (_ox === 0) {\n        result[0] = !this.root ? nodeW * _px - eOffsetX : targetDomW * _px - eOffsetX;\n      } else if (_ox === -1) {\n        result[0] = 0 - eOffsetX;\n      } else if (_ox === 1) {\n        result[0] = !this.root ? nodeW - eOffsetX : targetDomW - eOffsetX;\n      }\n\n      if (_oy === 0) {\n        result[1] = !this.root ? nodeH * _py - eOffsetY : targetDomH * _py - eOffsetY;\n      } else if (_oy === -1) {\n        result[1] = 0 - eOffsetY;\n      } else if (_oy === 1) {\n        result[1] = !this.root ? nodeH - eOffsetY : targetDomH - eOffsetY;\n      }\n      // 计算绝对定位\n      if (_currentNode && !this.root) {\n        _offsetTop += _currentNode.top;\n        _offsetLeft += _currentNode.left;\n      } else if (_currentNode && this.root) {\n        // 计算传入的dom距离跟节点\n        const nodeDomOffsets = _currentDom.offset();\n        const targetDomOffsets = targetDom.offset();\n        // 先计算目标节点和父节点得差值再加上父节点的offset\n        _offsetTop += (targetDomOffsets.top - nodeDomOffsets.top + _currentNode.top);\n        _offsetLeft += (targetDomOffsets.left - nodeDomOffsets.left + _currentNode.left);\n      }\n      this._top = result[1] + _offsetTop;\n      this._left = result[0] + _offsetLeft;\n      this._posTop = this._top;\n      this._posLeft = this._left;\n      if (_currentNodeType === 'node' && _currentNode._group) {\n        this._posTop += _currentNode._group.top;\n        this._posLeft += _currentNode._group.left;\n      }\n      $(dom)\n        .css('top', this._top)\n        .css('left', this._left);\n\n      this.updated && this.updated();\n    }\n  }\n\n  moveTo(x, y) {\n    this._top = y;\n    this._left = x;\n    this._posTop = this._top;\n    this._posLeft = this._left;\n    if (!this._isInitedDom) {\n      $(this.dom).css('top', y).css('left', x);\n      if (_.get(this, '_node._group')) {\n        this._posTop += this._node._group.top;\n        this._posLeft += this._node._group.left;\n      }\n    }\n  }\n\n  linkable() {\n    $(this.dom).addClass('linkable');\n  }\n\n  unLinkable() {\n    $(this.dom).removeClass('linkable');\n  }\n\n  hoverLinkable() {\n    $(this.dom).addClass('hover');\n  }\n\n  unHoverLinkable() {\n    $(this.dom).removeClass('hover');\n  }\n\n  attachEvent() {\n    $(this.dom).on('mousedown', (e) => {\n      const LEFT_KEY = 0;\n      if (e.button !== LEFT_KEY) {\n        return;\n      }\n      e.preventDefault();\n      e.stopPropagation();\n      this.emit('InnerEvents', {\n        type: 'endpoint:drag',\n        data: this\n      });\n    });\n  }\n  emit(type, data) {\n    super.emit(type, data);\n    this._emit(type, data);\n  }\n  destroy(isNotEvent) {\n    if (!isNotEvent) {\n      $(this.dom).off();\n      $(this.dom).remove();\n      this.removeAllListeners();\n    } else {\n      $(this.dom).detach();\n    }\n  }\n}\n\nexport default BaseEndpoint;\n","const $ = require('jquery');\nconst _ = require('lodash');\n\nimport Node from '../interface/node';\nimport Endpoint from '../endpoint/baseEndpoint';\n\nclass BaseNode extends Node {\n  constructor(opts) {\n    super(opts);\n    this.id = opts.id;\n    this.scope = opts.scope;\n    this.group = opts.group;\n    this.top = opts.top || 0;\n    this.left = opts.left || 0;\n    this.dom = opts.dom || null;\n    this.draggable = opts.draggable;\n    this.options = opts;\n    // 鸭子辨识手动判断类型\n    this.__type = 'node';\n    this._on = opts._on;\n    this._emit = opts._emit;\n    this._global = opts._global;\n    // endpoint 这部分需要考虑\n    this.endpoints = [];\n    this._endpointsData = opts.endpoints;\n    this._endpointLimitNum = opts._endpointLimitNum;\n    // 标识是否在移动做，兼容冒泡\n    this._isMoving = false;\n  }\n\n  draw(obj) {\n    let _dom = obj.dom;\n    if (!_dom) {\n      _dom = $('<div></div>')\n        .attr('class', 'node')\n        .attr('id', obj.id);\n    }\n    const node = $(_dom);\n    if (obj.top !== undefined) {\n      node.css('top', `${obj.top}px`);\n    }\n    if (obj.left !== undefined) {\n      node.css('left', `${obj.left}px`);\n    }\n    this.updated && this.updated();\n    return node[0];\n  }\n\n  focus() {}\n\n  unFocus() {}\n\n  addEndpoint(obj, isInited) {\n    if (isInited) {\n      this.emit('InnerEvents', {\n        type: 'node:addEndpoint',\n        data: obj,\n        isInited\n      });\n      return obj;\n    }\n    // 这部分可能还需要想一下\n    const EndpointClass = obj.Class || Endpoint;\n    const endpoint = new EndpointClass(_.assign({\n      limitNum: obj.limitNum || this._endpointLimitNum,\n      _on: this._on,\n      _emit: this._emit,\n      _node: this,\n      _global: this.global\n    }, obj));\n    \n    this.emit('InnerEvents', {\n      type: 'node:addEndpoint',\n      data: endpoint\n    });\n\n    this.endpoints.push(endpoint);\n    return endpoint;\n  }\n\n  removeEndpoint(pointId) {\n    const rmEndpointIndex = _.findIndex(this.endpoints, point => point.id === pointId);\n    if (rmEndpointIndex !== -1) {\n      const rmEndpoint = this.endpoints.splice(rmEndpointIndex, 1)[0];\n      this.emit('InnerEvents', {\n        type: 'node:removeEndpoint',\n        data: rmEndpoint\n      });\n      rmEndpoint.destroy();\n      return rmEndpoint;\n    }\n  }\n\n  getEndpoint(pointId, type) {\n    return _.find(this.endpoints, (point) => {\n      if (!point.type || point.type === 'onlyConnect') {\n        return pointId === point.id;\n      } else {\n        return pointId === point.id && ((type && type === point.type) || !type);\n      }\n    });\n  }\n\n  _init(obj = {}) {\n    if (this._isInited) {\n      return;\n    }\n    // 这里可以抽象下，和constructor对比\n    if (obj.left) {\n      this.left = obj.left;\n    }\n    if (obj.top) {\n      this.top = obj.top;\n    }\n    if (obj._isDeleteGroup) {\n      this.group = undefined;\n      this._group = undefined;\n    } else {\n      obj.group && (this.group = obj.group);\n    }\n\n    delete obj._isDeleteGroup;\n    this._isInited = true;\n    if (obj.dom) {\n      this.dom = obj.dom;\n      obj.left && ($(this.dom).css('left', `${obj.left}px`));\n      obj.top && ($(this.dom).css('top', `${obj.top}px`));\n\n    } else {\n      this.dom = this.draw(_.assign({\n        id: this.id,\n        top: this.top,\n        left: this.left,\n        dom: this.dom,\n        options: this.options\n      }, obj));\n      this._addEventListener();\n    }\n  }\n  // drag的时候移动的api\n  _moveTo(x, y) {\n    // 自身移动\n    $(this.dom).css('top', y).css('left', x);\n    // 所在的点移动\n    this.endpoints.forEach((item) => {\n      item.moveTo(x - this.left + item._left, y - this.top + item._top);\n    });\n    this.top = y;\n    this.left = x;\n  }\n  moveTo(x, y, isNotEventEmit) {\n    this.emit('InnerEvents', {\n      type: 'node:move',\n      node: this,\n      x,\n      y,\n      isNotEventEmit\n    });\n  }\n\n  getWidth() {\n    return $(this.dom).outerWidth();\n  }\n\n  getHeight() {\n    return $(this.dom).outerHeight();\n  }\n\n  _createEndpoint(isInited) {\n    if (isInited) {\n      this.endpoints.forEach(item => this.addEndpoint(item, isInited));\n    } else if (this._endpointsData) {\n      this._endpointsData.map(item => this.addEndpoint(item));\n    }\n  }\n\n  _addEventListener() {\n    // todo 做事件代理的形式\n    $(this.dom).on('mousedown', (e) => {\n      const LEFT_KEY = 0;\n      if (e.button !== LEFT_KEY) {\n        return;\n      }\n      if (!['SELECT', 'INPUT', 'RADIO', 'CHECKBOX', 'TEXTAREA'].includes(e.target.nodeName)) {\n        e.preventDefault();\n      }\n      if (this.draggable) {\n        this._isMoving = true;\n        this.emit('InnerEvents', {\n          type: 'node:dragBegin',\n          data: this\n        });\n      } else {\n        // 单纯为了抛错事件给canvas，为了让canvas的dragtype不为空，不会触发canvas:click事件\n        this.emit('InnerEvents', {\n          type: 'node:mouseDown',\n          data: this\n        });\n      }\n    });\n\n    $(this.dom).on('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.emit('system.node.click', {\n        node: this\n      });\n      this.emit('events', {\n        type: 'node:click',\n        node: this\n      });\n    });\n\n    this.setDraggable(this.draggable);\n  }\n  setDraggable(draggable) {\n    this.draggable = draggable;\n  }\n  remove() {\n    this.emit('InnerEvents', {\n      type: 'node:delete',\n      data: this\n    });\n  }\n  emit(type, data) {\n    super.emit(type, data);\n    this._emit(type, data);\n  }\n  on(type, callback) {\n    super.on(type, callback);\n    this._on(type, callback);\n  }\n  destroy(isNotEvent) {\n    if (!isNotEvent) {\n      this.endpoints.forEach((item) => {\n        !item._isInitedDom && item.destroy();\n      });\n      $(this.dom).remove();\n      this.removeAllListeners();\n    } else {\n      this.endpoints.forEach((item) => {\n        !item._isInitedDom && item.destroy(isNotEvent);\n      });\n      $(this.dom).detach();\n    }\n    this._isInited = false;\n  }\n}\n\nexport default BaseNode;\n","'use strict';\n\nconst _ = require('lodash');\n\nconst MINDIST = 20;\nconst TOL = 0.1;\nconst TOLxTOL = 0.01;\nconst TOGGLE_DIST = 20;\nconst LEFT = 'Left';\nconst RIGHT = 'Right';\nconst TOP = 'Top';\nconst BOTTOM = 'Bottom';\n\nconst Point = function(x, y) {\n  this.x = x;\n  this.y = y;\n}\n\nfunction drawBezier(sourcePoint, targetPoint) {\n\n  if (!sourcePoint.orientation) {\n    sourcePoint.orientation = _calcOrientation(targetPoint.pos[0], targetPoint.pos[1], sourcePoint.pos[0], sourcePoint.pos[1]);\n  }\n\n  if (!targetPoint.orientation) {\n    targetPoint.orientation = _calcOrientation(sourcePoint.pos[0], sourcePoint.pos[1], targetPoint.pos[0], targetPoint.pos[1]);\n  }\n\n  // 控制点\n\n  let _width = Math.abs(sourcePoint.pos[0] - targetPoint.pos[0]);\n  let _height = Math.abs(sourcePoint.pos[1] - targetPoint.pos[1]);\n\n  let _sx = sourcePoint.pos[0] < targetPoint.pos[0] ? _width : 0;\n  let _sy = sourcePoint.pos[1] < targetPoint.pos[1] ? _height : 0;\n  let _tx = sourcePoint.pos[0] < targetPoint.pos[0] ? 0 : _width;\n  let _ty = sourcePoint.pos[1] < targetPoint.pos[1] ? 0 : _height;\n  let _so = sourcePoint.orientation;\n  let _to = targetPoint.orientation;\n\n  let sourceCtrlPoint = _findControlPoint([_sx, _sy], sourcePoint, targetPoint, _so, _to);\n  let targetCtrlPoint = _findControlPoint([_tx, _ty], targetPoint, sourcePoint, _to, _so);\n\n\n  let offsetX = sourcePoint.pos[0] < targetPoint.pos[0] ? sourcePoint.pos[0] : targetPoint.pos[0];\n  let offsetY = sourcePoint.pos[1] < targetPoint.pos[1] ? sourcePoint.pos[1] : targetPoint.pos[1];\n\n  sourceCtrlPoint = [sourceCtrlPoint[0] + offsetX, sourceCtrlPoint[1] + offsetY];\n  targetCtrlPoint = [targetCtrlPoint[0] + offsetX, targetCtrlPoint[1] + offsetY];\n\n  // 起始点\n  let result = ['M', sourcePoint.pos[0], sourcePoint.pos[1]];\n  // 两个控制点\n  result = result.concat(['C', targetCtrlPoint[0], targetCtrlPoint[1], sourceCtrlPoint[0], sourceCtrlPoint[1]]);\n  // 结束点\n  result = result.concat([targetPoint.pos[0], targetPoint.pos[1]]);\n\n  return result.join(' ');\n}\n\nfunction drawAdvancedBezier(sourcePoint, targetPoint) {\n\n  if (!sourcePoint.orientation) {\n    sourcePoint.orientation = _calcOrientation(targetPoint.pos[0], targetPoint.pos[1], sourcePoint.pos[0], sourcePoint.pos[1]);\n  }\n\n  if (!targetPoint.orientation) {\n    targetPoint.orientation = _calcOrientation(sourcePoint.pos[0], sourcePoint.pos[1], targetPoint.pos[0], targetPoint.pos[1]);\n  }\n\n  // 控制点\n\n  let _width = Math.abs(sourcePoint.pos[0] - targetPoint.pos[0]);\n  let _height = Math.abs(sourcePoint.pos[1] - targetPoint.pos[1]);\n\n  let _so = sourcePoint.orientation;\n  let _to = targetPoint.orientation;\n\n  const dist = Math.sqrt(_width * _width + _height * _height);\n  // 控制点百分比，可转配置\n  const percent = 0.25;\n  // 偏差量，可转配置\n  const minorDist = 30;\n  let so_offsetX = 0;\n  let so_offsetY = 0;\n  if (_so[0] !== 0) {\n    so_offsetX = (dist * percent + minorDist) * _so[0];\n  } else if (_so[1] !== 0) {\n    so_offsetY = (dist * percent + minorDist) * _so[1];\n  }\n\n  let to_offsetX = 0;\n  let to_offsetY = 0;\n  if (_to[0] !== 0) {\n    to_offsetX = (dist * percent + minorDist) * _to[0];\n  } else if (_to[1] !== 0) {\n    to_offsetY = (dist * percent + minorDist) * _to[1];\n  }\n\n  const sourceCtrlPoint = [sourcePoint.pos[0] + so_offsetX, sourcePoint.pos[1] + so_offsetY];\n  const targetCtrlPoint = [targetPoint.pos[0] + to_offsetX, targetPoint.pos[1] + to_offsetY];\n\n  // 起始点\n  let result = ['M', sourcePoint.pos[0], sourcePoint.pos[1]];\n  // let result = ['M', targetPoint.pos[0], targetPoint.pos[1]];\n  // 两个控制点\n  result = result.concat(['C', sourceCtrlPoint[0], sourceCtrlPoint[1]], targetCtrlPoint[0], targetCtrlPoint[1]);\n  // result = result.concat(['C', targetCtrlPoint[0], targetCtrlPoint[1], sourceCtrlPoint[0], sourceCtrlPoint[1]]);\n  // 结束点\n  result = result.concat([targetPoint.pos[0], targetPoint.pos[1]]);\n  // result = result.concat([sourcePoint.pos[0], sourcePoint.pos[1]]);\n\n  return result.join(' ');\n}\n\nfunction drawStraight(sourcePoint, targetPoint) {\n  let result = ['M', sourcePoint.pos[0], sourcePoint.pos[1], 'L', targetPoint.pos[0], targetPoint.pos[1]];\n  return result.join(' ');\n}\n\nfunction drawFlow(sourcePoint, targetPoint, orientationLimit) {\n  if (!sourcePoint.orientation) {\n    sourcePoint.orientation = _calcOrientation(targetPoint.pos[0], targetPoint.pos[1], sourcePoint.pos[0], sourcePoint.pos[1], orientationLimit);\n  }\n\n  if (!targetPoint.orientation) {\n    targetPoint.orientation = _calcOrientation(sourcePoint.pos[0], sourcePoint.pos[1], targetPoint.pos[0], targetPoint.pos[1], orientationLimit);\n  }\n\n  let stub = 30; // 每部分折线的最小长度\n  let midpoint = 0.5; // 折线中点\n  let w = Math.abs(sourcePoint.pos[0] - targetPoint.pos[0]);\n  let h = Math.abs(sourcePoint.pos[1] - targetPoint.pos[1]);\n  let sx = targetPoint.pos[0] < sourcePoint.pos[0] ? w : 0;\n  let sy = targetPoint.pos[1] < sourcePoint.pos[1] ? h : 0;\n  let tx = targetPoint.pos[0] < sourcePoint.pos[0] ? 0 : w;\n  let ty = targetPoint.pos[1] < sourcePoint.pos[1] ? 0 : h;\n  let offsetX = sourcePoint.pos[0] < targetPoint.pos[0] ? sourcePoint.pos[0] : targetPoint.pos[0];\n  let offsetY = sourcePoint.pos[1] < targetPoint.pos[1] ? sourcePoint.pos[1] : targetPoint.pos[1];\n  // 小心有可能so[0]和to[0]同时为0；或者是so[1]和to[1]同时为0\n  let so = sourcePoint.orientation;\n  let to = targetPoint.orientation;\n  // 拿来判断是对面，垂直还是正交\n  let oProduct = ((so[0] * to[0]) + (so[1] * to[1]));\n\n  let sourceAxis = so[0] === 0 ? 'y' : 'x';\n\n  let startStubX = sx + (so[0] * stub);\n  let startStubY = sy + (so[1] * stub);\n  let endStubX = tx + (to[0] * stub);\n  let endStubY = ty + (to[1] * stub);\n\n  let isXGreaterThanStubTimes2 = Math.abs(sx - tx) > (stub + stub);\n  let isYGreaterThanStubTimes2 = Math.abs(sy - ty) > (stub + stub);\n\n  // 判断方向\n  let anchorOrientation = null;\n  if (oProduct === -1) {\n    anchorOrientation = 'opposite';\n  } else if (oProduct === 0) {\n    anchorOrientation = 'perpendicular';\n  } else if (oProduct === 1) {\n    anchorOrientation = 'orthogonal';\n  }\n\n  // 计算折线的方法\n  let _commonStubCalculator = () => {\n    return [startStubX, startStubY, endStubX, endStubY];\n  };\n  let stubCalculators = {\n    perpendicular: _commonStubCalculator,\n    orthogonal: _commonStubCalculator,\n    opposite: (axis) => {\n      let idx = axis === 'x' ? 0 : 1;\n      let areInProximity = {\n        x: () => {\n          return ( (so[idx] === 1 && (\n            ( (startStubX > endStubX) && (tx > startStubX) ) ||\n            ( (sx > endStubX) && (tx > sx))))) ||\n            ( (so[idx] === -1 && (\n              ( (startStubX < endStubX) && (tx < startStubX) ) ||\n              ( (sx < endStubX) && (tx < sx)))));\n        },\n        y: () => {\n          return ( (so[idx] === 1 && (\n            ( (startStubY > endStubY) && (ty > startStubY) ) ||\n            ( (sy > endStubY) && (ty > sy))))) ||\n\n            ( (so[idx] === -1 && (\n                ( (startStubY < endStubY) && (ty < startStubY) ) ||\n                ( (sy < endStubY) && (ty < sy)))));\n        }\n      };\n      \n      // 判断是否需要折线\n      if (areInProximity[axis]()) { // 这判断可以设置总是有折线\n        return {\n          x: [(sx + tx) / 2, startStubY, (sx + tx) / 2, endStubY],\n          y: [startStubX, (sy + ty) / 2, endStubX, (sy + ty) / 2]\n        }[axis];\n      } else {\n        return [startStubX, startStubY, endStubX, endStubY];\n      }\n    }\n  };\n\n  // 加工线条处理的方法\n  let lastx = null;\n  let lasty = null;\n  let segments = [];\n  let _sgn = (n) => {\n    return n < 0 ? -1 : n === 0 ? 0 : 1;\n  };\n  let _addSegment = (x, y) => {\n    if (lastx === x && lasty === y) {\n      return;\n    }\n    let lx = lastx == null ? sx : lastx;\n    let ly = lasty == null ? sy : lasty;\n    let o = lx === x ? 'v': 'h';\n    let sgnx = _sgn(x - lx);\n    let sgny = _sgn(y - ly);\n\n    lastx = x;\n    lasty = y;\n\n    segments.push([lx, ly, x, y, o, sgnx, sgny]);\n  };\n\n  // 开始实现\n  let stubs = stubCalculators[anchorOrientation](sourceAxis);\n  let idx = sourceAxis === 'x' ? 0 : 1;\n  let oidx = sourceAxis === 'x' ? 0 : 1;\n  let ss = stubs[idx];\n  let oss = stubs[oidx];\n  let es = stubs[idx + 2];\n  let oes = stubs[oidx + 2];\n\n  _addSegment(stubs[0], stubs[1]);\n\n  let midx = startStubX + (endStubX - startStubX) * midpoint;\n  let midy = startStubY + (endStubY - startStubY) * midpoint;\n\n  let orientations = { x: [ 0, 1 ], y: [ 1, 0 ] };\n  let _lineCalculators = {\n    perpendicular: (axis) => {\n      let sis = {\n        x: [\n          [[1, 2, 3, 4], null, [2, 1, 4, 3]],\n          null,\n          [[4, 3, 2, 1], null, [3, 4, 1, 2]]\n        ],\n        y: [\n          [[3, 2, 1, 4], null, [2, 3, 4, 1]],\n          null,\n          [[4, 1, 2, 3], null, [1, 4, 3, 2]]\n        ]\n      };\n      let stubs = {\n        x: [[startStubX, endStubX], null, [endStubX, startStubX]],\n        y: [[startStubY, endStubY], null, [endStubY, startStubY]]\n      };\n      let midLines = {\n        x: [[midx, startStubY], [midx, endStubY]],\n        y: [[startStubX, midy], [endStubX, midy]]\n      };\n      let linesToEnd = {\n        x: [[endStubX, startStubY]],\n        y: [[startStubX, endStubY]]\n      };\n      let startToEnd = {\n        x: [[startStubX, endStubY], [endStubX, endStubY]],\n        y: [[endStubX, startStubY], [endStubX, endStubY]]\n      };\n      let startToMidToEnd = {\n        x: [[startStubX, midy], [endStubX, midy], [endStubX, endStubY]],\n        y: [[midx, startStubY], [midx, endStubY], [endStubX, endStubY]]\n      };\n      let otherStubs = {\n        x: [startStubY, endStubY],\n        y: [startStubX, endStubX]\n      };\n      let soIdx = orientations[axis][0];\n      let toIdx = orientations[axis][1];\n      let _so = so[soIdx] + 1;\n      let _to = to[toIdx] + 1;\n      let otherFlipped = (to[toIdx] === -1 && (otherStubs[axis][1] < otherStubs[axis][0])) || (to[toIdx] === 1 && (otherStubs[axis][1] > otherStubs[axis][0]));\n      let stub1 = stubs[axis][_so][0];\n      let stub2 = stubs[axis][_so][1];\n      let segmentIndexes = sis[axis][_so][_to];\n\n      // 计算一下节点象限\n      let _quadrant = (p1, p2) => {\n        if (p2.pos[0] > p1.pos[0]) {\n          return (p2.pos[1] > p1.pos[1]) ? 2 : 1;\n        } else if (p2.pos[0] == p1.pos[0]) {\n          return p2.pos[1] > p1.pos[1] ? 2 : 1;\n        } else {\n          return (p2.pos[1] > p1.pos[1]) ? 3 : 4;\n        }\n      };\n      var segment = _quadrant(sourcePoint, targetPoint);\n      if (segment === segmentIndexes[3] || (segment === segmentIndexes[2] && otherFlipped)) {\n        return midLines[axis];\n      } else if (segment === segmentIndexes[2] && stub2 < stub1) {\n        return linesToEnd[axis];\n      } else if ((segment === segmentIndexes[2] && stub2 >= stub1) || (segment === segmentIndexes[1] && !otherFlipped)) {\n        return startToMidToEnd[axis];\n      } else if (segment === segmentIndexes[0] || (segment === segmentIndexes[1] && otherFlipped)) {\n        return startToEnd[axis];\n      }\n    },\n    orthogonal: (axis, startStub, otherStartStub, endStub, otherEndStub) => {\n      let extent = {\n        x: so[0] === -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub),\n        y: so[1] === -1 ? Math.min(startStub, endStub) : Math.max(startStub, endStub)\n      }[axis];\n\n      return {\n        x: [\n          [extent, otherStartStub],\n          [extent, otherEndStub],\n          [endStub, otherEndStub]\n        ],\n        y: [\n          [otherStartStub, extent],\n          [otherEndStub, extent],\n          [otherEndStub, endStub]\n        ]\n      }[axis];\n    },\n    opposite: (axis, ss, oss, es) => {\n      let otherAxis = {x: 'y', y: 'x'}[axis];\n      let dim = {x: 'height', y: 'width'}[axis];\n      let comparator = axis === 'x' ? isXGreaterThanStubTimes2 : isYGreaterThanStubTimes2;\n\n      // 考虑下自连的情况, 现在很不严禁\n      if (sourcePoint.pos[0] === targetPoint.pos[0] && sourcePoint.pos[1] === targetPoint.pos[1]) {\n        //\n      } else if (!comparator || (so[idx] === 1 && ss > es) || (so[idx] === -1 && ss < es)) {\n        return {\n          x: [\n            [ss, midy],\n            [es, midy]\n          ],\n          y: [\n            [midx, ss],\n            [midx, es]\n          ]\n        }[axis];\n      } else if ((so[idx] === 1 && ss < es) || (so[idx] === -1 && ss > es)) {\n        return {\n          x: [\n            [midx, sy],\n            [midx, ty]\n          ],\n          y: [\n            [sx, midy],\n            [tx, midy]\n          ]\n        }[axis];\n      }\n    }\n  };\n\n  // 计算剩余线条\n  var p = _lineCalculators[anchorOrientation](sourceAxis, ss, oss, es, oes);\n  if (p) {\n    for (let i = 0; i < p.length; p++) {\n      _addSegment(p[i][0], p[i][1]);\n    }\n  }\n\n  // line to end stub\n  _addSegment(stubs[2], stubs[3]);\n\n  // end stub to end (common)\n  _addSegment(tx, ty);\n\n  // 实际操作svg\n  return _drawFlowSegment(segments, {\n    x: offsetX,\n    y: offsetY\n  });\n}\n\nfunction drawManhattan(sourcePoint, targetPoint) {\n  if (!sourcePoint.orientation) {\n    sourcePoint.orientation = _calcOrientation(targetPoint.pos[0], targetPoint.pos[1], sourcePoint.pos[0], sourcePoint.pos[1]);\n  }\n\n  if (!targetPoint.orientation) {\n    targetPoint.orientation = _calcOrientation(sourcePoint.pos[0], sourcePoint.pos[1], targetPoint.pos[0], targetPoint.pos[1]);\n  }\n\n  const pointArr = [];\n  const fromPt = {\n    x: sourcePoint.pos[0],\n    y: sourcePoint.pos[1],\n  };\n  const toPt = {\n    x: targetPoint.pos[0],\n    y: targetPoint.pos[1],\n  };\n  const orientation = {\n    '-10': LEFT,\n    '10': RIGHT,\n    '0-1': TOP,\n    '01': BOTTOM,\n  };\n  // link:connect 中 orientation = undefined\n  _route(pointArr, fromPt, orientation[sourcePoint.orientation.join('')], toPt, orientation[targetPoint.orientation.join('')]);\n  if (pointArr.length < 2) return '';\n  const path = pointArr.reduce((path, point) => {\n    path.push([\n      'L',\n      point.x,\n      point.y\n    ].join(' '));\n    return path;\n  }, [[\n    'M',\n    pointArr[0].x,\n    pointArr[0].y\n  ].join(' ')]).join(' ');\n  return path;\n}\n\nfunction _drawFlowSegment(segments, offset) {\n  let current = null;\n  let next = null;\n  let cornerRadius = 0; // 拐角角度，按道理可以配置\n  let lw = 1; // strokeWidth，线条的粗细\n  let _segLength = (s) => {\n    return Math.sqrt(Math.pow(s[0] - s[2], 2) + Math.pow(s[1] - s[3], 2));\n  };\n  let result = [];\n  let _drawStraight = (d) => {\n    return ['M', d.x1 + offset.x, d.y1 + offset.y, 'L', d.x2 + offset.x, d.y2 + offset.y];\n  };\n  let _drawArc = (d) => {\n\n    // 有重复，可抽象，计算象限\n    let _quadrant = (p1, p2) => {\n      if (p2[0] > p1[0]) {\n        return (p2[1] > p1[1]) ? 2 : 1;\n      } else if (p2[0] === p1[0]) {\n        return p2[1] > p1[1] ? 2 : 1;\n      } else {\n        return (p2[1] > p1[1]) ? 3 : 4;\n      }\n    };\n    // 计算两点之间的直线的梯度\n    let _gradient = (p1, p2) => {\n      if (p2[0] === p1[0]) {\n        return p2[1] > p1[0] ? Infinity : -Infinity;\n      } else if (p2[1] === p1[1]) {\n        return p2[0] > p1[0] ? 0 : -0;\n      } else {\n        return (p2[1] - p1[1]) / (p2[0] - p1[0]);\n      }\n    };\n    // Calculates the angle between the two points\n    let _theta = (p1, p2) => {\n      let m = _gradient(p1, p2);\n      let t = Math.atan(m);\n      let s = _quadrant(p1, p2);\n      if ((s === 4 || s === 3)) {\n        t += Math.PI;\n      }\n      if (t < 0) {\n        t += (2 * Math.PI);\n      }\n      return t;\n    };\n\n    let _calcAngle = function (x, y) {\n      return _theta([d.cx, d.cy], [x, y]);\n    };\n\n    let startAngle = _calcAngle(x1, y1);\n    let endAngle = _calcAngle(x2, y2);\n    let TWO_PI = 2 * Math.PI;\n    if (endAngle < 0) {\n      endAngle += TWO_PI;\n    }\n    if (startAngle < 0) {\n      startAngle += TWO_PI;\n    }\n    // we now have startAngle and endAngle as positive numbers, meaning the\n    // absolute difference (|d|) between them is the sweep (s) of this arc, unless the\n    // arc is 'anticlockwise' in which case 's' is given by 2PI - |d|.\n    let ea = endAngle < startAngle ? endAngle + TWO_PI : endAngle;\n    let sweep = Math.abs(ea - startAngle);\n    let anticlockwise = d.ac;\n\n    if (anticlockwise) {\n      sweep = TWO_PI - sweep;\n    }\n\n    return ['M', d.x1 + offset.x, d.y1 + offset.y, 'A', d.r, d.r, '0', ',', d.x2 + offset.x, d.y2 + offset.y];\n  };\n\n  // let offsetX = sourcePoint.pos[0] < targetPoint.pos[0] ? sourcePoint.pos[0] : targetPoint.pos[0];\n  // let offsetY = sourcePoint.pos[1] < targetPoint.pos[1] ? sourcePoint.pos[1] : targetPoint.pos[1];\n\n  for (let i = 0; i < segments.length - 1; i++) {\n    current = current || _.cloneDeep(segments[i]);\n    next = _.cloneDeep(segments[i + 1]);\n    if (cornerRadius > 0 && current[4] !== next[4]) {\n      let radiusToUse = Math.min(cornerRadius, _segLength(current), _segLength(next));\n      // right angle. adjust current segment's end point, and next segment's start point.\n      current[2] -= current[5] * radiusToUse;\n      current[3] -= current[6] * radiusToUse;\n      next[0] += next[5] * radiusToUse;\n      next[1] += next[6] * radiusToUse;\n      let ac = (current[6] === next[5] && next[5] === 1) ||\n            ((current[6] === next[5] && next[5] === 0) && current[5] !== next[6]) ||\n            (current[6] === next[5] && next[5] === -1);\n      let sgny = next[1] > current[3] ? 1 : -1;\n      let sgnx = next[0] > current[2] ? 1 : -1;\n      let sgnEqual = sgny === sgnx;\n      let cx = (sgnEqual && ac || (!sgnEqual && !ac)) ? next[0] : current[2];\n      let cy = (sgnEqual && ac || (!sgnEqual && !ac)) ? current[3] : next[1];\n\n      let _line1 = _drawStraight({\n        x1: current[0],\n        y1: current[1],\n        x2: current[2],\n        y2: current[3]\n      });\n      let _line2 = _drawArc({\n        r: radiusToUse,\n        x1: current[2],\n        y1: current[3],\n        x2: next[0],\n        y2: next[1],\n        cx: cx,\n        cy: cy,\n        ac: ac\n      });\n      result = result.concat(_line1);\n      result = result.concat(_line2);\n    } else {\n      // dx + dy are used to adjust for line width.\n      let dx = (current[2] === current[0]) ? 0 : (current[2] > current[0]) ? (lw / 2) : -(lw / 2);\n      let dy = (current[3] === current[1]) ? 0 : (current[3] > current[1]) ? (lw / 2) : -(lw / 2);\n      let _line = _drawStraight({\n        x1: current[0] - dx,\n        y1: current[1] - dy,\n        x2: current[2] + dx,\n        y2: current[3] + dy\n      });\n      result = result.concat(_line);\n    }\n    current = next;\n  }\n  if (next !== null) {\n    let _line = _drawStraight({\n      x1: next[0],\n      y1: next[1],\n      x2: next[2],\n      y2: next[3]\n    });\n    result = result.concat(_line);\n  }\n  return result.join(' ');\n}\n\nfunction _calcOrientation(beginX, beginY, endX, endY, orientationLimit) {\n\n  let _calcWithLimit = (rank) => {\n    if (orientationLimit) {\n      for (let i = 0; i < rank.length; i++) {\n        let isInLimit = _.some(orientationLimit, (limit) => {\n          return limit === rank[i];\n        });\n        if (isInLimit) {\n          return rank[i];\n        }\n      }\n      return rank[0];\n    } else {\n      return rank[0];\n    }\n  };\n  // 计算orientation\n  let posX = endX - beginX;\n  let posY = endY - beginY;\n  let orientation = null;\n\n  // 斜率\n  let k = Math.abs(posY / posX);\n\n  if (posX === 0 || posY === 0) {\n    if (posX === 0) {\n      orientation = posY >= 0 ? _calcWithLimit(['Top', 'Left', 'Right', 'Bottom']) : orientation;\n      orientation = posY < 0 ? _calcWithLimit(['Bottom', 'Left', 'Right', 'Top']) : orientation;\n    }\n    if (posY === 0) {\n      orientation = posX >= 0 ? _calcWithLimit(['Right', 'Top', 'Bottom', 'Left']) : orientation;\n      orientation = posX < 0 ? _calcWithLimit(['Left', 'Top', 'Bottom', 'Right']) : orientation;\n    }\n  } else if (posX > 0 && posY > 0) {\n    if (k > 1) {\n      orientation = _calcWithLimit(['Top', 'Left', 'Right', 'Bottom']);\n      // orientation = [0, -1];\n    } else {\n      orientation = _calcWithLimit(['Left', 'Top', 'Bottom', 'Right']);\n      // orientation = [-1, 0];\n    }\n  } else if (posX < 0 && posY > 0) {\n    if (k > 1) {\n      orientation = _calcWithLimit(['Top', 'Right', 'Left', 'Bottom']);\n      // orientation = [0, -1];\n    } else {\n      orientation = _calcWithLimit(['Right', 'Top', 'Bottom', 'Left']);\n      // orientation = [1, 0];\n    }\n  } else if (posX < 0 && posY < 0) {\n    if (k > 1) {\n      orientation = _calcWithLimit(['Bottom', 'Right', 'Left', 'Top']);\n      // orientation = [0, 1];\n    } else {\n      orientation = _calcWithLimit(['Right', 'Bottom', 'Top', 'Left']);\n      // orientation = [1, 0];\n    }\n  } else {\n    if (k > 1) {\n      orientation = _calcWithLimit(['Bottom', 'Left', 'Right', 'Top']);\n      // orientation = [0, 1];\n    } else {\n      orientation = _calcWithLimit(['Left', 'Bottom', 'Top', 'Right']);\n      // orientation = [-1, 0];\n    }\n  }\n\n  switch (orientation) {\n    case 'Left':\n      return [-1, 0];\n    case 'Right':\n      return [1, 0];\n    case 'Top':\n      return [0, -1];\n    case 'Bottom':\n      return [0, 1];\n  }\n}\n\nfunction _findControlPoint(point, sourcePoint, targetPoint, _so, _to) {\n\n  // 曲率，可配置的\n  let majorAnchor = 10;\n  // 偏移，定死的\n  let minorAnchor = 10;\n\n  let result = [];\n\n  // 特殊处理完全水平和垂直的情况\n  if (sourcePoint.pos[0] === targetPoint.pos[0] && _so[1] !== _to[1] && _so[0] === 0 && _to[0] === 0) {\n    result = [point[0], point[1] + majorAnchor * _so[1]];\n    return result;\n  }\n\n  if (sourcePoint.pos[1] === targetPoint.pos[1] && _so[0] !== _to[0] && _so[1] === 0 && _to[1] === 0) {\n    result = [point[0] + majorAnchor * _so[0], point[1]];\n    return result;\n  }\n\n  // 平常情况\n  var perpendicular = _so[0] !== _to[0] || _so[1] === _to[1];\n  if (!perpendicular) {\n    if (_so[0] === 0) {\n      result.push(sourcePoint.pos[0] < targetPoint.pos[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\n    } else {\n      result.push(point[0] - (majorAnchor * _so[0]));\n    }\n\n    if (_so[1] === 0) {\n      result.push(sourcePoint.pos[1] < targetPoint.pos[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\n    } else {\n      result.push(point[1] - (majorAnchor * _to[1]));\n    }\n  } else {\n    if (_to[0] === 0) {\n      result.push(targetPoint.pos[0] < sourcePoint.pos[0] ? point[0] + minorAnchor : point[0] - minorAnchor);\n    } else {\n      result.push(point[0] + (majorAnchor * _to[0]));\n    }\n\n    if (_to[1] === 0) {\n      result.push(targetPoint.pos[1] < sourcePoint.pos[1] ? point[1] + minorAnchor : point[1] - minorAnchor);\n    } else {\n      result.push(point[1] + (majorAnchor * _so[1]));\n    }\n  }\n  return result;\n}\n\n// 曼哈顿折线路由算法\nfunction _route(conn, fromPt, fromDir, toPt, toDir) {\n\n  // 防止图上节点隐藏NaN的死循环问题\n  fromPt.x = fromPt.x || 0;\n  fromPt.y = fromPt.y || 0;\n  toPt.x = toPt.x || 0;\n  toPt.y = toPt.y || 0;\n\n  const xDiff = fromPt.x - toPt.x;\n  const yDiff = fromPt.y - toPt.y;\n  let point;\n  let dir;\n  let pos;\n\n  conn.push(new Point(fromPt.x, fromPt.y));\n\n  if (((xDiff * xDiff) < (TOLxTOL)) && ((yDiff * yDiff) < (TOLxTOL))) {\n    conn.push(new Point(toPt.x, toPt.y));\n    return;\n  }\n\n  if (fromDir === LEFT) {\n    if ((xDiff > 0) && ((yDiff * yDiff) < TOL) && (toDir === RIGHT)) {\n      point = toPt\n      dir = toDir\n    }\n    else {\n      if (xDiff < 0) {\n        point = new Point(fromPt.x - MINDIST, fromPt.y);\n      }\n      else if (((yDiff > 0) && (toDir === BOTTOM)) || ((yDiff < 0) && (toDir === TOP))) {\n        point = new Point(toPt.x, fromPt.y);\n      }\n      else if (fromDir === toDir) {\n        pos = Math.min(fromPt.x, toPt.x) - MINDIST\n        point = new Point(pos, fromPt.y);\n      }\n      else {\n        point = new Point(fromPt.x - (xDiff / 2), fromPt.y);\n      }\n\n      if (yDiff > 0) {\n        dir = TOP\n      }\n      else {\n        dir = BOTTOM\n      }\n    }\n  } else if (fromDir === RIGHT) {\n    if ((xDiff < 0) && ((yDiff * yDiff) < TOL) && (toDir === LEFT)) {\n      point = toPt\n      dir = toDir\n    }\n    else {\n      if (xDiff > 0) {\n        point = new Point(fromPt.x + MINDIST, fromPt.y);\n      }\n      else if (((yDiff > 0) && (toDir === BOTTOM)) || ((yDiff < 0) && (toDir === TOP))) {\n        point = new Point(toPt.x, fromPt.y);\n      }\n      else if (fromDir === toDir) {\n        pos = Math.max(fromPt.x, toPt.x) + MINDIST\n        point = new Point(pos, fromPt.y);\n      }\n      else {\n        point = new Point(fromPt.x - (xDiff / 2), fromPt.y);\n      }\n\n      if (yDiff > 0) {\n        dir = TOP\n      }\n      else {\n        dir = BOTTOM\n      }\n    }\n  } else if (fromDir === BOTTOM) {\n    if (((xDiff * xDiff) < TOL) && (yDiff < 0) && (toDir === TOP)) {\n      point = toPt\n      dir = toDir\n    }\n    else {\n      if (yDiff > 0) {\n        point = new Point(fromPt.x, fromPt.y + MINDIST)\n      }\n      else if (((xDiff > 0) && (toDir === RIGHT)) || ((xDiff < 0) && (toDir === LEFT))) {\n        point = new Point(fromPt.x, toPt.y)\n      }\n      else if (fromDir === toDir) {\n        pos = Math.max(fromPt.y, toPt.y) + MINDIST\n        point = new Point(fromPt.x, pos)\n      }\n      else {\n        point = new Point(fromPt.x, fromPt.y - (yDiff / 2))\n      }\n\n      if (xDiff > 0) {\n        dir = LEFT\n      }\n      else {\n        dir = RIGHT\n      }\n    }\n  } else if (fromDir === TOP) {\n    if (((xDiff * xDiff) < TOL) && (yDiff > 0) && (toDir === BOTTOM)) {\n      point = toPt\n      dir = toDir\n    }\n    else {\n      if (yDiff < 0) {\n        point = new Point(fromPt.x, fromPt.y - MINDIST)\n      }\n      else if (((xDiff > 0) && (toDir === RIGHT)) || ((xDiff < 0) && (toDir === LEFT))) {\n        point = new Point(fromPt.x, toPt.y)\n      }\n      else if (fromDir === toDir) {\n        pos = Math.min(fromPt.y, toPt.y) - MINDIST\n        point = new Point(fromPt.x, pos)\n      }\n      else {\n        point = new Point(fromPt.x, fromPt.y - (yDiff / 2))\n      }\n\n      if (xDiff > 0) {\n        dir = LEFT\n      }\n      else {\n        dir = RIGHT\n      }\n    }\n  }\n  _route(conn, point, dir, toPt, toDir);\n}\n\nexport default {\n  drawBezier,\n  drawAdvancedBezier,\n  drawStraight,\n  drawFlow,\n  drawManhattan\n};\n","'use strict';\nimport _ from 'lodash';\n\n// todo:丰富箭头样式\nconst arrow = {\n    default1: 'M0 0 L-3 3 L2 0 L-3 -3 Z',\n    default: `M5 0 L0 -2 Q 1.0 0 0 2 Z`,\n    length: 5,\n};\n\n// 计算线条某个位置的斜率\nfunction calcSlope(opts) {\n  let shapeType = _.get(opts, 'shapeType');\n  let dom = _.get(opts, 'dom');\n  let arrowPosition = _.get(opts, 'arrowPosition', 0.5);\n  let path = _.get(opts, 'path');\n  let coordinates = path.split(' ');\n  let x = 0;\n  let y = 0;\n  \n  if (shapeType === 'BezierTest' || shapeType === 'AdvancedBezierTest') {\n    let p0 = {x: coordinates[8], y: coordinates[9]};\n    let p1 = {x: coordinates[1], y: coordinates[2]};\n\n    if (arrowPosition !== 1) {\n      p0 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition + 0.001);\n      p1 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition);\n    } else {\n      p0 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition);\n      p1 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition - 0.001);\n    }\n\n    x = p1.x - p0.x;\n    y = p1.y - p0.y;\n  } else if (shapeType === 'Straight') {\n    let p0 = {x: coordinates[1], y: coordinates[2]};\n    let p1 = {x: coordinates[4], y: coordinates[5]};\n\n    x = p1.x - p0.x;\n    y = p1.y - p0.y;\n  } else {\n    let p0 = 0;\n    let p1 = 1;\n\n    if (arrowPosition !== 1) {\n      p0 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition);\n      p1 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition + 0.001);\n    } else {\n      p0 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition - 0.001);\n      p1 = dom.getPointAtLength(dom.getTotalLength() * arrowPosition);\n    }\n    \n\n    x = p1.x - p0.x;\n    y = p1.y - p0.y;\n  }\n  \n  return {x, y};\n}\n\nexport default {\n  calcSlope,\n  arrow\n};\n","'use strict';\n\nconst $ = require('jquery');\n\nlet svg = null;\n\nlet _initTime = new Date().getTime();\n\nlet init = (_svg) => {\n  svg = _svg;\n  _initTime = new Date().getTime();\n}\n\nlet addAnimate = (targetDom, path, options = {}, animateDom) => {\n  let _animateDom = animateDom;\n  let circle = null;\n  let motion = null;\n  if (!_animateDom) {\n    circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n    motion = document.createElementNS('http://www.w3.org/2000/svg', 'animateMotion');\n    circle.append(motion);\n  }\n\n  if (options._isContinue) {\n    $(_animateDom).find('animateMotion').attr('path', path);\n  } else {\n    let _startTime = (new Date().getTime() - _initTime) / 1000;\n\n    if (_animateDom) {\n      circle = _animateDom;\n      motion = $(_animateDom).find('animateMotion')[0];\n      $(circle).css('display', 'block');\n    }\n\n    circle.setAttribute('cx', 0);\n    circle.setAttribute('cy', 0);\n    circle.setAttribute('r', options.radius || 2);\n    circle.setAttribute('fill', options.color || '#999');\n\n    motion.setAttribute('path', path);\n    motion.setAttribute('begin', `${_startTime}s`);\n    motion.setAttribute('dur', options.dur || '8s');\n    motion.setAttribute('fill', 'freeze');\n    motion.setAttribute('repeatCount', options.repeatCount || 'indefinite');\n\n    if (options.repeatCount && options.repeatCount !== 'indefinite') {\n      setTimeout(() => {\n        $(circle).css('display', 'none');\n      }, parseFloat(options.dur) * parseInt(options.repeatCount) * 1000);\n    }\n  }\n\n  if (!_animateDom) {\n    _animateDom = circle;\n    $(_animateDom).insertAfter(targetDom);\n  }\n\n  return _animateDom;\n}\n\nexport default {\n  init,\n  addAnimate\n}","'use strict';\n\nconst EventEmit3 = require('eventemitter3');\n\nclass Edge extends EventEmit3 {\n  constructor() {\n    // id                 节点唯一标志\n    // targetNode         目标节点\n    // targetEndpoint     目标锚点\n    // sourceNode         源节点\n    // sourceEndpoint     源锚点\n    // type               \"node\" or \"endpoint\"，标志类型的\n    // shapeType          线条类型\n    // label              设置线条上的字体\n    // options            数据的透传\n    // dom                线条dom\n    // labelDom           label的dom\n    // arrowDom           箭头的dom\n\n    \n    // 箭头部分看看需要优化不？\n    // arrow              是否有箭头\n    // arrowPosition      箭头的位置\n    // arrowOffset        箭头起始点\n\n    // 需要优化的\n    // isExpandWidth      拓展线条\n    // eventHandlerDom    代替绑定事件的dom\n    // orientationLimit   限制方向\n\n\n    // 需要优化的\n    // scope           scope相同可拉进group里面\n    // endpoints       endpoint对象\n    // _endpointsData  真实的endpoint数据\n\n    // 需要悬空\n    super();\n  }\n\n  // 渲染节点\n  draw() {}\n\n  // 重绘节点\n  redraw() {}\n\n  // 渲染label\n  drawLabel() {}\n\n  // 重绘label\n  redrawLabel() {}\n\n  // 渲染arrow\n  drawArrow() {}\n\n  // 重回arrow\n  redrawArrow() {}\n\n  // 判断是否能连接的方法\n  isConnect() {}\n\n  // 销毁节点\n  destroy() {}\n\n  // ********* 需要新增的api ********* \n\n  // 删除线条\n  remove() {}\n\n  // 单击的回调\n  click() {}\n\n  // hover的回调\n  hover() {}\n\n  // focus回调\n  focus() {}\n\n  // unFocus回调\n  unFocus() {}\n\n}\n\nexport default Edge;\n","'use strict';\n\nconst _ = require('lodash');\nconst $ = require('jquery');\nimport DrawUtil from '../utils/link';\nimport ArrowUtil from '../utils/arrow';\nimport LinkAnimateUtil from '../utils/link_animate'\n\nimport './baseEdge.less';\n\nimport Edge from '../interface/edge';\nclass BaseEdge extends Edge {\n  constructor(opts) {\n    super(opts);\n    this.id = _.get(opts, 'id');\n    this.targetNode = _.get(opts, 'targetNode');\n    this._targetType = _.get(opts, '_targetType');\n    this.targetEndpoint = _.get(opts, 'targetEndpoint');\n    this.sourceNode = _.get(opts, 'sourceNode');\n    this._sourceType = _.get(opts, '_sourceType');\n    this.sourceEndpoint = _.get(opts, 'sourceEndpoint');\n    this.type = _.get(opts, 'type') || 'endpoint';\n    this.orientationLimit = _.get(opts, 'orientationLimit');\n    this.shapeType = _.get(opts, 'shapeType');\n    this.label = _.get(opts, 'label');\n    this.arrow = _.get(opts, 'arrow');\n    this.arrowPosition = _.get(opts, 'arrowPosition', 0.5);\n    this.arrowOffset = _.get(opts, 'arrowOffset', 0),\n    this.isExpandWidth = _.get(opts, 'isExpandWidth', false);\n    this.defaultAnimate = _.get(opts, 'defaultAnimate', false);\n    this.dom = null;\n    this.labelDom = null;\n    this.arrowDom = null;\n    this.eventHandlerDom = null;\n    // 鸭子辨识手动判断类型\n    this.__type = 'edge';\n    this._path = null;\n    // 业务和库内addEdges写法上有区别，需要兼容\n    this.options = _.get(opts, 'options') || opts;\n    this._isDeletingEdge = opts._isDeletingEdge;\n    this._global = opts._global;\n    this._on = opts._on;\n    this._emit = opts._emit;\n    // 性能优化\n    this._labelWidth = 0;\n    this._labelHeight = 0;\n    // 函数节流\n    this._updateTimer = null;\n    this._UPDATE_INTERVAL = 20;\n    // 线段起始位置\n    this._sourcePoint = null;\n    this._targetPoint = null;\n    // 线段的z-index\n    this._zIndex = 0;\n  }\n  _init() {\n    if (this._isInited) {\n      return;\n    }\n    this._isInited = true;\n    this.dom = this.draw({\n      id: this.id,\n      dom: this.dom,\n      options: this.options\n    });\n    this.labelDom = this.drawLabel(this.label);\n    this.arrowDom = this.drawArrow(this.arrow);\n\n    this._addEventListener();\n  }\n  draw(obj) {\n    let path = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n    path.setAttribute('class', 'butterflies-link');\n    \n    if (this.isExpandWidth) {\n      // 扩大线选中范围\n      this.eventHandlerDom = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n      this.eventHandlerDom.setAttribute('class', 'butterflies-link-event-handler');\n    }\n    return path;\n  }\n  mounted() {\n    if(this.defaultAnimate) {\n      this.addAnimate();\n    }\n  }\n  _calcPath(sourcePoint, targetPoint) {\n    if (!sourcePoint) {\n      sourcePoint = {\n        pos: [\n          // this.type === 'endpoint' ? this.sourceEndpoint._posLeft + this.sourceEndpoint._width / 2 : this.sourceNode.left + this.sourceNode.dom.offsetWidth / 2,\n          // this.type === 'endpoint' ? this.sourceEndpoint._posTop + this.sourceEndpoint._height / 2 : this.sourceNode.top + this.sourceNode.dom.offsetHeight / 2\n          this.type === 'endpoint' ? this.sourceEndpoint._posLeft + this.sourceEndpoint._width / 2 : this.sourceNode.left + $(this.sourceNode.dom).width() / 2,\n          this.type === 'endpoint' ? this.sourceEndpoint._posTop + this.sourceEndpoint._height / 2 : this.sourceNode.top + $(this.sourceNode.dom).height() / 2\n        ],\n        orientation: (this.type === 'endpoint' && this.sourceEndpoint.orientation) ? this.sourceEndpoint.orientation : undefined\n      };\n    }\n\n    if (!targetPoint) {\n      targetPoint = {\n        pos: [\n          // this.type === 'endpoint' ? this.targetEndpoint._posLeft + this.targetEndpoint._width / 2 : this.targetNode.left + this.targetNode.dom.offsetWidth / 2,\n          // this.type === 'endpoint' ? this.targetEndpoint._posTop + this.targetEndpoint._height / 2 : this.targetNode.top + this.targetNode.dom.offsetHeight / 2\n          this.type === 'endpoint' ? this.targetEndpoint._posLeft + this.targetEndpoint._width / 2 : this.targetNode.left + $(this.targetNode.dom).width() / 2,\n          this.type === 'endpoint' ? this.targetEndpoint._posTop + this.targetEndpoint._height / 2 : this.targetNode.top + $(this.targetNode.dom).height() / 2\n        ],\n        orientation: (this.type === 'endpoint' && this.targetEndpoint.orientation) ? this.targetEndpoint.orientation : undefined\n      };\n    }\n    this._sourcePoint = sourcePoint;\n    this._targetPoint = targetPoint;\n    let path = '';\n    if (this.calcPath) {\n      path = this.calcPath(sourcePoint, targetPoint);\n    } else if (this.shapeType === 'Bezier') {\n      path = DrawUtil.drawBezier(sourcePoint, targetPoint);\n    } else if (this.shapeType === 'Straight') {\n      path = DrawUtil.drawStraight(sourcePoint, targetPoint);\n    } else if (this.shapeType === 'Flow') {\n      path = DrawUtil.drawFlow(sourcePoint, targetPoint, this.orientationLimit);\n    } else if (this.shapeType === 'Manhattan') {\n      path = DrawUtil.drawManhattan(sourcePoint, targetPoint);\n    } else if (this.shapeType === 'AdvancedBezier') {\n      path = DrawUtil.drawAdvancedBezier(sourcePoint, targetPoint);\n    }\n    this._path = path;\n    return path;\n  }\n  redrawLabel() {\n    let pathLength = this.dom.getTotalLength() / 2;\n    let centerPoint = this.dom.getPointAtLength(pathLength);\n    $(this.labelDom)\n      .css('left', centerPoint.x - this.labelDom.offsetWidth / 2)\n      .css('top', centerPoint.y - this.labelDom.offsetHeight / 2);\n  }\n  drawLabel(label) {\n    let isDom = typeof HTMLElement === 'object' ? (obj) => {\n      return obj instanceof HTMLElement;\n    } : (obj) => {\n      return obj && typeof obj === 'object' && obj.nodeType === 1 && typeof obj.nodeName === 'string';\n    };\n    if (label) {\n      if (isDom(label)) {\n        $(label).addClass('butterflies-label');\n        return label;\n      } else {\n        let dom = document.createElement('span');\n        dom.className = 'butterflies-label';\n        dom.innerText = label;\n        return dom;\n      }\n    }\n  }\n  updateLabel(label) {\n    let labelDom = this.drawLabel(label);\n    if (this.labelDom) {\n      $(this.labelDom).off();\n      $(this.labelDom).remove();\n    }\n    this.label = label;\n    this.labelDom = labelDom;\n    this.emit('InnerEvents', {\n      type: 'edge:updateLabel',\n      data: this\n    });\n  }\n  redrawArrow(path) {\n    const length = this.dom.getTotalLength();\n    if(!length) {\n      return;\n    }\n    this.arrowFinalPosition = (length * this.arrowPosition + this.arrowOffset) / length;\n    if (this.arrowFinalPosition > 1) {\n      this.arrowFinalPosition = 1;\n    }\n    if (this.arrowFinalPosition < 0) {\n      this.arrowFinalPosition = 0;\n    }\n    // 防止箭头窜出线条\n    if (1 - this.arrowFinalPosition < ArrowUtil.arrow.length / length) {\n      this.arrowFinalPosition = (length * this.arrowFinalPosition - ArrowUtil.arrow.length) / length;\n    }\n    // 贝塞尔曲线是反着画的，需要调整\n    if (this.shapeType === 'Bezier') {\n      this.arrowFinalPosition = 1 - this.arrowFinalPosition;\n    }\n\n    let point = this.dom.getPointAtLength(length * this.arrowFinalPosition);\n    let x = point.x;\n    let y = point.y;\n\n    let vector = ArrowUtil.calcSlope({\n      shapeType: this.shapeType,\n      dom: this.dom,\n      arrowPosition: this.arrowFinalPosition,\n      path: path\n    });\n    let deg = Math.atan2(vector.y, vector.x) / Math.PI * 180;\n\n    this.arrowDom.setAttribute('d', ArrowUtil.arrow.default);\n    this.arrowDom.setAttribute('transform', `rotate(${deg}, ${x}, ${y})translate(${x}, ${y})`);\n  }\n  drawArrow(arrow) {\n    if (arrow) {\n      let path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n      path.setAttribute('class', 'butterflies-arrow');\n      return path;\n    }\n  }\n  redraw(sourcePoint, targetPoint, options) {\n    // 重新计算线条path\n    let path = this._calcPath(sourcePoint, targetPoint);\n\n    this.dom.setAttribute('d', path);\n    if (this.isExpandWidth) {\n      this.eventHandlerDom.setAttribute('d', path);\n      $(this.eventHandlerDom).insertAfter(this.dom);\n    }\n    // 函数节流\n    if (!this._updateTimer) {\n      this._updateTimer = setTimeout(() => {\n        // 重新计算label\n        if (this.labelDom) {\n          this.redrawLabel();\n        }\n        // 重新计算arrow\n        if (this.arrowDom) {\n          this.redrawArrow(path);\n        }\n        // 重新计算动画path\n        if (this.animateDom) {\n          this.redrawAnimate(path);\n        }\n        this._updateTimer = null;\n      }, this._UPDATE_INTERVAL);\n    }\n\n    this.updated && this.updated();\n  }\n  isConnect() {\n    return true;\n  }\n  addAnimate(options) {\n    this.animateDom = LinkAnimateUtil.addAnimate(this.dom, this._path, _.assign({},{\n      num: 1, // 现在只支持1个点点\n      radius: 3,\n      color: '#776ef3'\n    }, options), this.animateDom);\n  }\n  redrawAnimate(path) {\n    LinkAnimateUtil.addAnimate(this.dom, this._path, {\n      _isContinue: true\n    }, this.animateDom);\n  }\n  emit(type, data) {\n    super.emit(type, data);\n    this._emit(type, data);\n  }\n  on(type, callback) {\n    super.on(type, callback);\n    this._on(type, callback);\n  }\n  remove() {\n    this.emit('InnerEvents', {\n      type: 'edge:delete',\n      data: this\n    });\n  }\n  setZIndex(index) {\n    this.emit('InnerEvents', {\n      type: 'edge:setZIndex',\n      edge: this,\n      index: index\n    })\n  }\n  destroy(isNotEventEmit) {\n    if (this.labelDom) {\n      $(this.labelDom).off();\n      $(this.labelDom).remove();\n    }\n    if (this.arrowDom) {\n      $(this.arrowDom).remove();\n    }\n    if (this.eventHandlerDom) {\n      $(this.eventHandlerDom).off();\n      $(this.eventHandlerDom).remove();\n    }\n    if (this.animateDom) {\n      $(this.animateDom).remove();\n    }\n    $(this.dom).remove();\n    if (this.id && !isNotEventEmit) {\n      this.removeAllListeners();\n    }\n  }\n  _addEventListener() {\n    let _emitEvent = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.emit('system.link.click', {\n        edge: this\n      });\n      this.emit('events', {\n        type: 'link:click',\n        edge: this\n      });\n\n      this.emit('InnerEvents', {\n        type: 'link:click',\n        data: this\n      });\n    };\n    \n    if (this.isExpandWidth) {\n      $(this.eventHandlerDom).on('click', _emitEvent);\n    } else {\n      $(this.dom).on('click', _emitEvent);\n    }\n  }\n  _create(opts) {\n    this.id = _.get(opts, 'id') || this.id;\n    this.targetNode = _.get(opts, 'targetNode') || this.targetNode;\n    this._targetType = _.get(opts, '_targetType') || this._targetType;\n    this.targetEndpoint = _.get(opts, 'targetEndpoint') || this.targetEndpoint;\n    this.sourceNode = _.get(opts, 'sourceNode') || this.sourceNode;\n    this._sourceType = _.get(opts, '_sourceType') || this._sourceType;\n    this.sourceEndpoint = _.get(opts, 'sourceEndpoint') || this.sourceEndpoint;\n    this.type = _.get(opts, 'type') || this.type;\n    _.set(this, 'options.targetNode', _.get(this, 'targetNode.id'));\n    _.set(this, 'options.targetEndpoint', _.get(this, 'targetEndpoint.id'));\n    this.redraw();\n  }\n}\n\nexport default BaseEdge;\n","'use strict';\n\nconst EventEmit3 = require('eventemitter3');\n\nclass Group extends EventEmit3 {\n  constructor() {\n    // id        节点唯一标志\n    // top       坐标y\n    // left      坐标x\n    // width     节点组宽度\n    // height    节点组高度\n    // resize    标志是否能resize\n    // dom       实际的dom\n    // nodes     里面包含的节点对象\n    // options   数据的透传\n    // _on       节点发送事件\n    // _emit     节点发送事件\n    // _global   全局的配置\n\n\n\n    // 需要优化的\n    // scope           scope相同可拉进group里面\n    // endpoints       endpoint对象\n    // _endpointsData  真实的endpoint数据\n    super();\n  }\n\n  // 渲染节点\n  draw() {}\n\n  // 添加节点\n  addNode() {}\n\n  // 批量添加节点\n  addNodes() {}\n\n  // 获取宽度\n  getWidth() {}\n\n  // 获取高度\n  getHeight() {}\n\n  // 删除节点\n  removeNode() {}\n\n  // 批量删除节点\n  removeNodes() {}\n\n  // 设置是否可缩放\n  setResize() {}\n\n  // 设置大小\n  setSize() {}\n  \n  // 移动group\n  moveTo() {}\n\n  // 获取锚点\n  getEndpoint() {}\n\n  // 添加锚点\n  addEndpoint() {}\n\n  // remove的方法\n  remove() {}\n\n  // 销毁的方法\n  destroy() {}\n\n  // ********* 需要新增的api ********* \n\n  // 删除锚点\n  removeEndpoint() {}\n\n  // 折叠的方法\n  collapse() {}\n\n  // 伸展的方法\n  stretch() {}\n\n  // 单击的回调\n  click() {}\n\n  // 双击的回调\n  doubleClick() {}\n\n  // 右键的回调\n  onContextmenu() {}\n\n  // hover的回调\n  hover() {}\n\n  // focus回调\n  focus() {}\n\n  // unFocus回调\n  unFocus() {}\n}\n\nexport default Group;\n","'use strict';\n\nconst _ = require('lodash');\n\n// 检验scope是否匹配\nexport default (scope1, scope2, isScopeStrict) => {\n  let _scope1 = (scope1 || '').split(' ').filter(item => !!item);\n  let _scope2 = (scope2 || '').split(' ').filter(item => !!item);\n  if (!isScopeStrict && (!scope1 || !scope2)) {\n    return true;\n  } else if (isScopeStrict && !scope1 && !scope2) {\n    return true;\n  }\n  let totalScope = _scope1.concat(_scope2);\n  let uniqScope = _.uniq(totalScope);\n  \n  if (totalScope.length === uniqScope.length) {\n    return false;\n  } else {\n    return true;\n  }\n};\n","'use strict';\n\nimport './baseGroup.less';\n\nconst $ = require('jquery');\nconst _ = require('lodash');\n\nimport Group from '../interface/group';\nimport Endpoint from '../endpoint/baseEndpoint';\n\n// scope的比较\nimport ScopeCompare from '../utils/scopeCompare';\n\nclass BaseGroup extends Group {\n  constructor(opts) {\n    super(opts);\n    this.id = opts.id;\n    this.scope = opts.scope;\n    this.top = opts.top;\n    this.left = opts.left;\n    this.width = opts.width || 300;\n    this.height = opts.height || 150;\n    this.resize = opts.resize;\n    this.draggable = opts.draggable;\n    this.dom = null;\n    this.nodes = [];\n    this.options = opts.options;\n    // 鸭子辨识手动判断类型\n    this.__type = 'group';\n    this._global = opts._global;\n    this._on = opts._on;\n    this._emit = opts._emit;\n    this._container = null;\n    // endpoint 这部分需要考虑\n    this.endpoints = [];\n    this._endpointsData = opts.endpoints;\n    // 记录节点是否在拖动\n    // this._dragingNode = undefined;\n  }\n  init() {\n    this.dom = this.draw({\n      id: this.id,\n      top: this.top,\n      left: this.left,\n      width: this.width,\n      height: this.height,\n      dom: this.dom,\n      options: this.options\n    });\n    this._addEventListener();\n  }\n  draw(obj) {\n    let _dom = obj.dom;\n    if (!_dom) {\n      _dom = $('<div></div>')\n        .attr('class', 'group')\n        .attr('id', obj.id);\n    }\n    let group = $(_dom);\n    \n    let titleDom = $('<div></div>')\n      .attr('class', 'title');\n    \n    if (_.get(this, 'options.title')) {\n      titleDom.text(_.get(this, 'options.title'));\n    }\n\n    group.append(titleDom);\n\n    this._container = $('<div></div>')\n      .attr('class', 'container');\n    \n    group.append(this._container);\n\n    // 默认resize打开\n    if (this.resize !== false) {\n      this.setResize(true, group);\n    }\n\n    if (obj.top !== undefined) {\n      group.css('top', obj.top + 'px');\n    }\n    if (obj.left !== undefined) {\n      group.css('left', obj.left + 'px');\n    }\n    if (obj.width !== undefined) {\n      group.css('width', obj.width + 'px');\n    }\n    if (obj.height !== undefined) {\n      group.css('height', obj.height + 'px');\n    }\n\n    this.updated && this.updated();\n    return group[0];\n  }\n  addNodes(nodes = [], isNotEventEmit) {\n    let _nodes = [];\n    nodes.forEach((item) => {\n      if (ScopeCompare(item.scope, this.scope, _.get(this, '_global.isScopeStrict'))) {\n        _nodes.push(item);\n      } else {\n        console.log(`nodeId为${item.id}的节点和groupId${this.id}的节点组scope值不符，无法加入`);\n      }\n    });\n    this.emit('InnerEvents', {\n      type: 'group:addNodes',\n      nodes: nodes,\n      group: this,\n      isNotEventEmit\n    });\n  }\n  addNode(node) {\n    this.addNodes([node]);\n  }\n  removeNodes(nodes = [], isNotEventEmit) {\n    let rmNodes = [];\n    this.nodes.forEach((item) => {\n      let _node = _.find(nodes, (_node) => {\n        return _node.id === item.id;\n      });\n      if (_node) {\n        rmNodes.push(_node);\n      }\n    })\n    // this.nodes.forEach((item) => {\n    //   let _node = _.find(nodes, (_node) => {\n    //     return _node.id === item.id;\n    //   });\n    //   if (_node) {\n    //     rmNodes.push(_node);\n    //   }\n    // });\n    this.emit('InnerEvents', {\n      type: 'group:removeNodes',\n      group: this,\n      nodes: rmNodes,\n      isNotEventEmit\n    });\n    if (!isNotEventEmit) {\n      this.emit('events', {\n        type: 'system.group.removeNodes',\n        group: this,\n        nodes: rmNodes,\n        group: targetGroup\n      });\n      this.emit('system.group.removeNodes', {\n        group: this,\n        nodes: rmNodes,\n        group: targetGroup\n      });\n    }\n    return rmNodes;\n  }\n  removeNode(node) {\n    return this.removeNodes([node]);\n  }\n  setResize(flat, container = this.dom, resizeDom) {\n    let mouseDown = (event) => {\n      const LEFT_KEY = 0;\n      if (event.button !== LEFT_KEY) {\n        return;\n      }\n      event.preventDefault();\n      // event.stopPropagation();\n      this.emit('InnerEvents', {\n        type: 'group:resize',\n        group: this\n      });\n    };\n    if (flat) {\n      let icon = null;\n      if (resizeDom) {\n        icon = $(resizeDom);\n        icon.addClass('butterfly-group-icon-resize');\n      } else {\n        icon = $('<span class=\"butterfly-group-icon-resize group-icon-resize butterfly-icon icon-drag\"></span>')\n      }\n      icon.appendTo(container);\n      icon.on('mousedown', mouseDown);\n    }\n  }\n  setSize(width = this.width, height = this.height) {\n    this.width = width;\n    this.height = height;\n    $(this.dom).css('width', this.width).css('height', this.height);\n  }\n  remove() {\n    this.emit('InnerEvents', {\n      type: 'group:delete',\n      data: this\n    });\n  }\n  _moveTo(x, y) {\n    // 自身移动\n    $(this.dom).css('top', y).css('left', x);\n    // 所在节点的锚点移动\n    this.nodes.forEach((node) => {\n      node.endpoints.forEach((point) => {\n        point.updatePos();\n      });\n    });\n    // 节点组的锚点移动\n    this.endpoints.forEach((item) => {\n      item.moveTo(x - this.left + item._left, y - this.top + item._top);\n    });\n    this.top = y;\n    this.left = x;\n  }\n  moveTo(x, y, isNotEventEmit) {\n    this.emit('InnerEvents', {\n      type: 'group:move',\n      group: this,\n      x,\n      y,\n      isNotEventEmit\n    });\n  }\n  focus() {\n\n  }\n  unFocus() {\n    \n  }\n  getWidth() {\n    return this.width;\n  }\n  getHeight() {\n    return this.height;\n  }\n  getEndpoint(pointId) {\n    return _.find(this.endpoints, point => pointId === point.id);\n  }\n  _appendNodes(nodes = []) {\n    nodes.forEach((item) => {\n      item._group = this;\n      item.group = this.id;\n      $(this.dom).append(item.dom);\n      this.nodes.push(item);\n    });\n  }\n  _addEventListener() {\n    // 节点组点击事件\n    $(this.dom).on('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.emit('system.group.click', {\n        group: this\n      });\n      this.emit('events', {\n        type: 'group:click',\n        group: this\n      });\n    });\n    // 节点组鼠标点下事件\n    $(this.dom).on('mousedown', (e) => {\n      // 兼容节点冒泡上来的事件\n      let isChildNodeMoving = _.some(this.nodes, (item) => {\n        return item._isMoving;\n      });\n      if (isChildNodeMoving) {\n        return;\n      }\n      // 兼容resize按钮冒泡上来的事件\n      if($(e.target).attr('class').indexOf('butterfly-group-icon-resize') !== -1) {\n        return;\n      }\n\n      const LEFT_KEY = 0;\n      if (e.button !== LEFT_KEY) {\n        return;\n      }\n      e.preventDefault();\n      // e.stopPropagation();\n      if (this.draggable) {\n        this.emit('InnerEvents', {\n          type: 'group:dragBegin',\n          data: this\n        });\n      }\n    });\n    // 节点移入移出事件\n    // this.dom.addEventListener('mousemove', (e) => {\n    //   if (this._dragingNode) {\n    //     if (this.scope && this.scope !== this._dragingNode.scope) {\n    //       return;\n    //     }\n    //     $(this.dom).addClass('butterfly-group-hover');\n    //   }\n    // });\n    // this.dom.addEventListener('mouseout', (e) => {\n    //   if (this._dragingNode) {\n    //     $(this.dom).removeClass('butterfly-group-hover');\n    //     this._dragingNode = undefined;\n    //   }\n    // });\n    // // 监听节点在移动\n    // this.on('system.drag.start', (data) => {\n    //   if (data.dragType === 'node:drag' && data.dragNode && !data.dragNode._group) {\n    //     this._dragingNode = data.dragNode;\n    //     console.log('----');\n    //     console.log(this._dragingNode);\n    //   }\n    // });\n    // this.on('system.drag.end', (data) => {\n    //   if (data.dragType === 'node:drag' && data.dragNode && !data.dragNode._group) {\n    //     this._dragingNode = undefined;\n    //   }\n    // });\n  }\n  _createEndpoint(isInited) {\n    if (isInited) {\n      this.endpoints.forEach(item => this.addEndpoint(item, isInited));\n    } else if (this._endpointsData) {\n      this._endpointsData.map(item => this.addEndpoint(item));\n    }\n  }\n  addEndpoint(obj, isInited) {\n    if (isInited) {\n      this.emit('InnerEvents', {\n        type: 'group:addEndpoint',\n        data: obj,\n        isInited\n      });\n      return obj;\n    }\n    // 这部分可能还需要想一下\n    const EndpointClass = obj.Class || Endpoint;\n    const endpoint = new EndpointClass(_.assign({\n      _on: this._on,\n      _emit: this._emit,\n      _node: this,\n      _global: this._global,\n    }, obj));\n\n    this.emit('InnerEvents', {\n      type: 'group:addEndpoint',\n      data: endpoint,\n    });\n    this.endpoints.push(endpoint);\n    return endpoint;\n  }\n  emit(type, data) {\n    super.emit(type, data);\n    this._emit(type, data);\n  }\n  on(type, callback) {\n    super.on(type, callback);\n    this._on(type, callback);\n  }\n  destroy(isNotEventEmit) {\n    this.endpoints.forEach((item) => {\n      !item._isInitedDom && item.destroy();\n    });\n    $(this.dom).off();\n    $(this.dom).remove();\n    if (!isNotEventEmit) {\n      this._emit('system.group.delete', {\n        group: this\n      });\n      this._emit('events', {\n        type: 'group:delete',\n        group: this\n      });\n      this.removeAllListeners();\n    }\n  }\n}\n\nexport default BaseGroup;\n","'use strict';\n\nfunction circleLayout(params) {\n  let radius = params.radius;\n  let nodes = params.data.nodes.filter((node) => {\n    return node._isCircle;\n  });\n\n  let _preAngle = 360 / nodes.length;\n  let _halfWidth = 0;\n  if (params.getWidth) {\n    _halfWidth = params.getWidth() / 2;\n  }\n  let _halfHeight = 0;\n  if (params.getHeight) {\n    _halfWidth = params.getHeight() / 2;\n  }\n\n  nodes.forEach((item, index) => {\n    let radian = (2 * Math.PI) / 360;\n    let angle = index * _preAngle;\n    let _top = (radius * Math.sin(angle * radian) - _halfHeight);\n    let _left = (radius * Math.cos(angle * radian) - _halfWidth);\n\n    let _textTop = ((radius + 30) * Math.sin(angle * radian) - _halfHeight);\n    let _textLeft = ((radius + 30) * Math.cos(angle * radian) - _halfWidth);\n\n    item.top = _top;\n    item.left = _left;\n    item.posInfo = {\n      angle: angle,\n      _textTop: _textTop,\n      _textLeft: _textLeft\n    };\n  });\n}\n\n// module.exports = circleLayout;\nexport default {\n  circleLayout\n};","'use strict';\nconst SPEED_DIVISOR = 800;\nfunction fruchterman (param) {\n    const self = param.opts\n    const nodes = param.data.nodes;\n  \n    const center = self.center;\n  \n    if (!nodes || nodes.length === 0) {\n      return;\n    }\n    if (nodes.length === 1) {\n      nodes[0].x = center[0];\n      nodes[0].y = center[1];\n      return;\n    }\n    const nodeMap = {};\n    const nodeIdxMap = {};\n    nodes.forEach((node, i) => {\n      if ( !_.isNumber(node.x)) node.x = Math.random() * self.width;\n      if ( !_.isNumber(node.y)) node.y = Math.random() * self.height;\n      nodeMap[node.id] = node;\n      nodeIdxMap[node.id] = i;\n    });\n    self.nodeMap = nodeMap;\n    self.nodeIdxMap = nodeIdxMap;\n    \n    // layout\n    run(param);\n  }\n  \n   function run(param) {\n    const self = param.opts;\n    const nodes = param.data.nodes;\n    const edges = param.data.edges;\n    const maxIteration = self.maxIteration;\n    if (!self.width && typeof window !== 'undefined') {\n      self.width = window.innerWidth;\n    }\n    if (!self.height && typeof window !== 'undefined') {\n      self.height = window.innerHeight;\n    }\n    const center = self.center;\n    const maxDisplace = self.width / 10;\n    const k = Math.sqrt((self.width * self.height) / (nodes.length + 1));\n    const gravity = self.gravity;\n    const speed = self.speed;\n    const clustering = self.clustering;\n    const clusterMap= {};\n    if (clustering) {\n      nodes.forEach((n) => {\n        if (clusterMap[n.cluster] === undefined) {\n          const cluster = {\n            name: n.cluster,\n            cx: 0,\n            cy: 0,\n            count: 0,\n          };\n          clusterMap[n.cluster] = cluster;\n        }\n        const c = clusterMap[n.cluster];\n        if ( _.isNumber( n.x)) {\n          c.cx += n.x;\n        }\n        if ( _.isNumber( n.y)) {\n          c.cy += n.y;\n        }\n        c.count++;\n      });\n      for (const key in clusterMap) {\n        clusterMap[key].cx /= clusterMap[key].count;\n        clusterMap[key].cy /= clusterMap[key].count;\n      }\n    }\n    for (let i = 0; i < maxIteration; i++) {\n      const displacements = [];\n      nodes.forEach((_, j) => {\n        displacements[j] = { x: 0, y: 0 };\n      });\n  \n      applyCalculate(nodes, edges, displacements, k,self);\n  \n      // gravity for clusters\n      if (clustering) {\n        const clusterGravity = self.clusterGravity || gravity;\n        nodes.forEach((n, j) => {\n          if ( !_.isNumber(n.x) ||  !_.isNumber(n.y)) return;\n          const c = clusterMap[n.cluster];\n          const distLength = Math.sqrt((n.x - c.cx) * (n.x - c.cx) + (n.y - c.cy) * (n.y - c.cy));\n          const gravityForce = k * clusterGravity;\n          displacements[j].x -= (gravityForce * (n.x - c.cx)) / distLength;\n          displacements[j].y -= (gravityForce * (n.y - c.cy)) / distLength;\n        });\n  \n        for (const key in clusterMap) {\n          clusterMap[key].cx = 0;\n          clusterMap[key].cy = 0;\n          clusterMap[key].count = 0;\n        }\n  \n        nodes.forEach((n) => {\n          const c = clusterMap[n.cluster];\n          if ( _.isNumber(n.x )) {\n            c.cx += n.x;\n          }\n          if ( _.isNumber(n.y )) {\n            c.cy += n.y;\n          }\n          c.count++;\n        });\n        for (const key in clusterMap) {\n          clusterMap[key].cx /= clusterMap[key].count;\n          clusterMap[key].cy /= clusterMap[key].count;\n        }\n      }\n  \n     // gravity\n     nodes.forEach((n, j) => {\n        if (!_.isNumber(n.x) || !_.isNumber(n.y)) return;\n        const gravityForce = 0.01 * k * gravity;\n        displacements[j].x -= gravityForce * (n.x - center[0]);\n        displacements[j].y -= gravityForce * (n.y - center[1]);\n      });\n      // move\n      nodes.forEach((n, j) => {\n        if (!_.isNumber(n.x) || !_.isNumber(n.y)) return;\n        const distLength = Math.sqrt(\n          displacements[j].x * displacements[j].x + displacements[j].y * displacements[j].y,\n        );\n        if (distLength > 0) {\n          // && !n.isFixed()\n          const limitedDist = Math.min(maxDisplace * (speed / SPEED_DIVISOR), distLength);\n          n.x += (displacements[j].x / distLength) * limitedDist;\n          n.y += (displacements[j].y / distLength) * limitedDist;\n        }\n      });\n    }\n  }\n  \n   function applyCalculate(nodes, edges, displacements, k,self) {\n    calRepulsive(nodes, displacements, k);\n    calAttractive(edges, displacements, k,self);\n  }\n  \n  function calRepulsive(nodes , displacements, k) {\n    nodes.forEach((v, i) => {\n      displacements[i] = { x: 0, y: 0 };\n      nodes.forEach((u, j) => {\n        if (i === j) {\n          return;\n        }\n        if (!_.isNumber(v.x) || !_.isNumber(u.x) || !_.isNumber(v.y) || !_.isNumber(u.y)) return;\n        let vecX = v.x - u.x;\n        let vecY = v.y - u.y;\n        let vecLengthSqr = vecX * vecX + vecY * vecY;\n        if (vecLengthSqr === 0) {\n          vecLengthSqr = 1;\n          const sign = i > j ? 1 : -1;\n          vecX = 0.01 * sign;\n          vecY = 0.01 * sign;\n        }\n        const common = (k * k) / vecLengthSqr;\n        displacements[i].x += vecX * common;\n        displacements[i].y += vecY * common;\n      });\n    });\n  }\n  \n  function calAttractive(edges, displacements, k,self) {\n    edges.forEach((e) => {\n      if (!e.source || !e.target) return;\n      const uIndex = self.nodeIdxMap[e.source];\n      const vIndex = self.nodeIdxMap[e.target];\n      if (uIndex === vIndex) {\n        return;\n      }\n      const u = self.nodeMap[e.source];\n      const v = self.nodeMap[e.target];\n      if (!_.isNumber(v.x) || !_.isNumber(u.x) || !_.isNumber(v.y) || !_.isNumber(u.y)) return;\n      const vecX = v.x - u.x;\n      const vecY = v.y - u.y;\n      const vecLength = Math.sqrt(vecX * vecX + vecY * vecY);\n      const common = (vecLength * vecLength) / k;\n      displacements[vIndex].x -= (vecX / vecLength) * common;\n      displacements[vIndex].y -= (vecY / vecLength) * common;\n      displacements[uIndex].x += (vecX / vecLength) * common;\n      displacements[uIndex].y += (vecY / vecLength) * common;\n    });\n  }\nmodule.exports = fruchterman;\n//   export default {\n//     fruchterman\n//   };","\nfunction gridLayout (param) {\n    const self = param.opts;\n    const nodes = param.data.nodes;\n    const n = nodes.length;\n    const center = self.center;\n    if (n === 0) {\n      return;\n    }\n    if (n === 1) {\n      nodes[0].x = center[0];\n      nodes[0].y = center[1];\n      return;\n    }\n  \n    const edges = param.data.edges;\n    const layoutNodes = [];\n    nodes.forEach((node) => {\n      layoutNodes.push(node);\n    });\n    const nodeIdxMap = {};\n    layoutNodes.forEach((node, i) => {\n      nodeIdxMap[node.id] = i;\n    });\n  \n    // 排序\n    if (\n      self.sortBy === 'degree' ||\n      typeof self.sortBy === 'string' ||\n      layoutNodes[0][self.sortBy] === undefined\n    ) {\n      self.sortBy = 'degree';\n      if (isNaN(nodes[0].degree)) {\n        const values = getDegree(layoutNodes.length, nodeIdxMap, edges);\n        layoutNodes.forEach((node, i) => {\n          node.degree = values[i];\n        });\n      }\n    }\n    // sort nodes by value\n    layoutNodes.sort((n1, n2) => (n2)[self.sortBy] - (n1)[self.sortBy]);\n  \n    if (!self.width && typeof window !== 'undefined') {\n      self.width = window.innerWidth;\n    }\n    if (!self.height && typeof window !== 'undefined') {\n      self.height = window.innerHeight;\n    }\n  \n    const oRows = self.rows;\n    const oCols = self.cols != null ? self.cols : self.columns;\n    self.cells = n;\n  \n    // if rows or columns were set in self, use those values\n    if (oRows != null && oCols != null) {\n      self.rows = oRows;\n      self.cols = oCols;\n    } else if (oRows != null && oCols == null) {\n      self.rows = oRows;\n      self.cols = Math.ceil(self.cells / self.rows);\n    } else if (oRows == null && oCols != null) {\n      self.cols = oCols;\n      self.rows = Math.ceil(self.cells / self.cols);\n    } else {\n      // otherwise use the automatic values and adjust accordingly\t      // otherwise use the automatic values and adjust accordingly\n      // width/height * splits^2 = cells where splits is number of times to split width\n      self.splits = Math.sqrt((self.cells * self.height) / self.width);\n      self.rows = Math.round(self.splits);\n      self.cols = Math.round((self.width / self.height) * self.splits);\n    }\n  \n    self.cellWidth = self.width / self.cols;\n    self.cellHeight = self.height / self.rows;\n  \n    if (self.condense) {\n      self.cellWidth = 0;\n      self.cellHeight = 0;\n    }\n  \n    if (self.preventOverlap) {\n      layoutNodes.forEach((node) => {\n        if (!node.x || !node.y) {\n          // for bb\n          node.x = 0;\n          node.y = 0;\n        }\n  \n        let nodew;\n        let nodeh;\n        // if (isArray(node.size)) {\n        //   nodew = node.size[0];\n        //   nodeh = node.size[1];\n        // } else \n        if ( typeof node.size === 'number') {\n          nodew = node.size;\n          nodeh = node.size;\n        }\n        if (nodew === undefined || nodeh === undefined) {\n          // if (isArray(self.nodeSize)) {\n          //   nodew = self.nodeSize[0];\n          //   nodeh = self.nodeSize[1];\n          // } else \n          if ( typeof node.nodeSize === 'number') {\n            nodew = self.nodeSize;\n            nodeh = self.nodeSize;\n          } else {\n            nodew = 30;\n            nodeh = 30;\n          }\n        }\n  \n        const p = self.preventOverlapPadding;\n  \n        const w = nodew + p;\n        const h = nodeh + p;\n  \n        self.cellWidth = Math.max(self.cellWidth, w);\n        self.cellHeight = Math.max(self.cellHeight, h);\n      });\n    }\n  \n    self.cellUsed = {}; // e.g. 'c-0-2' => true\n  \n    // to keep track of current cell position\n    self.row = 0;\n    self.col = 0;\n  \n    // get a cache of all the manual positions\n    self.id2manPos = {};\n    for (let i = 0; i < layoutNodes.length; i++) {\n      const node = layoutNodes[i];\n      let rcPos;\n      if (self.position) {\n        rcPos = self.position(node);\n      }\n  \n      if (rcPos && (rcPos.row !== undefined || rcPos.col !== undefined)) {\n        // must have at least row or col def'd\n        const pos = {\n          row: rcPos.row,\n          col: rcPos.col,\n        };\n  \n        if (pos.col === undefined) {\n          // find unused col\n          pos.col = 0;\n  \n          while (used(pos.row, pos.col,self)) {\n            pos.col++;\n          }\n        } else if (pos.row === undefined) {\n          // find unused row\n          pos.row = 0;\n  \n          while (used(pos.row, pos.col,self)) {\n            pos.row++;\n          }\n        }\n  \n        self.id2manPos[node.id] = pos;\n        use(pos.row, pos.col);\n      }\n      getPos(node,self);\n    }\n    \n  }\n  \n  function getDegree (n, nodeIdxMap, edges) {\n    const degrees = [];\n    for (let i = 0; i < n; i++) {\n      degrees[i] = 0;\n    }\n    edges.forEach((e) => {\n      if (e.source) {\n        degrees[nodeIdxMap[e.source]] += 1;\n      }\n      if (e.target) {\n        degrees[nodeIdxMap[e.target]] += 1;\n      }\n    });\n    return degrees;\n  };\n  \n  function use(row, col,self) {\n    self.cellUsed[`c-${row}-${col}`] = true;\n  }\n  \n  function used(row, col,self) {\n    return self.cellUsed[`c-${row}-${col}`] || false;\n  }\n  \n  function moveToNextCell(param) {\n    const self = param;\n    const cols = self.cols || 5;\n    self.col++;\n    if (self.col >= cols) {\n      self.col = 0;\n      self.row++;\n    }\n  }\n  \n  function getPos(node,param) {\n    const self = param;\n    const begin = self.begin;\n    const cellWidth = self.width;\n    const cellHeight = self.height;\n    let x;\n    let y;\n  \n    // see if we have a manual position set\n    const rcPos = self.id2manPos[node.id];\n    if (rcPos) {\n      x = rcPos.col * cellWidth + cellWidth / 2 + begin[0];\n      y = rcPos.row * cellHeight + cellHeight / 2 + begin[1];\n    } else {\n      // otherwise set automatically\n      while (used(self.row, self.col,self)) {\n        moveToNextCell(param);\n      }\n  \n      x = self.col * cellWidth + cellWidth / 2 + begin[0];\n      y = self.row * cellHeight + cellHeight / 2 + begin[1];\n      use(self.row, self.col,self);\n  \n      moveToNextCell(param);\n    }\n    node.x = x;\n    node.y = y;\n    node.left = x;\n    node.top = y\n  }\n  \n  module.exports = gridLayout;","const d3 = require('d3-force');\n// 离散布局\nfunction forceLayout(param) {\n    let opts = param.opts;\n    let data = _.cloneDeep(param.data);\n  \n    // 处理groups的布局,把group当成一个节点\n    let nodes = data.nodes.filter((item) => {\n      return !item.group;\n    });\n    let groupNodes = data.nodes.filter((item) => {\n      return item.group;\n    });\n  \n    nodes = nodes.concat(data.groups);\n  \n    // 在group内先random布局一下\n    groupNodes.forEach((item) => {\n      let group = _.find(data.groups, (_group) => {\n        return _group.id === item.group;\n      });\n      item.x = Math.random() * (group.width || 150);\n      item.y = Math.random() * (group.height || 120);\n    });\n  \n    let edges = data.edges.map((_edge) => {\n      let souceNode = _.find(groupNodes, (_node) => {\n        return _node.source === _edge.id;\n      });\n      if (souceNode) {\n        _edge.source = souceNode.group;\n      }\n      let targetNode = _.find(groupNodes, (_node) => {\n        return _node.target === _edge.id;\n      });\n      if (targetNode) {\n        _edge.target = souceNode.group;\n      }\n      return _edge;\n    });\n  \n  \n    let simulation = d3.forceSimulation(nodes)\n      .force('charge', (() => {\n        if (opts.chargeStrength) {\n          return d3.forceManyBody().strength(opts.chargeStrength);\n        } else {\n          return d3.forceManyBody();\n        }\n      })())\n      .force('center', d3.forceCenter(opts.width / 2, opts.height / 2))\n      .force('link', d3.forceLink(edges).id((node) => {\n        return node[_.get(opts.link, 'id', 'id')];\n      }).distance(opts.link.distance).strength(opts.link.strength))\n      .stop();\n  \n    for (var i = 0, n = Math.ceil(Math.log(simulation.alphaMin()) / Math.log(1 - simulation.alphaDecay())); i < n; ++i) {\n      simulation.tick();\n    }\n  \n  \n    param.data.nodes.forEach((node, index) => {\n      node.top = data.nodes[index].y;\n      node.left = data.nodes[index].x;\n    });\n  \n  \n    param.data.groups.forEach((group, index) => {\n      group.top = data.groups[index].y;\n      group.left = data.groups[index].x;\n    });\n    // 后续需要考虑group的布局\n  \n  }\n\nmodule.exports = forceLayout","// 同心圆布局\nfunction concentLayout(param) {\n    let {\n      center,\n      nodeSize,\n      minNodeSpacing,\n      preventOverlap,\n      sweep,\n      equidistant,\n      startAngle = (3 / 2) * Math.PI,\n      clockwise,\n      maxLevelDiff,\n      sortBy,\n      width,\n      height,\n      data,\n    } = param;\n    const curnode = data.nodes;\n    const curedges = data.edges;\n    let nodes = curnode.map((item) => {\n      return {\n        id: item.id,\n        top: item.top,\n        left: item.left,\n        degree: item.degree,\n        size: item.size,\n      }\n    });\n    let edges = curedges.map((item) => {\n      return {\n        source: item.source,\n        target: item.target,\n      }\n    });\n    const n = nodes.length;\n    let maxValueNode;\n    let counterclockwise;\n    if (n === 0) {\n      return;\n    }\n    if (n === 1) {\n      nodes[0].x = center[0];\n      nodes[0].y = center[1];\n      return;\n    }\n    const layoutNodes = [];\n    let maxNodeSize;\n    if (_.isArray(nodeSize)) {\n      maxNodeSize = Math.max(nodeSize[0], nodeSize[1]);\n    } else {\n      maxNodeSize = nodeSize;\n    }\n    nodes.forEach(node => {\n      layoutNodes.push(node);\n      let nodeSize = maxNodeSize;\n      if (_.isArray(node.size)) {\n        nodeSize = Math.max(node.size[0], node.size[1]);\n      } else if (_.isNumber(node.size)) {\n        nodeSize = node.size;\n      }\n      maxNodeSize = Math.max(maxNodeSize, nodeSize);\n    });\n    if (!width && typeof window !== 'undefined') {\n      width = window.innerWidth;\n    }\n    if (!height && typeof window !== 'undefined') {\n      height = window.innerHeight;\n    }\n    clockwise = counterclockwise !== undefined ? !counterclockwise : clockwise;\n  \n    // layout\n    const nodeMap = {};\n    const nodeIdxMap = {};\n    layoutNodes.forEach((node, i) => {\n      nodeMap[node.id] = node;\n      nodeIdxMap[node.id] = i;\n    });\n  \n    // get the node degrees\n    if (\n      sortBy === 'degree' ||\n      !_.isString(sortBy) ||\n      layoutNodes[0][sortBy] === undefined\n    ) {\n      sortBy = 'degree';\n      if (!_.isNumber(nodes[0].degree)) {\n        let values = [];\n        const len = nodes.length\n        for (let i = 0; i < len; i++) {\n          values[i] = 0;\n        }\n        edges.forEach(e => {\n          if (e.source) {\n            values[nodeIdxMap[e.source]] += 1;\n          }\n          if (e.target) {\n            values[nodeIdxMap[e.target]] += 1;\n          }\n        });\n        layoutNodes.forEach((node, i) => {\n          node.degree = values[i];\n        });\n      }\n    }\n    // sort nodes by value\n    layoutNodes.sort((n1, n2) => n2[sortBy] - n1[sortBy]);\n    maxValueNode = layoutNodes[0];\n    maxLevelDiff = maxLevelDiff || maxValueNode[sortBy] / 4;\n  \n    // put the values into levels\n    const levels = [[]];\n    let currentLevel = levels[0];\n    layoutNodes.forEach(node => {\n      if (currentLevel.length > 0) {\n        const diff = Math.abs(currentLevel[0][sortBy] - node[sortBy]);\n        if (maxLevelDiff && diff >= maxLevelDiff) {\n          currentLevel = [];\n          levels.push(currentLevel);\n        }\n      }\n      currentLevel.push(node);\n    });\n  \n    // create positions for levels\n    let minDist = maxNodeSize + minNodeSpacing; // min dist between nodes\n    if (!preventOverlap) {\n      // then strictly constrain to bb\n      const firstLvlHasMulti = levels.length > 0 && levels[0].length > 1;\n      const maxR = Math.min(width, height) / 2 - minDist;\n      const rStep = maxR / (levels.length + (firstLvlHasMulti ? 1 : 0));\n  \n      minDist = Math.min(minDist, rStep);\n    }\n  \n    // find the metrics for each level\n    let r = 0;\n    levels.forEach(level => {\n      let sweep = sweep;\n      if (sweep === undefined) {\n        sweep = 2 * Math.PI - (2 * Math.PI) / level.length;\n      }\n      const dTheta = (level.dTheta = sweep / Math.max(1, level.length - 1));\n  \n      // calculate the radius\n      if (level.length > 1 && preventOverlap) {\n        // but only if more than one node (can't overlap)\n        const dcos = Math.cos(dTheta) - Math.cos(0);\n        const dsin = Math.sin(dTheta) - Math.sin(0);\n        const rMin = Math.sqrt((minDist * minDist) / (dcos * dcos + dsin * dsin)); // s.t. no nodes overlapping\n  \n        r = Math.max(rMin, r);\n      }\n      level.r = r;\n      r += minDist;\n    });\n  \n    if (equidistant) {\n      let rDeltaMax = 0;\n      let rr = 0;\n      for (let i = 0; i < levels.length; i++) {\n        const level = levels[i];\n        const rDelta = level.r - rr;\n        rDeltaMax = Math.max(rDeltaMax, rDelta);\n      }\n      rr = 0;\n      levels.forEach((level, i) => {\n        if (i === 0) {\n          rr = level.r;\n        }\n        level.r = rr;\n        rr += rDeltaMax;\n      });\n    }\n  \n    // calculate the node positions\n    levels.forEach(level => {\n      const dTheta = level.dTheta;\n      const rr = level.r;\n      level.forEach((node, j) => {\n        const theta = startAngle + (clockwise ? 1 : -1) * dTheta * j;\n        node.x = center[0] + rr * Math.cos(theta);\n        node.y = center[1] + rr * Math.sin(theta);\n      });\n    });\n  \n    param.data.nodes.forEach((node, index) => {\n      node.top = nodes[index].y;\n      node.left = nodes[index].x;\n    });\n  }\n\nmodule.exports = concentLayout","const dagre = require('dagre');\n//drage布局\nfunction drageLayout(param) {\n    const {nodeSize, rankdir, nodesepFunc, ranksepFunc, nodesep, ranksep, controlPoints} = param;\n    const {edges = []} = param.data;\n    const curnode = param.data.nodes;\n    const nodes = curnode.map((item) => {\n      return {\n        id: item.id,\n        top: item.top,\n        left: item.left\n      }\n    });\n    // 形成新数组后布局失效\n    if (!nodes) return;\n    const g = new dagre.graphlib.Graph();\n    let nodeSizeFunc;\n    if (!nodeSize) {\n      nodeSizeFunc = (d) => {\n        if (d.size) {\n          if (_.isArray(d.size)) {\n            return d.size;\n          }\n          return [d.size, d.size];\n        }\n        return [40, 40];\n      };\n    } else if (_.isArray(nodeSize)) {\n      nodeSizeFunc = () => nodeSize;\n    } else {\n      nodeSizeFunc = () => [nodeSize, nodeSize];\n    }\n    let horisep = getFunc(nodesepFunc, nodesep, 50);\n    let vertisep = getFunc(ranksepFunc, ranksep, 50);\n    if (rankdir === 'LR' || rankdir === 'RL') {\n      horisep = getFunc(ranksepFunc, ranksep, 50);\n      vertisep = getFunc(nodesepFunc, nodesep, 50);\n    }\n    nodes.forEach(node => {\n      const size = nodeSizeFunc(node);\n      const verti = vertisep(node);\n      const hori = horisep(node);\n      const width = size[0] + 2 * hori;\n      const height = size[1] + 2 * verti;\n      g.setNode(node.id, {width, height});\n    });\n    edges.forEach(edge => {\n      // dagrejs Wiki https://github.com/dagrejs/dagre/wiki#configuring-the-layout\n      g.setEdge(edge.source, edge.target, {\n        weight: edge.weight || 1\n      });\n    });\n    g.setDefaultEdgeLabel(() => ({}));\n    param.nodes = nodes;\n    g.setGraph(param);\n    dagre.layout(g);\n    let coord;\n    // 重新布局时g.nodes()可能为undefined\n    g.nodes().forEach((node) => {\n      coord = g.node(node);\n      if (coord) {\n        const i = nodes.findIndex(it => it.id === node);\n        nodes[i].left = coord.x;\n        nodes[i].top = coord.y;\n        nodes[i].posInfo = {\n          _out: g._out[node],\n          _in: g._in[node],\n          _preds: g._preds[node],\n          _sucs: g._sucs[node]\n        }\n      }\n    });\n    g.edges().forEach((edge) => {\n      coord = g.edge(edge);\n      const i = edges.findIndex(it => it.source === edge.v && it.target === edge.w);\n      if (controlPoints && edges[i].type !== 'loop' && edges[i].shape !== 'loop') {\n        edges[i].controlPoints = coord.points.slice(1, coord.points.length - 1);\n      }\n    });\n    // 将数据挂载到原有数据上，以触发布局\n    nodes.forEach((item, index) => {\n      curnode[index].left = item.left;\n      curnode[index].top = item.top;\n      curnode[index].posInfo = item.posInfo;\n    });\n  }\n  \n  function getFunc(func, value, defaultValue) {\n    let resultFunc;\n    if (func) {\n      resultFunc = func;\n    } else if (_.isNumber(value)) {\n      resultFunc = () => value;\n    } else {\n      resultFunc = () => defaultValue;\n    }\n    return resultFunc;\n  }\n\n  module.exports = drageLayout","\n// to: https://github.com/antvis/G6/tree/3.5.1/src/layout/radial\n'use strict';\n\nimport { Matrix as MLMatrix, SingularValueDecomposition } from 'ml-matrix';\nexport default class MDS {\n \n  constructor(params) {\n    this.distances = params.distances;\n    this.dimension = params.dimension || 2;\n    this.linkDistance = params.linkDistance;\n  }\n\n  layout() {\n    const self = this;\n    const { dimension, distances, linkDistance } = self;\n    try {\n        // square distances\n        const M = MLMatrix.mul(MLMatrix.pow(distances, 2), -0.5);\n  \n        // double centre the rows/columns\n        const rowMeans = M.mean('row');\n        const colMeans = M.mean('column');\n        const totalMean = M.mean();\n        M.add(totalMean).subRowVector(rowMeans).subColumnVector(colMeans);\n  \n        // take the SVD of the double centred matrix, and return the\n        // points from it\n        const ret = new SingularValueDecomposition(M);\n        const eigenValues = MLMatrix.sqrt(ret.diagonalMatrix).diagonal();\n        return ret.leftSingularVectors.toJSON().map((row) => {\n          return MLMatrix.mul([row], [eigenValues]).toJSON()[0].splice(0, dimension);\n        });\n      } catch {\n        const res = [];\n        for (let i = 0; i < distances.length; i++) {\n          const x = Math.random() * linkDistance;\n          const y = Math.random() * linkDistance;\n          res.push([x, y]);\n        }\n        return res;\n      }\n  }\n}","\n// to: https://github.com/antvis/G6/tree/3.5.1/src/layout/radial\n\n'use strict';\n\nconst SPEED_DIVISOR = 800;\nexport default class RadialNonoverlapForce {\n  \n  constructor(params) {\n    this.positions = params.positions;\n    this.adjMatrix = params.adjMatrix;\n    this.focusID = params.focusID;\n    this.radii = params.radii;\n    this.iterations = params.iterations || 10;\n    this.height = params.height || 10;\n    this.width = params.width || 10;\n    this.speed = params.speed || 100;\n    this.gravity = params.gravity || 10;\n    this.nodeSizeFunc = params.nodeSizeFunc;\n    this.k = params.k || 5;\n    this.strictRadial = params.strictRadial;\n    this.nodes = params.nodes;\n  }\n\n  layout() {\n    const self = this;\n    const positions = self.positions;\n    const disp = [];\n    const iterations = self.iterations;\n    const maxDisplace = self.width / 10;\n    self.maxDisplace = maxDisplace;\n    self.disp = disp;\n    for (let i = 0; i < iterations; i++) {\n      positions.forEach((_, k) => {\n        disp[k] = { x: 0, y: 0 };\n      });\n      // 给重叠的节点增加斥力\n      self.getRepulsion();\n      self.updatePositions();\n    }\n    return positions;\n  }\n\n  getRepulsion() {\n    const self = this;\n    const positions = self.positions;\n    const nodes = self.nodes;\n    const disp = self.disp;\n    const k = self.k;\n    const radii = self.radii || [];\n\n    positions.forEach((v, i) => {\n      disp[i] = { x: 0, y: 0 };\n      positions.forEach((u, j) => {\n        if (i === j) {\n          return;\n        }\n        // v and u are not on the same circle, return\n        if (radii[i] !== radii[j]) {\n          return;\n        }\n        let vecx = v[0] - u[0];\n        let vecy = v[1] - u[1];\n        let vecLength = Math.sqrt(vecx * vecx + vecy * vecy);\n        if (vecLength === 0) {\n          vecLength = 1;\n          const sign = i > j ? 1 : -1;\n          vecx = 0.01 * sign;\n          vecy = 0.01 * sign;\n        }\n        // these two nodes overlap\n        if (vecLength < self.nodeSizeFunc(nodes[i]) / 2 + self.nodeSizeFunc(nodes[j]) / 2) {\n          const common = (k * k) / vecLength;\n          disp[i].x += (vecx / vecLength) * common;\n          disp[i].y += (vecy / vecLength) * common;\n        }\n      });\n    });\n  }\n\n  updatePositions() {\n    const self = this;\n    const positions = self.positions;\n    const disp = self.disp;\n    const speed = self.speed;\n    const strictRadial = self.strictRadial;\n    const f = self.focusID;\n    const maxDisplace = self.maxDisplace || self.width / 10;\n\n    if (strictRadial) {\n      disp.forEach((di, i) => {\n        const vx = positions[i][0] - positions[f][0];\n        const vy = positions[i][1] - positions[f][1];\n        const vLength = Math.sqrt(vx * vx + vy * vy);\n        let vpx = vy / vLength;\n        let vpy = -vx / vLength;\n        const diLength = Math.sqrt(di.x * di.x + di.y * di.y);\n        let alpha = Math.acos((vpx * di.x + vpy * di.y) / diLength);\n        if (alpha > Math.PI / 2) {\n          alpha -= Math.PI / 2;\n          vpx *= -1;\n          vpy *= -1;\n        }\n        const tdispLength = Math.cos(alpha) * diLength;\n        di.x = vpx * tdispLength;\n        di.y = vpy * tdispLength;\n      });\n    }\n\n    // move\n    const radii = self.radii;\n    positions.forEach((n, i) => {\n      if (i === f) {\n        return;\n      }\n      const distLength = Math.sqrt(disp[i].x * disp[i].x + disp[i].y * disp[i].y);\n      if (distLength > 0 && i !== f) {\n        const limitedDist = Math.min(maxDisplace * (speed / SPEED_DIVISOR), distLength);\n        n[0] += (disp[i].x / distLength) * limitedDist;\n        n[1] += (disp[i].y / distLength) * limitedDist;\n        if (strictRadial) {\n          let vx = n[0] - positions[f][0];\n          let vy = n[1] - positions[f][1];\n          const nfDis = Math.sqrt(vx * vx + vy * vy);\n          vx = (vx / nfDis) * radii[i];\n          vy = (vy / nfDis) * radii[i];\n          n[0] = positions[f][0] + vx;\n          n[1] = positions[f][1] + vy;\n        }\n      }\n    });\n  }\n}\n","// to: https://github.com/antvis/G6/tree/3.5.1/src/util/math.ts\nimport { mat3, transform, vec3 } from '@antv/matrix-util';\n\nconst isBetween = (value, min, max) => value >= min && value <= max;\n\n/**\n * 获取两条线段的交点\n * @param  {Point}  p0 第一条线段起点\n * @param  {Point}  p1 第一条线段终点\n * @param  {Point}  p2 第二条线段起点\n * @param  {Point}  p3 第二条线段终点\n * @return {Point}  交点\n */\nconst getLineIntersect = (p0, p1, p2, p3) => {\n  const tolerance = 0.001;\n\n  const E = {\n    x: p2.x - p0.x,\n    y: p2.y - p0.y,\n  };\n  const D0 = {\n    x: p1.x - p0.x,\n    y: p1.y - p0.y,\n  };\n  const D1 = {\n    x: p3.x - p2.x,\n    y: p3.y - p2.y,\n  };\n  const kross = D0.x * D1.y - D0.y * D1.x;\n  const sqrKross = kross * kross;\n  const sqrLen0 = D0.x * D0.x + D0.y * D0.y;\n  const sqrLen1 = D1.x * D1.x + D1.y * D1.y;\n  let point = null;\n  if (sqrKross > tolerance * sqrLen0 * sqrLen1) {\n    const s = (E.x * D1.y - E.y * D1.x) / kross;\n    const t = (E.x * D0.y - E.y * D0.x) / kross;\n    if (isBetween(s, 0, 1) && isBetween(t, 0, 1)) {\n      point = {\n        x: p0.x + s * D0.x,\n        y: p0.y + s * D0.y,\n      };\n    }\n  }\n  return point;\n};\n\n/**\n * point and rectangular intersection point\n * @param  {IRect} rect  rect\n * @param  {Point} point point\n * @return {PointPoint} rst;\n */\nexport const getRectIntersectByPoint = (rect, point) => {\n  const { x, y, width, height } = rect;\n  const cx = x + width / 2;\n  const cy = y + height / 2;\n  const points = [];\n  const center = {\n    x: cx,\n    y: cy,\n  };\n  points.push({\n    x,\n    y,\n  });\n  points.push({\n    x: x + width,\n    y,\n  });\n  points.push({\n    x: x + width,\n    y: y + height,\n  });\n  points.push({\n    x,\n    y: y + height,\n  });\n  points.push({\n    x,\n    y,\n  });\n  let rst = null;\n  for (let i = 1; i < points.length; i++) {\n    rst = getLineIntersect(points[i - 1], points[i], center, point);\n    if (rst) {\n      break;\n    }\n  }\n  return rst;\n};\n\n/**\n * get point and circle inIntersect\n * @param {ICircle} circle 圆点，x,y,r\n * @param {Point} point 点 x,y\n * @return {Point} applied point\n */\nexport const getCircleIntersectByPoint = (circle, point) => {\n  const { x: cx, y: cy, r } = circle;\n  const { x, y } = point;\n\n  const dx = x - cx;\n  const dy = y - cy;\n  const d = Math.sqrt(dx * dx + dy * dy);\n  if (d < r) {\n    return null;\n  }\n  const signX = Math.sign(dx);\n  const signY = Math.sign(dy);\n  const angle = Math.atan(dy / dx);\n  return {\n    x: cx + Math.abs(r * Math.cos(angle)) * signX,\n    y: cy + Math.abs(r * Math.sin(angle)) * signY,\n  };\n};\n\n/**\n * get point and ellipse inIntersect\n * @param {Object} ellipse 椭圆 x,y,rx,ry\n * @param {Object} point 点 x,y\n * @return {object} applied point\n */\nexport const getEllipseIntersectByPoint = (ellipse, point) => {\n  const a = ellipse.rx;\n  const b = ellipse.ry;\n  const cx = ellipse.x;\n  const cy = ellipse.y;\n\n  const dx = point.x - cx;\n  const dy = point.y - cy;\n  // 直接通过 x,y 求夹角，求出来的范围是 -PI, PI\n  let angle = Math.atan2(dy / b, dx / a);\n\n  if (angle < 0) {\n    angle += 2 * Math.PI; // 转换到 0，2PI\n  }\n\n  return {\n    x: cx + a * Math.cos(angle),\n    y: cy + b * Math.sin(angle),\n  };\n};\n\n/**\n * coordinate matrix transformation\n * @param  {number} point   coordinate\n * @param  {Matrix} matrix  matrix\n * @param  {number} tag     could be 0 or 1\n * @return {Point} transformed point\n */\nexport const applyMatrix = (point, matrix, tag) => {\n  const vector = [point.x, point.y, tag];\n  if (!matrix || matrix[0] === NaN) {\n    matrix = mat3.create();\n  }\n\n  vec3.transformMat3(vector, vector, matrix);\n\n  return {\n    x: vector[0],\n    y: vector[1],\n  };\n};\n\n/**\n * coordinate matrix invert transformation\n * @param  {number} point   coordinate\n * @param  {number} matrix  matrix\n * @param  {number} tag     could be 0 or 1\n * @return {object} transformed point\n */\nexport const invertMatrix = (point, matrix, tag) => {\n  if (!matrix || matrix[0] === NaN) {\n    matrix = mat3.create();\n  }\n\n  let inversedMatrix = mat3.invert([], matrix);\n  if (!inversedMatrix) {\n    inversedMatrix = mat3.create();\n  }\n  const vector = [point.x, point.y, tag];\n  vec3.transformMat3(vector, vector, inversedMatrix);\n\n  return {\n    x: vector[0],\n    y: vector[1],\n  };\n};\n\n/**\n *\n * @param p1 First coordinate\n * @param p2 second coordinate\n * @param p3 three coordinate\n */\nexport const getCircleCenterByPoints = (p1, p2, p3) => {\n  const a = p1.x - p2.x;\n  const b = p1.y - p2.y;\n  const c = p1.x - p3.x;\n  const d = p1.y - p3.y;\n  const e = (p1.x * p1.x - p2.x * p2.x - p2.y * p2.y + p1.y * p1.y) / 2;\n  const f = (p1.x * p1.x - p3.x * p3.x - p3.y * p3.y + p1.y * p1.y) / 2;\n  const denominator = b * c - a * d;\n  return {\n    x: -(d * e - b * f) / denominator,\n    y: -(a * f - c * e) / denominator,\n  };\n};\n\n/**\n * get distance by two points\n * @param p1 first point\n * @param p2 second point\n */\nexport const distance = (p1, p2) => {\n  const vx = p1.x - p2.x;\n  const vy = p1.y - p2.y;\n  return Math.sqrt(vx * vx + vy * vy);\n};\n\n/**\n * scale matrix\n * @param matrix [ [], [], [] ]\n * @param ratio\n */\nexport const scaleMatrix = (matrix, ratio) => {\n  const result = [];\n  matrix.forEach(row => {\n    const newRow = [];\n    row.forEach(v => {\n      newRow.push(v * ratio);\n    });\n    result.push(newRow);\n  });\n  return result;\n};\n\n/**\n * Floyd Warshall algorithm for shortest path distances matrix\n * @param  {array} adjMatrix   adjacency matrix\n * @return {array} distances   shortest path distances matrix\n */\nexport const floydWarshall = (adjMatrix) => {\n  // initialize\n  const dist = [];\n  const size = adjMatrix.length;\n  for (let i = 0; i < size; i += 1) {\n    dist[i] = [];\n    for (let j = 0; j < size; j += 1) {\n      if (i === j) {\n        dist[i][j] = 0;\n      } else if (adjMatrix[i][j] === 0 || !adjMatrix[i][j]) {\n        dist[i][j] = Infinity;\n      } else {\n        dist[i][j] = adjMatrix[i][j];\n      }\n    }\n  }\n  // floyd\n  for (let k = 0; k < size; k += 1) {\n    for (let i = 0; i < size; i += 1) {\n      for (let j = 0; j < size; j += 1) {\n        if (dist[i][j] > dist[i][k] + dist[k][j]) {\n          dist[i][j] = dist[i][k] + dist[k][j];\n        }\n      }\n    }\n  }\n  return dist;\n};\n\n/**\n * get adjacency matrix\n * @param data graph data\n * @param directed whether it's a directed graph\n */\nexport const getAdjMatrix = (data, directed) => {\n  const { nodes, edges } = data;\n  const matrix = [];\n  // map node with index in data.nodes\n  const nodeMap = {};\n\n  if (!nodes) {\n    throw new Error('invalid nodes data!');\n  }\n  if (nodes) {\n    nodes.forEach((node, i) => {\n      nodeMap[node.id] = i;\n      const row = [];\n      matrix.push(row);\n    });\n  }\n\n  if (edges) {\n    edges.forEach(e => {\n      const { source, target } = e;\n      const sIndex = nodeMap[source];\n      const tIndex = nodeMap[target];\n      matrix[sIndex][tIndex] = 1;\n      if (!directed) {\n        matrix[tIndex][sIndex] = 1;\n      }\n    });\n  }\n\n  return matrix;\n};\n\n/**\n * 平移group\n * @param group Group 实例\n * @param vec 移动向量\n */\nexport const translate = (group, vec) => {\n  group.translate(vec.x, vec.y);\n};\n\n/**\n * 移动到指定坐标点\n * @param group Group 实例\n * @param point 移动到的坐标点\n */\nexport const move = (group, point) => {\n  let matrix = group.getMatrix();\n  if (!matrix) {\n    matrix = mat3.create();\n  }\n  const bbox = group.getCanvasBBox();\n  const vx = point.x - bbox.minX;\n  const vy = point.y - bbox.minY;\n\n  const movedMatrix = transform(matrix, [['t', vx, vy]]);\n  group.setMatrix(movedMatrix);\n};\n\n/**\n * 缩放 group\n * @param group Group 实例\n * @param point 在x 和 y 方向上的缩放比例\n */\nexport const scale = (group, ratio) => {\n  let matrix = group.getMatrix();\n  if (!matrix) {\n    matrix = mat3.create();\n  }\n\n  let scaleXY = ratio;\n  if (!isArray(ratio)) {\n    scaleXY = [ratio, ratio];\n  }\n\n  if (isArray(ratio) && ratio.length === 1) {\n    scaleXY = [ratio[0], ratio[0]];\n  }\n\n  matrix = transform(matrix, [['s', (scaleXY)[0], (scaleXY)[1]]]);\n\n  group.setMatrix(matrix);\n};\n\n/**\n *\n * @param group Group 实例\n * @param ratio 选择角度\n */\nexport const rotate = (group, angle) => {\n  let matrix = group.getMatrix();\n  if (!matrix) {\n    matrix = mat3.create();\n  }\n  matrix = transform(matrix, [['r', angle]]);\n\n  group.setMatrix(matrix);\n};\n\nexport const getDegree = (n, nodeIdxMap, edges) => {\n  const degrees = [];\n  for (let i = 0; i < n; i++) {\n    degrees[i] = 0;\n  }\n  edges.forEach(e => {\n    if (e.source) {\n      degrees[nodeIdxMap[e.source]] += 1;\n    }\n    if (e.target) {\n      degrees[nodeIdxMap[e.target]] += 1;\n    }\n  });\n  return degrees;\n};\n","// to: https://github.com/antvis/G6/tree/3.5.1/src/layout/radial\n'use strict';\n\nimport MDS from './mds';\nimport RadialNonoverlapForce from './radialNonoverlapForce';\nimport { floydWarshall, getAdjMatrix } from './math';\nfunction getWeightMatrix(M) {\n  const rows = M.length;\n  const cols = M[0].length;\n  const result = [];\n  for (let i = 0; i < rows; i++) {\n    const row = [];\n    for (let j = 0; j < cols; j++) {\n      if (M[i][j] !== 0) {\n        row.push(1 / (M[i][j] * M[i][j]));\n      } else {\n        row.push(0);\n      }\n    }\n    result.push(row);\n  }\n  return result;\n}\n\nfunction getIndexById(array, id) {\n  let index = -1;\n  array.forEach(function (a, i) {\n    if (a.id === id) {\n      index = i;\n    }\n  });\n  return index;\n}\n\nfunction getEDistance(p1, p2) {\n  return Math.sqrt((p1[0] - p2[0]) * (p1[0] - p2[0]) + (p1[1] - p2[1]) * (p1[1] - p2[1]));\n}\nfunction RadialLayout(params) {\n  const self = params.opts;\n  const nodes = params.data.nodes;\n  const edges = params.data.edges || [];\n  const center = self.center;\n  if (!nodes || nodes.length === 0) {\n    return;\n  }\n  if (nodes.length === 1) {\n    nodes[0].x = center[0];\n    nodes[0].y = center[1];\n    return;\n  }\n  const linkDistance = self.linkDistance;\n  // layout\n  let focusNode = null;\n  if (String(self.focusNode)) {\n    let found = false;\n    for (let i = 0; i < nodes.length; i++) {\n      if (nodes[i].id === self.focusNode) {\n        focusNode = nodes[i];\n        self.focusNode = focusNode;\n        found = true;\n        i = nodes.length;\n      }\n    }\n    if (!found) {\n      focusNode = null;\n    }\n  } else {\n    focusNode = self.focusNode;\n  }\n  // default focus node\n  if (!focusNode) {\n    focusNode = nodes[0];\n    self.focusNode = focusNode;\n  }\n  // the index of the focusNode in data\n  const focusIndex = getIndexById(nodes, focusNode.id);\n  self.focusIndex = focusIndex;\n\n  // the graph-theoretic distance (shortest path distance) matrix\n  const adjMatrix = getAdjMatrix({ nodes, edges }, false);\n  const D = floydWarshall(adjMatrix);\n  const maxDistance = maxToFocus(D, focusIndex);\n  // replace first node in unconnected component to the circle at (maxDistance + 1)\n  handleInfinity(D, focusIndex, maxDistance + 1);\n  self.distances = D;\n\n  // the shortest path distance from each node to focusNode\n  const focusNodeD = D[focusIndex];\n  if (!self.width && typeof window !== 'undefined') {\n    self.width = window.innerWidth;\n  }\n  if (!self.height && typeof window !== 'undefined') {\n    self.height = window.innerHeight;\n  }\n  const width = self.width || 500;\n  const height = self.height || 500;\n  let semiWidth = width - center[0] > center[0] ? center[0] : width - center[0];\n  let semiHeight = height - center[1] > center[1] ? center[1] : height - center[1];\n  if (semiWidth === 0) {\n    semiWidth = width / 2;\n  }\n  if (semiHeight === 0) {\n    semiHeight = height / 2;\n  }\n  // the maxRadius of the graph\n  const maxRadius = semiHeight > semiWidth ? semiWidth : semiHeight;\n  const maxD = Math.max(...focusNodeD);\n  // the radius for each nodes away from focusNode\n  const radii = [];\n  focusNodeD.forEach((value, i) => {\n    if (!self.unitRadius) {\n      self.unitRadius = maxRadius / maxD;\n    }\n    radii[i] = value * self.unitRadius;\n  });\n  self.radii = radii;\n\n  const eIdealD = eIdealDisMatrix(params);\n  // const eIdealD = scaleMatrix(D, linkDistance);\n  self.eIdealDistances = eIdealD;\n  // the weight matrix, Wij = 1 / dij^(-2)\n  const W = getWeightMatrix(eIdealD);\n  self.weights = W;\n\n  // the initial positions from mds\n  const mds = new MDS({ distances: eIdealD, linkDistance });\n  let positions = mds.layout();\n  positions.forEach((p) => {\n    if (isNaN(p[0])) {\n      p[0] = Math.random() * linkDistance;\n    }\n    if (isNaN(p[1])) {\n      p[1] = Math.random() * linkDistance;\n    }\n  });\n  self.positions = positions;\n  positions.forEach((p, i) => {\n    nodes[i].x = p[0] + center[0];\n    nodes[i].y = p[1] + center[1];\n  });\n  // move the graph to origin, centered at focusNode\n  positions.forEach((p) => {\n    p[0] -= positions[focusIndex][0];\n    p[1] -= positions[focusIndex][1];\n  });\n  run(params);\n  const preventOverlap = self.preventOverlap;\n  const nodeSize = self.nodeSize;\n  let nodeSizeFunc;\n  const strictRadial = self.strictRadial;\n  // stagger the overlapped nodes\n  if (preventOverlap) {\n    const nodeSpacing = self.nodeSpacing;\n    let nodeSpacingFunc;\n    if (_.isNumber(nodeSpacing)) {\n      nodeSpacingFunc = () => nodeSpacing;\n    } else if (_.isFunction(nodeSpacing)) {\n      nodeSpacingFunc = nodeSpacing;\n    } else {\n      nodeSpacingFunc = () => 0;\n    }\n    if (!nodeSize) {\n      nodeSizeFunc = (d) => {\n        if (d.size) {\n          if (_.isArray(d.size)) {\n            const res = d.size[0] > d.size[1] ? d.size[0] : d.size[1];\n            return res + nodeSpacingFunc(d);\n          }\n          return d.size + nodeSpacingFunc(d);\n        }\n        return 10 + nodeSpacingFunc(d);\n      };\n    } else if (_.isArray(nodeSize)) {\n      nodeSizeFunc = (d) => {\n        const res = nodeSize[0] > nodeSize[1] ? nodeSize[0] : nodeSize[1];\n        return res + nodeSpacingFunc(d);\n      };\n    } else {\n      nodeSizeFunc = (d) => nodeSize + nodeSpacingFunc(d);\n    }\n    const nonoverlapForceParams = {\n      nodeSizeFunc,\n      adjMatrix,\n      positions,\n      radii,\n      height,\n      width,\n      strictRadial,\n      focusID: focusIndex,\n      iterations: self.maxPreventOverlapIteration || 200,\n      k: positions.length / 4.5,\n      nodes,\n    };\n    const nonoverlapForce = new RadialNonoverlapForce(nonoverlapForceParams);\n    positions = nonoverlapForce.layout();\n  }\n  // move the graph to center\n  positions.forEach((p, i) => {\n    nodes[i].x = p[0] + center[0];\n    nodes[i].y = p[1] + center[1];\n  });\n  \n}\nfunction run(params) {\n  const self = params.opts;\n  const maxIteration = self.maxIteration;\n  const positions = self.positions || [];\n  const W = self.weights || [];\n  const eIdealDis = self.eIdealDistances || [];\n  const radii = self.radii || [];\n  for (let i = 0; i <= maxIteration; i++) {\n    const param = i / maxIteration;\n    oneIteration(param, positions, radii, eIdealDis, W, params);\n  }\n}\n\nfunction oneIteration(\n  param,\n  positions,\n  radii,\n  D,\n  W,\n  params\n) {\n  const self = params.opts;\n  const vparam = 1 - param;\n  const focusIndex = self.focusIndex;\n  positions.forEach((v, i) => {\n    // v\n    const originDis = getEDistance(v, [0, 0]);\n    const reciODis = originDis === 0 ? 0 : 1 / originDis;\n    if (i === focusIndex) {\n      return;\n    }\n    let xMolecule = 0;\n    let yMolecule = 0;\n    let denominator = 0;\n    positions.forEach((u, j) => {\n      // u\n      if (i === j) {\n        return;\n      }\n      // the euclidean distance between v and u\n      const edis = getEDistance(v, u);\n      const reciEdis = edis === 0 ? 0 : 1 / edis;\n      const idealDis = D[j][i];\n      // same for x and y\n      denominator += W[i][j];\n      // x\n      xMolecule += W[i][j] * (u[0] + idealDis * (v[0] - u[0]) * reciEdis);\n      // y\n      yMolecule += W[i][j] * (u[1] + idealDis * (v[1] - u[1]) * reciEdis);\n    });\n    const reciR = radii[i] === 0 ? 0 : 1 / radii[i];\n    denominator *= vparam;\n    denominator += param * reciR * reciR;\n    // x\n    xMolecule *= vparam;\n    xMolecule += param * reciR * v[0] * reciODis;\n    v[0] = xMolecule / denominator;\n    // y\n    yMolecule *= vparam;\n    yMolecule += param * reciR * v[1] * reciODis;\n    v[1] = yMolecule / denominator;\n  });\n}\n\nfunction eIdealDisMatrix(params) {\n  const self = params.opts;\n  const nodes = params.data.nodes;\n  if (!nodes) return [];\n  const D = self.distances;\n  const linkDis = self.linkDistance;\n  const radii = self.radii || [];\n  const unitRadius = self.unitRadius || 50;\n  const result = [];\n  if (D) {\n    D.forEach((row, i) => {\n      const newRow = [];\n      row.forEach((v, j) => {\n        if (i === j) {\n          newRow.push(0);\n        } else if (radii[i] === radii[j]) {\n          // i and j are on the same circle\n          if (self.sortBy === 'data') {\n            // sort the nodes on the same circle according to the ordering of the data\n            newRow.push((v * (Math.abs(i - j) * self.sortStrength)) / (radii[i] / unitRadius));\n          } else if (self.sortBy) {\n            // sort the nodes on the same circle according to the attributes\n            let iValue= (nodes[i][self.sortBy]) || 0;\n            let jValue= (nodes[j][self.sortBy]) || 0;\n            if (isString(iValue)) {\n              iValue = iValue.charCodeAt(0);\n            }\n            if (isString(jValue)) {\n              jValue = jValue.charCodeAt(0);\n            }\n            newRow.push(\n              (v * (Math.abs(iValue - jValue) * self.sortStrength)) / (radii[i] / unitRadius),\n            );\n          } else {\n            newRow.push((v * linkDis) / (radii[i] / unitRadius));\n          }\n        } else {\n          // i and j are on different circle\n          // i and j are on different circle\n          const link = (linkDis + unitRadius) / 2;\n          newRow.push(v * link);\n        }\n      });\n      result.push(newRow);\n    });\n  }\n  return result;\n}\n\nfunction handleInfinity(matrix, focusIndex, step) {\n  const length = matrix.length;\n  // 遍历 matrix 中遍历 focus 对应行\n  for (let i = 0; i < length; i++) {\n    // matrix 关注点对应行的 Inf 项\n    if (matrix[focusIndex][i] === Infinity) {\n      matrix[focusIndex][i] = step;\n      matrix[i][focusIndex] = step;\n      // 遍历 matrix 中的 i 行，i 行中非 Inf 项若在 focus 行为 Inf，则替换 focus 行的那个 Inf\n      for (let j = 0; j < length; j++) {\n        if (matrix[i][j] !== Infinity && matrix[focusIndex][j] === Infinity) {\n          matrix[focusIndex][j] = step + matrix[i][j];\n          matrix[j][focusIndex] = step + matrix[i][j];\n        }\n      }\n    }\n  }\n  // 处理其他行的 Inf。根据该行对应点与 focus 距离以及 Inf 项点 与 focus 距离，决定替换值\n  for (let i = 0; i < length; i++) {\n    if (i === focusIndex) {\n      continue;\n    }\n    for (let j = 0; j < length; j++) {\n      if (matrix[i][j] === Infinity) {\n        let minus = Math.abs(matrix[focusIndex][i] - matrix[focusIndex][j]);\n        minus = minus === 0 ? 1 : minus;\n        matrix[i][j] = minus;\n      }\n    }\n  }\n}\n\nfunction maxToFocus(matrix, focusIndex) {\n  let max = 0;\n  for (let i = 0; i < matrix[focusIndex].length; i++) {\n    if (matrix[focusIndex][i] === Infinity) {\n      continue;\n    }\n    max = matrix[focusIndex][i] > max ? matrix[focusIndex][i] : max;\n  }\n  return max;\n}\n\nexport default RadialLayout;","'use strict';\n\n/**\n * cc: https://github.com/antvis/G6/tree/master/src/layout\n */\n\nconst d3 = require('d3-force');\nconst _ = require('lodash');\nimport Layout from './circleLayout.js';\nimport fruchterman from './fruchterman.js';\nimport gridLayout from './gridLayout.js'\nimport forceLayout from './forceLayout.js'\nimport concentLayout from './concentLayout.js'\nimport drageLayout from './drageLayout.js';\nimport radial from './radial/radial.js';\n\n\n// 离散树形布局\nfunction forceTreeLayout(param) {\n  let opts = param.opts;\n  let data = _.cloneDeep(param.data);\n\n  var simulation = d3.forceSimulation(data.nodes)\n    // d3.forceLink(links).distance(20).strength(1)\n    .force('charge', d3.forceManyBody().strength(opts.chargeStrength))\n    .force('center', d3.forceCenter(opts.width / 2, opts.height / 2))\n    .force('link', d3.forceLink(data.edges).distance(opts.link.distance).strength(opts.link.strength))\n    .force('x', d3.forceX())\n    .force('y', d3.forceY())\n    .stop();\n\n\n  for (var i = 0, n = Math.ceil(Math.log(simulation.alphaMin()) / Math.log(1 - simulation.alphaDecay())); i < n; ++i) {\n    simulation.tick();\n  }\n\n  param.data.nodes.forEach((node, index) => {\n    node.top = data.nodes[index].y;\n    node.left = data.nodes[index].x;\n  });\n\n  // 后续需要考虑group的布局\n}\n\n// 后续拓展树形布局\nfunction treeLayout(param) {\n\n}\n\n\n\n\n\nexport default {\n  forceLayout,\n  forceTreeLayout,\n  treeLayout,\n  drageLayout,\n  concentLayout,\n  gridLayout,\n  fruchterman,\n  circleLayout: Layout.circleLayout,\n  radial,\n}\n","'use strict';\n\nconst $ = require('jquery');\n\nclass SelectCanvas {\n  constructor() {\n    this.dom = $('<canvas class=\"butterfly-selected-canvas\"></canvas>')[0];\n    this.cxt = this.dom.getContext('2d');\n    this.canvasTop = 0;\n    this.canvasLeft = 0;\n    this.canvasHeight = 0;\n    this.canvasWidth = 0;\n    this.canScrollX = 0;\n    this.canScrollY = 0;\n    this.startX = 0;\n    this.startY = 0;\n    this.endX = 0;\n    this.endY = 0;\n    this._on = null;\n    this._emit = null;\n    this.isDraw = false;\n    this.isActive = false;\n  }\n\n  init(opts) {\n    const root = opts.root;\n    this.resize(opts);\n    this.addEventListener();\n    this._on = opts._on;\n    this._emit = opts._emit;\n    $(this.dom).appendTo(root);\n  }\n\n  resize(opts) {\n    const root = opts.root;\n    const offset = $(root).offset();\n    this.canvasTop = offset.top;\n    this.canvasLeft = offset.left;\n    this.canvasHeight = $(root).height();\n    this.canvasWidth = $(root).width();\n    $(this.dom).attr('width', this.canvasWidth);\n    $(this.dom).attr('height', this.canvasHeight);\n  }\n\n  addEventListener() {\n    this.dom.addEventListener('mousedown', this.mouseDown.bind(this));\n    this.dom.addEventListener('mouseup', this.mouseUp.bind(this));\n    this.dom.addEventListener('mousemove', this.mouseMove.bind(this));\n    this.dom.addEventListener('mouseleave', this.mouseLeave.bind(this));\n  }\n\n  mouseDown(evt) {\n    this.startX = evt.clientX;\n    this.startY = evt.clientY;\n    this.isDraw = true;\n  }\n\n  mouseUp(evt) {\n    this.isDraw = false;\n    this.clearCanvas();\n    const startX = this.startX;\n    const startY = this.startY;\n    const endX = this.endX = evt.clientX;\n    const endY = this.endY = evt.clientY;\n    const toDirection = endX - startX > 0 ? 'right' : 'left'\n\n    const startLeft = startX > endX ? endX : startX;\n    const startTop = startY > endY ? endY : startY;\n    const endLeft = startX > endX ? startX : endX;\n    const endTop = startY > endY ? startY : endY;\n\n\n    this._emit('InnerEvents', {\n      type: 'multiple:select',\n      range: [startLeft, startTop, endLeft, endTop],\n      toDirection\n    });\n\n    this.unActive();\n  }\n\n  mouseMove(evt) {\n    if (!this.isDraw) {\n      return;\n    }\n\n    this.endX = evt.clientX;\n    this.endY = evt.clientY;\n    this.drawRect();\n  }\n\n  mouseLeave(evt) {\n    this.isDraw = false;\n    this.clearCanvas();\n  }\n\n  drawRect() {\n    if (!this.isDraw) {\n      return;\n    }\n    this.clearCanvas();\n    const startX = Math.min(this.startX, this.endX) - this.canvasLeft + this.canScrollX;\n    const startY = Math.min(this.startY, this.endY) - this.canvasTop + this.canScrollY;\n    const width = Math.abs(this.startX - this.endX);\n    const height = Math.abs(this.startY - this.endY);\n\n    this.cxt.beginPath();\n    this.cxt.rect(startX, startY, width, height);\n    this.cxt.fillStyle = '#b3dbff';\n    this.cxt.fill();\n    this.cxt.lineWidth = '1';\n    this.cxt.strokeStyle = '#3da4ff';\n    this.cxt.stroke();\n  }\n\n  clearCanvas() {\n    this.cxt.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\n  }\n\n  getCanvas() {\n    return this.dom;\n  }\n\n  active() {\n    if (!this.isActive) {\n      $(this.dom).addClass('wrapper-up');\n      this.isActive = true;\n    }\n  }\n\n  unActive() {\n    if (this.isActive) {\n      $(this.dom).removeClass('wrapper-up');\n      this.isActive = false;\n    }\n  }\n\n  _changeCanvasInfo(data) {\n    if (data.terScrollX !== undefined) {\n      this.canScrollX = data.terScrollX;\n    }\n    if (data.terScrollY !== undefined) {\n      this.canScrollY = data.terScrollY;\n    }\n  }\n}\n\nexport default SelectCanvas;\n","'use strict';\n\nconst _ = require('lodash');\n\nclass CoordinateService {\n  constructor(opts) {\n    this.canvas = opts.canvas;\n    this.terOffsetX = opts.terOffsetX || 0;\n    this.terOffsetY = opts.terOffsetY || 0;\n    this.terWidth = opts.terWidth || 0;\n    this.terHeight = opts.terHeight || 0;\n    this.canOffsetX = opts.canOffsetX || 0;\n    this.canOffsetY = opts.canOffsetY || 0;\n    this.scale = opts.scale || 1;\n\n    // 滚动高度和左右\n    this.scrollTop = 0;\n    this.scrollLeft = 0;\n    this.scrollTimer = undefined;\n    this._calcScrollPos();\n\n    // 中心点\n    this.originX = undefined;\n    this.originY = undefined;\n    // 当前鼠标在容器内的坐标\n    this._currentTerX = 0;\n    this._currentTerY = 0;\n  }\n\n  _changeCanvasInfo(data) {\n    if (data.terOffsetX !== undefined) {\n      this.terOffsetX = data.terOffsetX;\n    }\n    if (data.terOffsetY !== undefined) {\n      this.terOffsetY = data.terOffsetY;\n    }\n    if (data.terWidth !== undefined) {\n      this.terWidth = data.terWidth;\n    }\n    if (data.terHeight !== undefined) {\n      this.terHeight = data.terHeight;\n    }\n    if (data.canOffsetX !== undefined) {\n      this.canOffsetX = data.canOffsetX;\n    }\n    if (data.canOffsetY !== undefined) {\n      this.canOffsetY = data.canOffsetY;\n    }\n    if (data.scale !== undefined) {\n      this._lastScale = this.scale;\n      this.scale = data.scale;\n    }\n    if (data.canvas) {\n      this.canvas = data.canvas;\n    }\n\n    let _isChangeOrigin = false;\n    if (data.originX !== undefined) {\n      this.originX = data.originX;\n      _isChangeOrigin = true;\n    }\n\n    if (data.originY !== undefined) {\n      this.originY = data.originY;\n      _isChangeOrigin = true;\n    }\n\n    if (_isChangeOrigin) {\n      this.canvas.wrapper.style.transformOrigin = `${this.originX}% ${this.originY}%`;\n    }\n\n    let _isChangeMouse = false;\n    if (data.mouseX !== undefined) {\n      if (this._currentTerX !== data.mouseX - this.terOffsetX) {\n        this._currentTerX = (data.mouseX - this.terOffsetX);\n        _isChangeMouse = true;\n      }\n    }\n    if (data.mouseY !== undefined) {\n      if (this._currentTerY !== data.mouseY - this.terOffsetY) {\n        this._currentTerY = (data.mouseY - this.terOffsetY);\n        _isChangeMouse = true;\n      }\n    }\n\n    if (_isChangeMouse) {\n\n      if (this.originX === undefined || this.originY === undefined) {\n        this.originX = 0;\n        this.originY = 0;\n      }\n\n      // i,j\n      let i = this.originX / 100 * this.terWidth;\n      let j = this.originY / 100 * this.terHeight;\n\n      let oldOffset = [parseInt(this.canOffsetX) , parseInt(this.canOffsetY)];\n\n      let _localtionX = (data.mouseX - (i * (1 - this._lastScale) + oldOffset[0]) - this.terOffsetX) / this._lastScale;\n      let _localtionY = (data.mouseY - (j * (1 - this._lastScale) + oldOffset[1]) - this.terOffsetY) / this._lastScale;\n\n      let newOriginX = _localtionX / this.terWidth * 100;\n      let newOriginY = _localtionY / this.terHeight * 100;\n\n      let e = -i * (1 - this._lastScale);\n      let f = -j * (1 - this._lastScale);\n\n      i = newOriginX / 100 * this.terWidth;\n      j = newOriginY / 100 * this.terHeight;\n\n      let g = -i * (1 - this._lastScale);\n      let h = -j * (1 - this._lastScale);\n\n      let _newLeft = g - e + oldOffset[0];\n      let _newTop = h - f + oldOffset[1];\n\n      this.canvas.wrapper.style.transformOrigin = `${newOriginX}% ${newOriginY}%`;\n      this.canvas.move([_newLeft, _newTop]);\n      this.originX = newOriginX;\n      this.originY = newOriginY;\n    }\n  }\n  canvas2terminal(coordinates, options) {\n    return [this._canvas2terminal('x', coordinates[0], options), this._canvas2terminal('y', coordinates[1], options)];\n  }\n  terminal2canvas(coordinates, options) {\n    return [this._terminal2canvas('x', coordinates[0], options), this._terminal2canvas('y', coordinates[1], options)];\n  }\n  _canvas2terminal(pos, coordinate, options) {\n    this._calcScrollPos();\n    let scale = _.get(options, 'scale') || this.scale;\n    let canOffsetX = _.get(options, 'canOffsetX') !== undefined ? _.get(options, 'canOffsetX') : this.canOffsetX;\n    let canOffsetY = _.get(options, 'canOffsetY') !== undefined ? _.get(options, 'canOffsetY') : this.canOffsetY;\n    let terOffsetX = _.get(options, 'terOffsetX') !== undefined ? _.get(options, 'terOffsetX') : this.terOffsetX;\n    let terOffsetY = _.get(options, 'terOffsetY') !== undefined ? _.get(options, 'terOffsetY') : this.terOffsetY;\n    let originX = _.get(options, 'originX') !== undefined ? _.get(options, 'originX') : this.originX || 0;\n    let originY = _.get(options, 'originY') !== undefined ? _.get(options, 'originY') : this.originY || 0;\n    if (pos === 'x') {\n      let transformOriginX  = originX / 100 * this.terWidth;\n      return coordinate * scale + (transformOriginX * (1 - scale) + canOffsetX) + terOffsetX ;\n    }\n    if (pos === 'y') {\n      let transformOriginY  = originY / 100 * this.terHeight;\n      return coordinate * scale + (transformOriginY * (1 - scale) + canOffsetY) + terOffsetY ;\n    }\n  }\n\n  _terminal2canvas(pos, coordinate, options) {\n    this._calcScrollPos();\n    let scale = _.get(options, 'scale') || this.scale;\n    let canOffsetX = _.get(options, 'canOffsetX') !== undefined ? _.get(options, 'canOffsetX') : this.canOffsetX;\n    let canOffsetY = _.get(options, 'canOffsetY') !== undefined ? _.get(options, 'canOffsetY') : this.canOffsetY;\n    let terOffsetX = _.get(options, 'terOffsetX') !== undefined ? _.get(options, 'terOffsetX') : this.terOffsetX;\n    let terOffsetY = _.get(options, 'terOffsetY') !== undefined ? _.get(options, 'terOffsetY') : this.terOffsetY;\n    let originX = _.get(options, 'originX') !== undefined ? _.get(options, 'originX') : this.originX || 0;\n    let originY = _.get(options, 'originY') !== undefined ? _.get(options, 'originY') : this.originY || 0;\n    let scrollTop = this.scrollTop;\n    let scrollLeft = this.scrollLeft;\n    if (pos === 'x') {\n      let transformOriginX  = originX / 100 * this.terWidth;\n      return (coordinate - (transformOriginX * (1 - scale) + canOffsetX) - terOffsetX - scrollLeft) / scale;\n    }\n    if (pos === 'y') {\n      let transformOriginY  = originY / 100 * this.terHeight;\n      return (coordinate - (transformOriginY * (1 - scale) + canOffsetY) - terOffsetY - scrollTop) / scale;\n    }\n  }\n\n  _calcScrollPos() {\n    if (!this.scrollTimer) {\n      let root = this.canvas.root;\n      let rectSize = root.getBoundingClientRect();\n      this.scrollTop = rectSize.top - this.terOffsetY;\n      this.scrollLeft = rectSize.left - this.terOffsetX;\n      this.scrollTimer = setTimeout(() => { \n        this.scrollTimer = undefined;\n      }, 100);\n    }\n  }\n}\n\nexport default CoordinateService;\n","'use strict';\n\nconst $ = require('jquery');\nconst _ = require('lodash');\n\nclass GridService {\n  constructor(opts) {\n    this.root = opts.root;\n    this.canvas = opts.canvas;\n\n    this.domWrapper = _.get(opts, 'canvas.wrapper');\n    this.canvasHeight = 0;\n    this.canvasWidth = 0;\n\n    this.dom = null;\n    this.isActive = false;\n    this.theme = _.get(opts, 'theme', {}) || {\n      shapeType: 'circle',  // 展示的类型，支持line & circle\n      gap: 5,            // 网格间隙\n      adsorbGap: '5px',      // 吸附间距\n      backgroud: '#fff',  // 网格背景颜色\n      lineColor: '#000',  // 网格线条颜色\n      lineWidth: '1px',   // 网格粗细\n      circleRadiu: 2, // 圆点半径\n      circleColor: '#000' // 断电颜色\n    };\n  }\n  _resize() {\n    this.canvasHeight = $(this.root).height();\n    this.canvasWidth = $(this.root).width();\n    $(this.dom).attr('width', this.canvasWidth);\n    $(this.dom).attr('height', this.canvasHeight);\n  }\n  create(options = {}) {\n    this.theme = _.merge(this.theme, options.theme || {});\n\n    if (!this.dom) {\n      this.dom = $('<canvas class=\"butterfly-gird-canvas\"></canvas>')[0];\n      this._resize();\n      $(this.dom).appendTo(this.root); \n    }\n\n    if (this.theme.shapeType === 'circle') {\n      this.createCircle();\n    } else if (this.theme.shapeType === 'line') {\n      this.createLine();\n    }\n    this.isActive = true;\n  }\n  createCircle() {\n    let _ctx = this.dom.getContext('2d');\n    // _ctx.fillStyle = \"rgba(0, 0, 0, 1)\";\n    // _ctx.fillRect(0, 0, this.canvasWidth, this.canvasHeight);\n    _ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight); \n    _ctx.beginPath();\n    _ctx.fillStyle = this.theme.circleColor || '#000';\n    let _p = Math.PI * 2;\n    let _gap = parseInt(this.theme.gap);\n    _gap = _gap < 5 ? 5 : _gap;\n    for (let i = 0; i < this.canvasWidth; i += _gap) {\n      for (let j = 0; j < this.canvasHeight; j += _gap) {\n        _ctx.moveTo(i, j);\n        _ctx.arc(i, j, this.theme.circleRadiu, 0, _p);\n      }\n    }\n    _ctx.fill();\n  }\n  createLine() {\n    let _ctx = this.dom.getContext('2d');\n    _ctx.strokeStyle = this.theme.lineColor || '#000';\n    _ctx.lineWidth = this.theme.lineWidth || 1;\n    let _gap = parseInt(this.theme.gap);\n    _gap = _gap < 5 ? 5 : _gap;\n    for (let j = 0; j < this.canvasHeight; j += _gap) {\n      _ctx.beginPath();\n      _ctx.moveTo(0, j);\n      _ctx.lineTo(this.canvasWidth, j);\n      _ctx.stroke();\n      _ctx.closePath();\n    }\n    for (let i = 0; i < this.canvasWidth; i += _gap) {\n      _ctx.beginPath();\n      _ctx.moveTo(i, 0);\n      _ctx.lineTo(i, this.canvasHeight);\n      _ctx.stroke();\n      _ctx.closePath();\n    }\n    _ctx.stroke();\n  }\n  justifyAllCoordinate() {\n    let groups = this.canvas.groups;\n    let nodes = this.canvas.nodes;\n\n    let _justifyItem = (item, type) => {\n      let _sx = item.left;\n      let _sy = item.top;\n      let _ex = item.left + item.getWidth();\n      let _ey = item.top + item.getHeight();\n\n      let _left = _sx % this.theme.gap;\n      let _right = _ex % this.theme.gap;\n      let _top = _sy % this.theme.gap;\n      let _bottom = _ey % this.theme.gap;\n      let _posLeft = this.theme.gap - _left;\n      let _posRight = this.theme.gap - _right;\n      let _posTop = this.theme.gap - _top;\n      let _posBottom = this.theme.gap - _bottom;\n\n      let _pos = {\n        left: Infinity,\n        right: Infinity,\n        top: Infinity,\n        bottom: Infinity\n      };\n\n      if (_left < _right && _left < _pos['left']) {\n        _pos['left'] = _left;\n      }\n      if (_posLeft < _left && _posLeft < _pos['right']) {\n        _pos['right'] = _posLeft;\n      }\n\n      if (_right < _left && _right < _pos['right']) {\n        _pos['left'] = _right;\n      }\n      if (_posRight < _right && _posRight < _pos['left']) {\n        _pos['right'] = _posRight;\n      }\n\n      if (_top < _bottom && _top < _pos['top']) {\n        _pos['top'] = _top;\n      }\n      if (_posTop < _top && _posTop < _pos['bottom']) {\n        _pos['bottom'] = _posTop;\n      }\n\n      if (_bottom < _top && _bottom < _pos['bottom']) {\n        _pos['top'] = _bottom;\n      }\n      if (_posBottom < _bottom && _posBottom < _pos['top']) {\n        _pos['bottom'] = _posBottom;\n      }\n\n      let result = [item.left, item.top];\n\n      _pos['left'] = _pos['left'] <= this.theme.adsorbGap ? _pos['left'] : Infinity;\n      _pos['right'] = _pos['right'] <= this.theme.adsorbGap ? _pos['right'] : Infinity;\n      _pos['top'] = _pos['top'] <= this.theme.adsorbGap ? _pos['top'] : Infinity;\n      _pos['bottom'] = _pos['bottom'] <= this.theme.adsorbGap ? _pos['bottom'] : Infinity;\n\n      _pos['left'] < _pos['right'] && (result[0] -= _pos['left']);\n      _pos['right'] < _pos['left'] && (result[0] += _pos['right']);\n      _pos['top'] < _pos['bottom'] && (result[1] -= _pos['top']);\n      _pos['bottom'] < _pos['top'] && (result[1] += _pos['bottom']);\n\n      if (result[0] !== item.left || result[1] !== item.top) {\n        if (type === 'node') {\n          this.canvas._moveNode(item, result[0], result[1]);\n        } else if (type === 'group') {\n          this.canvas._moveGroup(item, result[0], result[1]);\n        }\n      }\n    };\n\n    groups.forEach((_group) => {\n      _justifyItem(_group, 'group');\n      (_group.nodes || []).forEach((_node) => {\n        _justifyItem(_node, 'node');\n      });\n    });\n\n    nodes.forEach((_node) => {\n      _justifyItem(_node, 'node');\n    });\n  }\n  destroy() {\n    this.dom.remove();\n    this.isActive = false;\n  }\n}\n\nexport default GridService;\n","'use strict';\n\nconst $ = require('jquery');\nconst _ = require('lodash');\n\nclass GuidelineService {\n  constructor(opts) {\n    this.root = opts.root;\n    this.canvas = opts.canvas;\n    this.dom = null;\n    this.cxt = null;\n\n    this.isActive = false;\n\n    this.limitNum = opts.limitNum;\n    this.theme = {\n      lineColor: '#9fd1ff',\n      lineWidth: 1\n    };\n  }\n  _resize() {\n    this.canvasHeight = $(this.root).height();\n    this.canvasWidth = $(this.root).width();\n    $(this.guideLineCanvas).attr('width', this.canvasWidth);\n    $(this.guideLineCanvas).attr('height', this.canvasHeight);\n  }\n  create(options = {}) {\n    this.theme = _.merge(this.theme, options.theme || {});\n\n    if (!this.dom) {\n      this.dom = $('<div class=\"butterfly-gird-canvas-wrapper\"></div>')[0];\n      this.guideLineCanvas = $('<canvas class=\"butterfly-guideline-canvas\"></canvas>')[0];\n      this._resize();\n      $(this.guideLineCanvas).appendTo(this.dom);\n      $(this.dom).appendTo(this.root);\n    }\n\n    this.cxt = this.guideLineCanvas.getContext('2d');\n    this.cxt.strokeStyle = this.theme.lineColor || '#000';\n    this.cxt.lineWidth = this.theme.lineWidth || 1;\n    this.isActive = true;\n  }\n  guidLine(\n    moveTo = [0, 0],\n    lineTo = [0, 0]\n  ) {\n    const process = (coord) => {\n      return Math.floor(coord) + 0.5;\n    };\n    this.cxt.beginPath();\n    this.cxt.moveTo(process(moveTo[0]), process(moveTo[1]));\n    this.cxt.lineTo(process(lineTo[0]), process(lineTo[1]));\n    this.cxt.stroke();\n    this.cxt.closePath();\n  } \n  draw(item, type) {\n\n    this.cxt.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\n\n    let _left = parseInt(item.left);\n    let _right = parseInt(item.left + item.getWidth());\n    let _top = parseInt(item.top);\n    let _bottom = parseInt(item.top + item.getHeight());\n    let _leftDis = Infinity;\n    let _rightDis = Infinity;\n    let _topDis = Infinity;\n    let _bottomDis = Infinity;\n\n    let _leftItem = null;\n    let _rightItem = null;\n    let _topItem = null;\n    let _bottomItem = null;\n\n    let groups = this.canvas.groups;\n    let nodes = this.canvas.nodes;\n    groups.forEach((_group) => {\n      if (type === 'group' && item.id === _group.id) {\n        return;\n      }\n\n      let _groupLeft = parseInt(_group.left);\n      let _groupRight = parseInt(_group.left + _group.getWidth());\n      let _groupTop = parseInt(_group.top);\n      let _groupBottom = parseInt(_group.top + _group.getHeight());\n\n      // 向左对齐的元素\n      if (_left === _groupLeft) {\n        if (Math.abs(_groupTop - _top) < _topDis) {\n          _topDis = Math.abs(_groupTop - _top);\n          _leftItem = _group;\n        }\n      }\n\n      // 向右对齐的元素\n      if (_right === _groupRight) {\n        if (Math.abs(_groupBottom - _bottom) < _bottomDis) {\n          _bottomDis = Math.abs(_groupBottom - _bottom);\n          _rightItem = _group;\n        }\n      }\n\n      // 向上对齐的元素\n      if (_top === _groupTop) {\n        if (Math.abs(_groupLeft - _left) < _leftDis) {\n          _leftDis = Math.abs(_groupLeft - _left);\n          _topItem = _group;\n        }\n      }\n\n      // 向下对齐的元素\n      if (_bottom === _groupBottom) {\n        if (Math.abs(_groupRight - _right) < _rightDis) {\n          _rightDis = Math.abs(_groupRight - _right);\n          _bottomItem = _group;\n        }\n      }\n    });\n    \n    nodes.forEach((_node) => {\n      if (type === 'node' && item.id === _node.id) {\n        return;\n      }\n\n      let _nodeLeft = parseInt(_node.left);\n      let _nodeRight = parseInt(_node.left + _node.getWidth());\n      let _nodeTop = parseInt(_node.top);\n      let _nodeBottom = parseInt(_node.top + _node.getHeight());\n\n      if (_node._group) {\n        _nodeLeft += _node._group.left;\n        _nodeRight += _node._group.left;\n        _nodeTop += _node._group.top;\n        _nodeBottom += _node._group.top;\n      }\n\n      // 向左对齐的元素\n      if (_left === _nodeLeft) {\n        if (Math.abs(_nodeTop - _top) < _topDis) {\n          _topDis = Math.abs(_nodeTop - _top);\n          _leftItem = _node;\n        }\n      }\n\n      // 向右对齐的元素\n      if (_right === _nodeRight) {\n        if (Math.abs(_nodeBottom - _bottom) < _bottomDis) {\n          _bottomDis = Math.abs(_nodeBottom - _bottom);\n          _rightItem = _node;\n        }\n      }\n\n      // 向上对齐的元素\n      if (_top === _nodeTop) {\n        if (Math.abs(_nodeLeft - _left) < _leftDis) {\n          _leftDis = Math.abs(_nodeLeft - _left);\n          _topItem = _node;\n        }\n      }\n\n      // 向下对齐的元素\n      if (_bottom === _nodeBottom) {\n        if (Math.abs(_nodeRight - _right) < _rightDis) {\n          _rightDis = Math.abs(_nodeRight - _right);\n          _bottomItem = _node;\n        }\n      }\n    });\n\n    if (_leftItem) {\n      let startY = _top > _leftItem.top ? _leftItem.top : _top;\n      let endY = _top > _leftItem.top ? _bottom : _leftItem.top + _leftItem.getHeight();\n      this.guidLine([_left, startY], [_left, endY]);\n    }\n\n    if (_rightItem) {\n      let startY = _top > _rightItem.top ? _rightItem.top : _top;\n      let endY = _top > _rightItem.top ? _bottom : _rightItem.top + _rightItem.getHeight();\n      this.guidLine([_right, startY], [_right, endY]);\n    }\n\n    if (_topItem) {\n      let startX = _left > _topItem.left ? _topItem.left : _left;\n      let endX = _left > _topItem.left ? _right : _topItem.left + _topItem.getWidth();\n      this.guidLine([startX, _top], [endX, _top]);\n    }\n\n    if (_bottomItem) {\n      let startX = _left > _bottomItem.left ? _bottomItem.left : _left;\n      let endX = _left > _bottomItem.left ? _right : _bottomItem.left + _bottomItem.getWidth();\n      this.guidLine([startX, _bottom], [endX, _bottom]);\n    }\n  }\n  zoom(scale) {\n    $(this.dom).css({\n      transform: `scale(${scale})`\n    });\n    this.clearCanvas();\n  }\n  move(x, y) {\n    $(this.dom)\n      .css('left', x)\n      .css('top', y);\n    this.clearCanvas();\n  }\n  clearCanvas() {\n    this.cxt && this.cxt.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\n  }\n  destroy() {\n    $(this.dom).destroy();\n    this.isActive = false;\n  }\n}\n\nexport default GuidelineService;\n","const _ = require('lodash');\nconst $ = require('jquery');\n// 每一个dot是一个圆形或者\nconst DOT_COLOR = 'rgba(246, 105, 2, 1)';\nconst GROUP_COLOR = 'rgba(61, 86, 92, 1)';\nconst DOT_ACTIVE_COLOR = 'rgba(255, 253, 76, 1)';\nconst GROUP_ACTIVE_COLOR = 'rgba(255, 253, 76, 1)';\nconst SAFE_DISTANCE = 20;\n\n// 修改一个element的css的属性\nconst modifyCSS = (ele, cssStyle) => {\n  if (!ele || !ele.style) {\n    return;\n  }\n\n  Object.keys(cssStyle).forEach(key => {\n    ele.style[key] = cssStyle[key];\n  });\n};\n\n// 获取Canvas缩放比，兼容高清屏\nconst getPixelRatio = function (context) {\n  const backingStore = context.backingStorePixelRatio ||\n  context.webkitBackingStorePixelRatio ||\n  context.mozBackingStorePixelRatio ||\n  context.msBackingStorePixelRatio ||\n  context.oBackingStorePixelRatio ||\n  context.backingStorePixelRatio || 1;\n  return (window.devicePixelRatio || 1) / backingStore;\n};\n\n// check constructor 的 options\nconst checkOpts = (options) => {\n  if(!options) {\n    throw new Error('options cant be empty');\n  }\n\n  if(!options.root || typeof options.root !== 'object' || !$(options.root)) {\n    throw new Error('options.root must be a html element');\n  }\n\n  if(!options.move || typeof options.move !== 'function') {\n    throw new Error('options.move must be a fuction');\n  }\n\n  if(!options.terminal2canvas || typeof options.terminal2canvas !== 'function') {\n    throw new Error('options.move must be a fuction');\n  }\n\n}\n\n/**\n * options:\n *  height {Number} 缩略图高度 default 200,\n *  width  {Number} 缩略图宽度 default 200,\n *  className {String} default: butterfly-minimap-container\n *  containerStyle {Object} 外层css\n *  viewportStyle {Object} 视口css\n *  backgroudStyle {Object} 底层css\n *  nodeColor {String} 节点颜色\n *  groupColor {String} 节点组颜色\n *  root {Element} 画布容器节点\n *  containerWidth {Number} 画布的宽度, 可自定义\n *  containerHeight {Number} 同上\n *  nodes {Pointer[]} 节点信息\n *    node.left, node.top 节点的坐标轴信息\n *  groups {Object[]} 节点组信息\n *    group.left, group.top, group.width, group.height 节点组的二维信息\n *  offset {Pointer} 偏移信息\n *  zoom {Number} 画布当前缩放比\n *  move {Function} 缩略图互动函数, 用于移动画布, 参考小蝴蝶的move\n *  terminal2canvas {Function} 互动函数, 屏幕坐标到画布坐标的转换\n *  safeDistance {Number} 画布视口在minimap距离边距的安全距离，默认20\n *  activeNodeColor {String} 选中的节点颜色\n *  activeGroupColor {String} 选中的节点组颜色\n *  events {String[]} 补充的监听事件\n */\nclass Minimap {\n  constructor(options) {\n    checkOpts(options);\n\n    this.root = options.root;\n    this.$root = $(this.root);\n\n    this.options = {\n      height: 200,\n      width: 200,\n      className: 'butterfly-minimap-container',\n      containerStyle: {},\n      viewportStyle: {},\n      backgroudStyle: {},\n      nodeColor: DOT_COLOR,\n      groupColor: GROUP_COLOR,\n      activeNodeColor: DOT_ACTIVE_COLOR,\n      activeGroupColor: GROUP_ACTIVE_COLOR,\n      containerWidth: $(this.root).width(),\n      containerHeight: $(this.root).height(),\n      nodes: [],\n      groups: [],\n      offset: [0, 0],\n      zoom: 1,\n      move: () => null,\n      terminal2canvas: () => null,\n      safeDistance: SAFE_DISTANCE,\n      ...options\n    };\n\n    // 画布到缩略图的缩放比\n    this.ratio = 1;    \n\n    // 初始化容器\n    this.initContainer();\n    // 渲染视口\n    this.renderViewPort();\n    // 渲染背景\n    this.renderBG();\n  }\n\n\n  // 获取所有元素的屏幕坐标\n  getItemsPoint = () => {\n    const nodes = _.cloneDeep(this.options.nodes);\n    const groups = _.cloneDeep(this.options.groups);\n    const {canvas2terminal} = this.options;\n    const height = this.$root.height();\n    const width = this.$root.width();\n\n    // 增加两个虚拟的点，防止只有一个node时宽度过大的问题\n    nodes.push({left: 0, top: 0, height: 1, width: 1});\n    nodes.push({left: width, top: height, height: 1, width: 1});\n\n    // 计算所有 nodes 的真实坐标\n    for(let node of nodes) {\n      if(node.group) {\n        const group = _.find(groups, {id: node.group});\n\n        if(!group) {\n          continue;\n        }\n\n        node.rleft = group.left + node.left;\n        node.rtop = group.top + node.top;\n\n        continue;\n      }\n\n      node.rleft = node.left;\n      node.rtop = node.top;\n    }\n\n    groups.forEach(group => {\n      const leftTop = [group.left, group.top];\n      const rightBottom = [group.left + group.width, group.top + group.height];\n\n      const screenLeftTop = canvas2terminal(leftTop);\n      const screenRightBottom =  canvas2terminal(rightBottom);\n\n      group.screenLeftTop = screenLeftTop;\n      group.screenRightBottom = screenRightBottom;\n\n      group.left = screenLeftTop[0];\n      group.top = screenLeftTop[1];\n      group.width = screenRightBottom[0] - screenLeftTop[0];\n      group.height = screenRightBottom[1] - screenLeftTop[1];\n    });\n\n    nodes.forEach(node => {\n      const leftTop = [node.rleft, node.rtop];\n      const rightBottom = [node.rleft + node.width, node.rtop + node.height];\n\n      const screenLeftTop = canvas2terminal(leftTop);\n      const screenRightBottom =  canvas2terminal(rightBottom);\n\n      node.left = screenLeftTop[0];\n      node.top = screenLeftTop[1];\n      node.width = screenRightBottom[0] - screenLeftTop[0];\n      node.height = screenRightBottom[1] - screenLeftTop[1];\n    });\n\n    return {\n      groups, nodes\n    }\n  }\n\n  // 获取画布的有内容的区域\n  getBBox() {\n    const {nodes, groups} = this.getItemsPoint()\n\n    const check = (v) => {\n      return _.isNumber(v) ? v : 0;\n    }\n\n    const allNTop = nodes.map(node => node.top);\n    const allNLeft = nodes.map(node => node.left);\n    const allNBottom = nodes.map(node => node.top + node.height);\n    const allNRight = nodes.map(node => node.left + node.width);\n\n    const allGTop = groups.map(group => group.top);\n    const allGLeft = groups.map(group => group.left);\n    const allGBottom = groups.map(group => group.top + group.height);\n    const allGRight = groups.map(group => group.left + group.width);\n\n    const allTop = allNTop.concat(allGTop);\n    const allLeft = allNLeft.concat(allGLeft);\n\n    const allBottom = allNBottom.concat(allGBottom);\n    const allRight = allNRight.concat(allGRight);\n\n    const minX = check(_.min(allLeft));\n    const minY = check(_.min(allTop));\n\n    const maxX = check(_.max(allRight));\n    const maxY = check(_.max(allBottom));\n\n    return {\n      minX: minX,\n      minY: minY,\n      width: maxX - minX,\n      height: maxY - minY,\n    }\n  }\n\n  // 获取画布和缩略图的缩放比\n  setRatio() {\n    const height = this.options.height;\n    const width = this.options.width;\n    const graphSize = this.getBBox();\n\n    if(graphSize.width === 0 || graphSize.height === 0) {\n      return 0;\n    }\n\n    const ratio = Math.min(width / graphSize.width, height / graphSize.height);\n\n    this.ratio = Number(ratio.toFixed(2));\n  }\n\n  // 更新小地图数据\n  update({\n    nodes = [],\n    groups = [],\n    zoom = 1,\n    offset = [0, 0],\n  }) {\n    this.options.nodes = nodes;\n    this.options.groups = groups;\n    this.options.zoom = zoom;\n    this.options.offset = offset;\n\n    this.debounceRender();\n  }\n\n  getViewportBBox = () => {\n    const $viewport = $(this.viewportDOM);\n    const parent = $viewport.offsetParent();\n    const offset = $viewport.offset();\n    const poffset = $(parent).offset();\n    const left = offset.left - poffset.left;\n    const top = offset.top - poffset.top;\n\n    const width = $viewport.width();\n    const height = $viewport.height();\n    const right = left + width;\n    const bottom = top + height;\n\n    return {\n      left, top, right,bottom, height, width\n    }\n  }\n\n  // 初始化画布\n  initContainer() {\n    const {\n      height, width, className, \n      viewportStyle, backgroudStyle, containerStyle\n    } = this.options;\n\n    this.container = document.createElement('div');\n    this.viewportDOM = document.createElement('div');\n    this.backgroundDOM = document.createElement('div');\n\n    this.container.setAttribute('class', className);\n\n    const initStyle = {\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      overflow: 'hidden',\n      height: height + 'px',\n      width: width + 'px'\n    };\n\n    modifyCSS(this.container, {\n      ...initStyle,\n      right: '10px',\n      bottom: '10px',\n      left: 'none',\n      top: 'none',\n      height:  height + 'px',\n      width: width + 'px',\n      border: '1px solid #aaa',\n      'z-index': 100,\n      ...containerStyle\n    });\n\n    modifyCSS(this.viewportDOM , {\n      ...initStyle,\n      left: 0,\n      top: 0,\n      // border: '1px solid pink',\n      'background-color': 'rgba(246,105,2,0.20)',\n      ...viewportStyle,\n    });\n\n    modifyCSS(this.backgroundDOM , {      \n      ...initStyle,\n      ...backgroudStyle,\n      height: height + 'px',\n      width: width + 'px',      \n    });\n\n    this.root.appendChild(this.container);\n    this.container.appendChild(this.backgroundDOM);\n    this.container.appendChild(this.viewportDOM);\n\n    this.initBGCanvas();\n    this.initViewportEvts();\n  }\n\n  // 创建BG canvas\n  initBGCanvas() {\n    const {width, height} = this.options;\n    const canvasDom = document.createElement('canvas');\n    this.backgroundDOM.appendChild(canvasDom);\n\n    canvasDom.setAttribute('width', width);\n    canvasDom.setAttribute('height', height);\n    modifyCSS(canvasDom, {\n      position: 'absolute',\n      width: '100%',\n      height: '100%',\n      left: 0,\n      top: 0\n    });\n\n    const cvsCtx = canvasDom.getContext('2d');\n    // 初始化2D画布\n    this.cvsCtx = cvsCtx;\n    this.cvsRatio = getPixelRatio(cvsCtx);\n    cvsCtx.scale(this.cvsRatio, this.cvsRatio);\n  }\n\n  // 初始化视窗事件\n  initViewportEvts() {\n    let dragging = false;\n    let x = 0;\n    let y = 0;\n    let left = 0;\n    let top = 0;\n\n    this.viewportEvents = {\n      mousedown: (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        const viewportDOM = this.viewportDOM;\n\n        if (e.target !== this.viewportDOM) {\n          return;\n        }\n\n        const viewportBBox = this.getViewportBBox();\n\n        left = parseInt(viewportBBox.left, 10);\n        top = parseInt(viewportBBox.top, 10);\n\n        dragging = true;\n        x = e.clientX;\n        y = e.clientY;\n      },\n      mousemove: (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (!dragging || _.isNil(e.clientX) || _.isNil(e.clientY)) {\n          return;\n        }\n\n        let dx = x - e.clientX;\n        let dy = y - e.clientY;\n\n        left -= dx;\n        top -= dy;\n\n        const {width: mapWidth, height: mapHeight, safeDistance} = this.options;\n        const {width: vpWidth, height: vpHeight} = this.getViewportBBox();\n\n        // 限制视口不能够超出 minimap 的安全距离\n        if(\n          left >= mapWidth - safeDistance ||\n          top >= mapHeight - safeDistance ||\n          left + vpWidth <= safeDistance ||\n          top + vpHeight <= safeDistance\n        ) {\n          left += dx;\n          top += dy;\n\n          return;\n        }\n\n\n        modifyCSS(this.viewportDOM, {\n          left: left + 'px',\n          top: top + 'px'\n        });\n\n        const {minX, minY} = this.getBBox();\n        const offset = this.$root.offset();\n        const boffset = this.options.offset;\n\n        const ddx = (((-left / this.ratio) + offset.left) - minX) * this.ratio;\n        const ddy = (((-top / this.ratio) + offset.top) - minY) * this.ratio;\n        \n        this.options.move(\n          [\n            boffset[0] + ddx / this.ratio,\n            boffset[1] + ddy / this.ratio\n          ]\n        );\n\n        x = e.clientX;\n        y = e.clientY;\n      },\n      mouseleave: () => {\n        dragging = false;\n      },\n      mouseup: () => {\n        dragging = false;\n      }\n    };\n\n    Object.keys(this.viewportEvents).forEach(key => {\n      this.container.addEventListener(key, this.viewportEvents[key]);\n    });\n  }\n\n  // 渲染缩略图canvas\n  renderBG() {\n    const cvsCtx = this.cvsCtx;\n    const {width, height, nodeColor, groupColor, activeNodeColor, activeGroupColor} = this.options;\n    const cvsRatio = this.cvsRatio;\n\n    cvsCtx.clearRect(0, 0, width, height);\n\n    // 根据所有点的信息画出所有的点\n    const {nodes, groups} = this.getItemsPoint();\n    const {minX, minY} = this.getBBox();\n\n    groups.forEach(group => {\n      const left = (group.left - minX) * this.ratio;\n      const top = (group.top - minY) * this.ratio;\n      const width = group.width * this.ratio;\n      const height = group.height * this.ratio;\n      const minimapActive = group.minimapActive;\n\n      if(minimapActive) {\n        cvsCtx.fillStyle = activeGroupColor;\n      } else {\n        cvsCtx.fillStyle = groupColor;\n      }\n\n      cvsCtx.fillRect(left / cvsRatio, top / cvsRatio, width / cvsRatio, height / cvsRatio);\n    });\n\n    nodes.forEach(node => {\n      const left = (node.left - minX) * this.ratio;\n      const top = (node.top - minY) * this.ratio;\n      const width = node.width * this.ratio;\n      const height = node.height * this.ratio;\n\n      if(node.minimapActive) {\n        cvsCtx.fillStyle = activeNodeColor;\n      } else {\n        cvsCtx.fillStyle = nodeColor;\n      }\n\n      // cvsCtx.beginPath();\n      cvsCtx.fillRect(left / cvsRatio, top / cvsRatio, width / cvsRatio, height / cvsRatio);\n      // cvsCtx.arc(left / cvsRatio, top / cvsRatio, DOT_SIZE / cvsRatio, 0, 2*Math.PI);\n      // cvsCtx.closePath();\n      // cvsCtx.fill();\n    });\n  }\n\n  // 绘制出拖动框\n  renderViewPort() {\n    this.setRatio();\n\n    const {minX, minY} = this.getBBox();\n\n    const {top, left} = this.$root.offset();\n\n    const rootWidth = this.$root.width();\n    const rootHeight = this.$root.height();\n    const offset = [left - minX, top - minY];\n\n    // 获取画布到minimap的缩放比\n    const ratio = this.ratio;\n\n    const vwidth = rootWidth * this.ratio;\n    const vheight = rootHeight * this.ratio;\n    const vleft = Math.round(Math.round(offset[0]) * ratio);\n    const vtop = Math.round(Math.round(offset[1]) * ratio);\n\n    modifyCSS(this.viewportDOM, {\n      width: `${vwidth}px`,\n      height: `${vheight}px`,\n      left: `${vleft}px`,\n      top: `${vtop}px`,\n    });\n  }\n\n  // 延时渲染\n  debounceRender = _.debounce(() => {\n    this.renderViewPort();\n    this.renderBG();\n  }, 100)\n\n  destroy() {\n    // 销毁DOM\n    this.root.removeChild(this.container);\n  }\n}\n\nexport default Minimap;\n","'use strict';\n\nconst $ = require('jquery');\nconst _ = require('lodash');\nconst domtoimage = require('dom-to-image');\n\nimport Canvas from \"../interface/canvas\";\nimport Node from '../node/baseNode';\nimport Edge from '../edge/baseEdge';\nimport Group from '../group/baseGroup';\nimport Endpoint from '../endpoint/baseEndpoint';\nimport Layout from '../utils/layout/layout';\nimport SelectCanvas from '../utils/selectCanvas';\n// 画布和屏幕坐标地换算\nimport CoordinateService from '../utils/coordinate';\n// scope的比较\nimport ScopeCompare from '../utils/scopeCompare';\n// 网格模式\nimport GridService from '../utils/girdService';\n// 辅助线模式\nimport GuidelineService from '../utils/guidelineService';\n// 小地图模式\nimport Minimap from '../utils/minimap';\n// 线段动画\nimport LinkAnimateUtil from '../utils/link_animate';\n\n\nimport './baseCanvas.less';\n\nclass BaseCanvas extends Canvas {\n  constructor(options) {\n    super(options);\n    this.root = options.root;\n    this.layout = options.layout; // layout部分也需要重新review\n    this.zoomable = options.zoomable || false; // 可缩放\n    this.moveable = options.moveable || false; // 可平移\n    this.draggable = options.draggable || false; // 可拖动\n    this.linkable = options.linkable || false; // 可连线\n    this.disLinkable = options.disLinkable || false; // 可拆线\n\n    this.theme = {\n      group: {\n        type: _.get(options, 'theme.group.type') || 'normal'\n      },\n      edge: {\n        type: _.get(options, 'theme.edge.type') || 'Bezier',\n        Class: _.get(options, 'theme.edge.Class') || Edge,\n        arrow: _.get(options, 'theme.edge.arrow'),\n        arrowPosition: _.get(options, 'theme.edge.arrowPosition'),\n        arrowOffset: _.get(options, 'theme.edge.arrowOffset'),\n        label: _.get(options, 'theme.edge.label'),\n        isRepeat: _.get(options, 'theme.edge.isRepeat') || false,\n        isLinkMyself: _.get(options, 'theme.edge.isLinkMyself') || false,\n        isExpandWidth: _.get(options, 'theme.edge.isExpandWidth') || false,\n        defaultAnimate: _.get(options, 'theme.edge.defaultAnimate') || false,\n      },\n      endpoint: {\n        position: _.get(options, 'theme.endpoint.position'),\n        linkableHighlight: _.get(options, 'theme.endpoint.linkableHighlight') || false,\n        limitNum: _.get(options, 'theme.endpoint.limitNum'),\n        expandArea: {\n          left: _.get(options, 'theme.endpoint.expandArea.left') === undefined ? 10 : _.get(options, 'theme.endpoint.expandArea.left'),\n          right: _.get(options, 'theme.endpoint.expandArea.right') === undefined ? 10 : _.get(options, 'theme.endpoint.expandArea.right'),\n          top: _.get(options, 'theme.endpoint.expandArea.top') === undefined ? 10 : _.get(options, 'theme.endpoint.expandArea.top'),\n          bottom: _.get(options, 'theme.endpoint.expandArea.bottom') === undefined ? 10 : _.get(options, 'theme.endpoint.expandArea.bottom'),\n        },\n      },\n      zoomGap: _.get(options, 'theme.zoomGap') || 0.001,\n      // 鼠标到达边缘画布自动移动\n      autoFixCanvas: {\n        enable: _.get(options, 'theme.autoFixCanvas.enable', false),\n        autoMovePadding: _.get(options, 'theme.autoFixCanvas.autoMovePadding') || [20, 20, 20, 20] // 上，右，下，左\n      },\n      // 自动适配父级div大小\n      autoResizeRootSize: _.get(options, 'theme.autoResizeRootSize', true)\n    };\n\n    // 贯穿所有对象的配置\n    this.global = _.get(options, 'global', {\n      isScopeStrict: _.get(options, 'global.isScopeStrict'), // 是否为scope的严格模式\n      limitQueueLen: 5 // 默认操作队列只有5步\n    });\n\n    // 放大缩小和平移的数值\n    this._zoomData = 1;\n    this._moveData = [0, 0];\n    this._zoomTimer = null;\n\n    this.groups = [];\n    this.nodes = [];\n    this.edges = [];\n\n    // 框选模式，需要重新考虑(默认单选)\n    this.isSelectMode = false;\n    this.selecContents = [];\n    this.selecMode = 'include';\n    this.selectItem = {\n      nodes: [],\n      edges: [],\n      groups: [],\n      endpoints: []\n    };\n    // 框选前需要纪录状态\n    this._remarkZoom = undefined;\n    this._remarkMove = undefined;\n\n    this.svg = null;\n    this.wrapper = null;\n    this.canvasWrapper = null;\n    // 加一层wrapper方便处理缩放，平移\n    this._genWrapper();\n    // 加一层svg画线条\n    this._genSvgWrapper();\n    // 加一层canvas方便处理辅助\n    this._genCanvasWrapper();\n    // 动画初始化\n    LinkAnimateUtil.init(this.svg);\n\n    // 统一处理画布拖动事件\n    this._dragType = null;\n    this._dragNode = null;\n    this._dragEndpoint = null;\n    this._dragEdges = [];\n    this._dragGroup = null;\n\n    // 初始化一些参数\n    this._rootWidth = $(this.root).width();\n    this._rootHeight = $(this.root).height();\n    $(this.root).css('overflow', 'hidden');\n    if($(this.root).css('position') === 'static') {\n      $(this.root).css('position', 'relative');\n    }\n\n    // 节点,线段,节点组z-index值，顺序：节点 > 线段 > 节点组\n    this._dragGroupZIndex = 50;\n    this._dragNodeZIndex = 250;\n    this._dragEdgeZindex = 499;\n    this._isInitEdgeZIndex = false;\n\n    // 检测节点拖动节点组的hover状态\n    this._hoverGroupQueue = [];\n    this._hoverGroupObj = undefined;\n    this._hoverGroupTimer = undefined;\n\n    // 网格布局\n    this._gridService = new GridService({\n      root: this.root,\n      canvas: this\n    });\n\n    // 辅助线\n    this._guidelineService = new GuidelineService({\n      root: this.root,\n      canvas: this\n    });\n    this._bgObjQueue = [];\n    this._bgObj = undefined;\n    this._bgTimer = undefined;\n\n    // 坐标转换服务\n    this._coordinateService = new CoordinateService({\n      canvas: this,\n      terOffsetX: $(this.root).offset().left,\n      terOffsetY: $(this.root).offset().top,\n      terWidth: $(this.root).width(),\n      terHeight: $(this.root).height(),\n      canOffsetX: this._moveData[0],\n      canOffsetY: this._moveData[1],\n      scale: this._zoomData\n    });\n\n    this._addEventListener();\n\n    this._unionData = {\n      __system: {\n        nodes: [],\n        edges: [],\n        groups: [],\n        endpoints: []\n      }\n    };\n\n    this._NodeClass = Node;\n\n    // undo & redo队列\n    this.actionQueue = [];\n    this.actionQueueIndex = -1;\n\n    // 画布边缘\n    this._autoMoveDir = [];\n    this._autoMoveTimer = null;\n  }\n\n  updateRootResize(opts = {}) {\n    this._coordinateService._changeCanvasInfo({\n      terOffsetX: opts.terOffsetX || $(this.root).offset().left,\n      terOffsetY: opts.terOffsetY || $(this.root).offset().top,\n      terWidth: opts.terWidth || $(this.root).width(),\n      terHeight: opts.terHeight || $(this.root).height()\n    });\n    this.canvasWrapper._changeCanvasInfo({\n      terScrollX: opts.terScrollX || 0,\n      terScrollY: opts.terScrollY || 0\n    });\n    this.canvasWrapper.resize({\n      root: this.root\n    });\n    this._gridService._resize();\n    this._guidelineService._resize();\n  }\n\n  draw(opts, callback) {\n    const groups = opts.groups || [];\n    const nodes = opts.nodes || [];\n    const edges = opts.edges || [];\n\n    // 自动布局需要重新review\n    if (this.layout) {\n      this._autoLayout({\n        groups,\n        nodes,\n        edges\n      });\n    }\n\n    let drawPromise = new Promise((resolve, reject) => {\n      setTimeout(() => {\n        // 生成groups\n        this.addGroups(groups);\n        resolve();\n      });\n    }).then(() => {\n      return new Promise((resolve, reject) => {\n        setTimeout(() => {\n          // 生成nodes\n          this.addNodes(nodes);\n          resolve();\n        }, 10);\n      });\n    }).then((resolve) => {\n      return new Promise((resolve, reject) => {\n        setTimeout(() => {\n          // 生成edges\n          this.addEdges(edges);\n        resolve();\n        }, 20);\n      });\n    });\n    \n    drawPromise.then(() => {\n      this.actionQueue = [];\n      this.actionQueueIndex = -1;\n      callback && callback({\n        nodes: this.nodes,\n        edges: this.edges,\n        groups: this.groups\n      });\n    });\n  }\n\n  redraw (opts, callback) {\n    this.removeNodes(this.nodes);\n    this.removeGroups(this.groups);\n    this.clearActionQueue();\n    this.draw(opts, callback);\n  }\n\n  getNode(id) {\n    return _.find(this.nodes, item => item.id === id);\n  }\n\n  getEdge(id) {\n    return _.find(this.edges, item => item.id === id);\n  }\n\n  getGroup(id) {\n    return _.find(this.groups, item => item.id === id);\n  }\n\n  addGroup(group, nodes, options, isNotEventEmit) {\n    const container = $(this.wrapper);\n    const GroupClass = group.Class || Group;\n    let _newNodes = [];\n    const _groupObj = new GroupClass(_.assign(_.cloneDeep(group), {\n      _global: this.global,\n      _emit: this.emit.bind(this),\n      _on: this.on.bind(this),\n      draggable: group.draggable !== undefined ? group.draggable : this.draggable\n    }));\n    if (this._isExistGroup(_groupObj)) {\n      // 后续用新的group代码旧的group\n      console.warn(`group:${_groupObj.id} has existed`);\n      return;\n    }\n    _groupObj.init();\n    container.prepend(_groupObj.dom);\n    this.groups.push(_groupObj);\n\n    _groupObj._createEndpoint();\n\n    _groupObj.mounted && _groupObj.mounted();\n\n    if (nodes && nodes.length > 0) {\n      // 过滤掉scope不匹配的节点 和 已存在其他组的node\n      nodes = nodes.filter((_node) => {\n        return ScopeCompare(_node.scope, _groupObj.scope, _.get(this, 'global.isScopeStrict')) && (_node.group === _groupObj.id || _node.group == undefined);\n      });\n\n      let _isAbsolutePos = _.get(options, 'posType', 'absolute') === 'absolute';\n      // 重新计算group的位置\n      let _groupLeft = Infinity;\n      let _groupTop = Infinity;\n      nodes.forEach((_node) => {\n        if (_isAbsolutePos) {\n          if (_node.left < _groupLeft) {\n            _groupLeft = _node.left;\n          }\n          if (_node.top < _groupTop) {\n            _groupTop = _node.top;\n          }\n        }\n      });\n      _groupObj._moveTo(_groupLeft - _.get(options, 'padding', 5), _groupTop - _.get(options, 'padding', 5));\n\n      // 添加节点\n      _newNodes = nodes.map((_node) => {\n        let newNode = null;\n        // 已存在节点\n        let _existNode = _.find(this.nodes, (__node) => {\n          return __node.id === _node.id;\n        });\n        if (_existNode) {\n          this.removeNode(_existNode.id, true, true);\n          _existNode._init({\n            dom: _existNode.dom,\n            top: _existNode.top - _groupObj.top,\n            left: _existNode.left - _groupObj.left,\n            group: _groupObj.id\n          })\n          newNode = this.addNode(_existNode, true);\n        } else {\n          let _nodeObj = null;\n          if (_node instanceof Node || _node.__type === 'node') {\n            _nodeObj = _node;\n          } else {\n            const _NodeClass = _node.Class || this._NodeClass;\n            _nodeObj = new _NodeClass(_.assign(_.cloneDeep(_node), {\n              _global: this.global,\n              _on: this.on.bind(this),\n              _emit: this.emit.bind(this),\n              _endpointLimitNum: this.theme.endpoint.limitNum,\n              draggable: _node.draggable !== undefined ? _node.draggable : this.draggable\n            }));\n          }\n          if (_isAbsolutePos) {\n            _nodeObj.top = _nodeObj.top - _groupObj.top;\n            _nodeObj.left = _nodeObj.left - _groupObj.left;\n          }\n          _nodeObj.group = _groupObj.id;\n          newNode = this.addNode(_nodeObj);\n        }\n        return newNode;\n      });\n\n      // 重新计算group的大小\n      let _groupWidth = -Infinity;\n      let _groupHeight = -Infinity;\n      _newNodes.forEach((_node) => {\n        let _w = $(_node.dom).width();\n        let _h = $(_node.dom).height();\n        if (_groupWidth < _node.left + _w) {\n          _groupWidth = _node.left + _w;\n        }\n        if (_groupHeight < _node.top + _h) {\n          _groupHeight = _node.top + _h;\n        }\n      });\n      _groupObj.setSize(_groupWidth + _.get(options, 'padding', 5) * 2, _groupHeight + _.get(options, 'padding', 5) * 2);\n    }\n\n    if (!isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:addGroups',\n        data: [{\n          group: _groupObj,\n          nodes: _newNodes\n        }]\n      });\n      this.emit('events', {\n        type: 'group:add',\n        group: _groupObj\n      });\n    }\n\n    return _groupObj;\n  }\n\n  addNodes(nodes, isNotEventEmit) {\n    const _canvasFragment = document.createDocumentFragment();\n    const container = $(this.wrapper);\n    const result = nodes.filter((node) => {\n      if (node.group) {\n        let _existGroup = this.getGroup(node.group);\n        if (!_existGroup) {\n          console.warn(`\bnodeId为${node.id}的节点找不到groupId为${node.group}的节点组，因此无法渲染`);\n          return false;\n        }\n      }\n      return true;\n    }).map((node) => {\n      let _nodeObj = null;\n      if (node instanceof Node || node.__type === 'node') {\n        _nodeObj = node;\n      } else {\n        const _NodeClass = node.Class || this._NodeClass;\n        _nodeObj = new _NodeClass(_.assign(_.cloneDeep(node), {\n          _global: this.global,\n          _on: this.on.bind(this),\n          _emit: this.emit.bind(this),\n          _endpointLimitNum: this.theme.endpoint.limitNum,\n          draggable: node.draggable !== undefined ? node.draggable : this.draggable\n        }));\n      }\n\n      if (this._isExistNode(_nodeObj)) {\n        // 后续用新的node代码旧的node\n        console.warn(`node:${_nodeObj.id} has existed`);\n        return;\n      }\n\n      // 节点初始化，假如已经存在过的节点就不需要重绘了\n      let initObj = {};\n      if (_nodeObj.dom) {\n        initObj['dom'] = _nodeObj.dom\n      }\n      _nodeObj._init(initObj);\n      // 一定要比group的addNode执行的之前，不然会重复把node加到this.nodes里面\n      this.nodes.push(_nodeObj);\n\n      // 假如节点存在group，即放进对应的节点组里\n      const existGroup = _nodeObj.group ? this.getGroup(_nodeObj.group) : null;\n      if (existGroup) {\n        if (ScopeCompare(_nodeObj.scope, existGroup.scope, _.get(this, 'global.isScopeStrict'))) {\n          existGroup._appendNodes([_nodeObj]);\n        } else {\n          console.warn(`nodeId为${_nodeObj.id}的节点和groupId${existGroup.id}的节点组scope值不符，无法加入`);\n        }\n      } else {\n        _canvasFragment.appendChild(_nodeObj.dom);\n      }\n      return _nodeObj;\n    }).filter((item) => {\n      return !!item;\n    });\n\n    // 批量插入dom，性能优化\n    container.append(_canvasFragment);\n\n    result.forEach((item) => {\n      // 渲染endpoint\n      item._createEndpoint(isNotEventEmit);\n\n      // 节点挂载\n      !isNotEventEmit && item.mounted && item.mounted();\n    });\n\n    if (result && result.length > 0 && !isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:addNodes',\n        data: result\n      });\n      this.emit('system.nodes.add', {\n        nodes: result\n      });\n      this.emit('events', {\n        type: 'nodes:add',\n        nodes: result\n      });\n    }\n    return result;\n  }\n\n  addNode(node, isNotEventEmit) {\n    return this.addNodes([node], isNotEventEmit)[0];\n  }\n\n  addEdges(links, isNotEventEmit) {\n    $(this.svg).css('visibility', 'hidden');\n\n    const _edgeFragment = document.createDocumentFragment();\n    const _labelFragment = document.createDocumentFragment();\n    const result = links.map((link) => {\n\n      // link已经存在\n      if (link instanceof Edge) {\n        link._init();\n\n        _edgeFragment.appendChild(link.dom);\n\n        if (link.labelDom) {\n          _labelFragment.appendChild(link.labelDom);\n        }\n\n        if (link.arrowDom) {\n          _edgeFragment.appendChild(link.arrowDom);\n        }\n\n        this.edges.push(link);\n\n        link.mounted && link.mounted();\n        return link;\n      }\n\n      // link不存在的话\n      const EdgeClass = link.Class || this.theme.edge.Class;\n      if (link.type === 'endpoint') {\n        let sourceNode = null;\n        let targetNode = null;\n        let _sourceType = link._sourceType;\n        let _targetType = link._targetType;\n\n        if (link.sourceNode instanceof Node || link.sourceNode.__type === 'node') {\n          _sourceType = 'node';\n          sourceNode = link.sourceNode;\n        } else if (link.sourceNode instanceof Group || link.sourceNode.__type === 'group') {\n          _sourceType = 'group';\n          sourceNode = link.sourceNode;\n        } else {\n          if (link._sourceType) {\n            sourceNode = _sourceType === 'node' ? this.getNode(link.sourceNode) : this.getGroup(link.sourceNode);\n          } else {\n            let _node = this.getNode(link.sourceNode);\n            if (_node) {\n              _sourceType = 'node';\n              sourceNode = _node;\n            } else {\n              _sourceType = 'group';\n              sourceNode = this.getGroup(link.sourceNode);\n            }\n          }\n        }\n\n        if (link.targetNode instanceof Node || link.targetNode.__type === 'node') {\n          _targetType = 'node';\n          targetNode = link.targetNode;\n        } else if (link.targetNode instanceof Group || link.targetNode.__type === 'group') {\n          _targetType = 'group';\n          targetNode = link.targetNode;\n        } else {\n          if (link._targetType) {\n            targetNode = _targetType === 'node' ? this.getNode(link.targetNode) : this.getGroup(link.targetNode);\n          } else {\n            let _node = this.getNode(link.targetNode);\n            if (_node) {\n              _targetType = 'node';\n              targetNode = _node;\n            } else {\n              _targetType = 'group';\n              targetNode = this.getGroup(link.targetNode);\n            }\n          }\n        }\n\n        if (!sourceNode || !targetNode) {\n          console.warn(`butterflies error: can not connect edge. link sourceNodeId:${link.sourceNode};link targetNodeId:${link.targetNode}`);\n          return;\n        }\n\n        let sourceEndpoint = null;\n        let targetEndpoint = null;\n\n        if (link.sourceEndpoint && (link.sourceEndpoint instanceof Endpoint || link.sourceEndpoint.__type === 'endpoint')) {\n          sourceEndpoint = link.sourceEndpoint;\n        } else {\n          sourceEndpoint = sourceNode.getEndpoint(link.source, 'source');\n        }\n\n        if (link.targetEndpoint && (link.targetEndpoint instanceof Endpoint || link.targetEndpoint.__type === 'endpoint')) {\n          targetEndpoint = link.targetEndpoint;\n        } else {\n          targetEndpoint = targetNode.getEndpoint(link.target, 'target');\n        }\n\n        if (!sourceEndpoint || !targetEndpoint) {\n          console.warn(`butterflies error: can not connect edge. link sourceId:${link.source};link targetId:${link.target}`);\n          return;\n        }\n\n        // 线条去重\n        if (!this.theme.edge.isRepeat) {\n          let _isRepeat = _.some(this.edges, (_edge) => {\n            let _result = false;\n            if (sourceNode) {\n              _result = sourceNode.id === _edge.sourceNode.id && sourceEndpoint.id === _edge.sourceEndpoint.id && _sourceType === _edge.sourceEndpoint.nodeType;\n            }\n\n            if (targetNode) {\n              _result = _result && (targetNode.id === _edge.targetNode.id && targetEndpoint.id === _edge.targetEndpoint.id && _targetType === _edge.targetEndpoint.nodeType);\n            }\n\n            return _result;\n          });\n          if (_isRepeat) {\n            console.warn(`id为${sourceEndpoint.id}-${targetEndpoint.id}的线条连接重复，请检查`);\n            return;\n          }\n        }\n        let edge = new EdgeClass({\n          type: 'endpoint',\n          id: link.id,\n          label: link.label,\n          shapeType: link.shapeType || this.theme.edge.type,\n          orientationLimit: this.theme.endpoint.position,\n          isExpandWidth: this.theme.edge.isExpandWidth,\n          defaultAnimate: this.theme.edge.defaultAnimate,\n          sourceNode,\n          targetNode,\n          sourceEndpoint,\n          targetEndpoint,\n          arrow: link.arrow === undefined ? _.get(this, 'theme.edge.arrow') : link.arrow,\n          arrowPosition: link.arrowPosition === undefined ? _.get(this, 'theme.edge.arrowPosition') : link.arrowPosition,\n          arrowOffset: link.arrowOffset === undefined ? _.get(this, 'theme.edge.arrowOffset') : link.arrowOffset,\n          options: link,\n          _sourceType,\n          _targetType,\n          _global: this.global,\n          _on: this.on.bind(this),\n          _emit: this.emit.bind(this),\n        });\n\n        edge._init();\n\n        _edgeFragment.appendChild(edge.dom);\n\n        if (edge.labelDom) {\n          _labelFragment.appendChild(edge.labelDom);\n        }\n\n        if (edge.arrowDom) {\n          _edgeFragment.appendChild(edge.arrowDom);\n        }\n\n        this.edges.push(edge);\n\n        edge.mounted && edge.mounted();\n\n        // 假如sourceEndpoint和targetEndpoint没属性，则自动添加上\n        if (sourceEndpoint.type === undefined) {\n          sourceEndpoint._tmpType = 'source';\n        }\n        if (targetEndpoint.type === undefined) {\n          targetEndpoint._tmpType = 'target';\n        }\n\n        return edge;\n      } else {\n        const sourceNode = this.getNode(link.source);\n        const targetNode = this.getNode(link.target);\n\n        if (!sourceNode || !targetNode) {\n          console.warn(`butterflies error: can not connect edge. link sourceId:${link.source};link targetId:${link.target}`);\n          return;\n        }\n\n        let edge = new EdgeClass({\n          type: 'node',\n          id: link.id,\n          label: link.label,\n          sourceNode,\n          targetNode,\n          shapeType: link.shapeType || this.theme.edge.type,\n          orientationLimit: this.theme.endpoint.position,\n          arrow: link.arrow === undefined ? _.get(this, 'theme.edge.arrow') : link.arrow,\n          arrowPosition: link.arrowPosition === undefined ? _.get(this, 'theme.edge.arrowPosition') : link.arrowPosition,\n          arrowOffset: link.arrowOffset === undefined ? _.get(this, 'theme.edge.arrowOffset') : link.arrowOffset,\n          isExpandWidth: this.theme.edge.isExpandWidth,\n          defaultAnimate: this.theme.edge.defaultAnimate,\n          _global: this.global,\n          _on: this.on.bind(this),\n          _emit: this.emit.bind(this),\n        });\n\n        edge._init();\n\n        _edgeFragment.appendChild(edge.dom);\n\n        if (edge.labelDom) {\n          _labelFragment.appendChild(edge.labelDom);\n        }\n\n        if (edge.arrowDom) {\n          _edgeFragment.appendChild(edge.arrowDom);\n        }\n\n        this.edges.push(edge);\n\n        edge.mounted && edge.mounted();\n\n        return edge;\n      }\n    }).filter(item => item);\n\n    $(this.svg).append(_edgeFragment);\n\n    $(this.wrapper).append(_labelFragment);\n\n    result.forEach((link) => {\n      let _soucePoint = {};\n      let _targetPoint = {};\n      if (link.type === 'endpoint') {\n        _soucePoint = {\n          pos: [link.sourceEndpoint._posLeft + link.sourceEndpoint._width / 2, link.sourceEndpoint._posTop + link.sourceEndpoint._height / 2],\n          orientation: link.sourceEndpoint.orientation ? link.sourceEndpoint.orientation : undefined\n        };\n        _targetPoint = {\n          pos: [link.targetEndpoint._posLeft + link.targetEndpoint._width / 2, link.targetEndpoint._posTop + link.targetEndpoint._height / 2],\n          orientation: link.targetEndpoint.orientation ? link.targetEndpoint.orientation : undefined\n        };\n      } else if (link.type === 'node') {\n        _soucePoint = {\n          pos: [link.sourceNode.left + link.sourceNode.getWidth() / 2, link.sourceNode.top + link.sourceNode.getHeight() / 2]\n        };\n\n        _targetPoint = {\n          pos: [link.targetNode.left + link.targetNode.getWidth() / 2, link.targetNode.top + link.targetNode.getHeight() / 2]\n        };\n      }\n      link.redraw(_soucePoint, _targetPoint);\n    });\n\n    if (!isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:addEdges',\n        data: result\n      });\n      this.emit('system.link.connect', {\n        links: result\n      });\n      this.emit('events', {\n        type: 'link:connect',\n        links: result\n      });\n    }\n\n    $(this.svg).css('visibility', 'visible');\n\n    return result;\n  }\n\n  addEdge(link, isNotEventEmit) {\n    return this.addEdges([link], isNotEventEmit)[0];\n  }\n\n  addGroups(datas) {\n    return datas.map(item => this.addGroup(item)).filter(item => item);\n  }\n\n  removeNode(nodeId, isNotDelEdge, isNotEventEmit) {\n    return this.removeNodes([nodeId], isNotDelEdge, isNotEventEmit);\n  }\n\n  removeNodes(nodes, isNotDelEdge, isNotEventEmit) {\n\n    let nodeIds = [];\n    nodeIds = nodes.map((item) => {\n      if (item instanceof Node) {\n        return item.id\n      } else {\n        return item;\n      }\n    });\n\n\n    let rmNodes = [];\n    let rmEdges = [];\n    nodeIds.forEach((nodeId) => {\n      const index = _.findIndex(this.nodes, _node => _node.id === nodeId);\n      if (index === -1) {\n        console.warn(`找不到id为：${nodeId}的节点`);\n        return;\n      }\n\n      // 删除邻近的线条\n      const neighborEdges = this.getNeighborEdges(nodeId);\n      if (!isNotDelEdge) {\n        this.removeEdges(neighborEdges, true, true);\n      }\n\n      // 删除节点\n      const node = this.nodes[index];\n      node.destroy(isNotEventEmit);\n\n      const _rmNodes = this.nodes.splice(index, 1);\n      // 假如在group里面\n      if (node.group) {\n        const group = this.getGroup(node.group);\n        if (group) {\n          group.nodes = group.nodes.filter(item => item.id !== node.id);\n        }\n      }\n\n      if (_rmNodes.length > 0) {\n        rmNodes = rmNodes.concat(_rmNodes);\n        rmEdges = rmEdges.concat(neighborEdges);\n      }\n\n    });\n\n    if (rmNodes.length > 0) {\n      if (!isNotEventEmit) {\n        this.pushActionQueue({\n          type: 'system:removeNodes',\n          data: {\n            nodes: rmNodes,\n            edges: rmEdges\n          }\n        });\n        this.emit('system.nodes.delete', {\n          nodes: rmNodes,\n          edges: rmEdges\n        });\n        this.emit('events', {\n          type: 'nodes:delete',\n          nodes: rmNodes,\n          edges: rmEdges\n        });\n      }\n    }\n\n    return {\n      nodes: rmNodes,\n      edges: rmEdges\n    };\n  }\n\n  removeEdges(edges, isNotEventEmit, isNotPushActionQueue) {\n    let result = [];\n    edges.forEach((_edge) => {\n      let edgeIndex = -1;\n      if (_edge instanceof Edge || _edge.__type === 'edge') {\n        edgeIndex = _.findIndex(this.edges, (item) => {\n          if (item.type === 'node') {\n            return _edge.sourceNode.id === item.sourceNode.id && _edge.targetNode.id === item.targetNode.id;\n          } else {\n            return (\n              _.get(_edge, 'sourceNode.id') === _.get(item, 'sourceNode.id') &&\n              _.get(_edge, 'sourceEndpoint.id') === _.get(item, 'sourceEndpoint.id') &&\n              _.get(_edge, 'sourceEndpoint.nodeType') === _.get(item, 'sourceEndpoint.nodeType')\n            ) && (\n                _.get(_edge, 'targetNode.id') === _.get(item, 'targetNode.id') &&\n                _.get(_edge, 'targetEndpoint.id') === _.get(item, 'targetEndpoint.id') &&\n                _.get(_edge, 'targetEndpoint.nodeType') === _.get(item, 'targetEndpoint.nodeType')\n              );\n          }\n        });\n      } else if (_.isString(_edge)) {\n        edgeIndex = _.findIndex(this.edges, (item) => {\n          return _edge === item.id;\n        });\n      } else {\n        console.warn(`删除线条错误，传入参数有误，请检查`);\n        return;\n      }\n      if (edgeIndex !== -1) {\n        result = result.concat(this.edges.splice(edgeIndex, 1));\n      } else {\n        console.warn(`删除线条错误，不存在值为${_edge.id}的线`);\n      }\n    });\n\n    if (!isNotPushActionQueue) {\n      this.pushActionQueue({\n        type: 'system:removeEdges',\n        data: result\n      });\n    }\n\n    if (!isNotEventEmit) {\n      this.emit('system.links.delete', {\n        links: result\n      });\n      this.emit('events', {\n        type: 'links:delete',\n        links: result\n      });\n    }\n\n\n    result.forEach((item) => {\n      item.destroy(isNotEventEmit);\n    });\n\n    // 把endpoint重新赋值\n    result.forEach((_rmEdge) => {\n      if (_.get(_rmEdge, 'sourceEndpoint._tmpType') === 'source') {\n        let isExistEdge = _.some(this.edges, (edge) => {\n          return _rmEdge.sourceNode.id === edge.sourceNode.id && _rmEdge.sourceEndpoint.id === edge.sourceEndpoint.id;\n        });\n        !isExistEdge && (_rmEdge.sourceEndpoint._tmpType = undefined);\n      }\n      if (_.get(_rmEdge, 'targetEndpoint._tmpType') === 'target') {\n        let isExistEdge = _.some(this.edges, (edge) => {\n          return _rmEdge.targetNode.id === edge.targetNode.id && _rmEdge.targetEndpoint.id === edge.targetEndpoint.id;\n        });\n        !isExistEdge && (_rmEdge.targetEndpoint._tmpType = undefined);\n      }\n    });\n    return result;\n  }\n\n  removeEdge(edge, isNotEventEmit, isNotPushActionQueue) {\n    return this.removeEdges([edge], isNotEventEmit, isNotPushActionQueue)[0];\n  }\n\n  removeGroup(data, isNotEventEmit) {\n    let groupId = undefined;\n    if (data instanceof Group) {\n      groupId = data.id;\n    } else {\n      groupId = data;\n    }\n\n    const group = this.getGroup(groupId);\n    if (!group) {\n      console.warn(`未找到id为${groupId}的节点组`);\n    }\n    group._isDeleting = true;\n    let insideNodes = group.nodes.map((_node) => {\n      let rmItem = this.removeNode(_node.id, true, true);\n      let rmNode = rmItem.nodes[0];\n      let neighborEdges = rmItem.edges;\n      rmNode._init({\n        top: _node.top + group.top,\n        left: _node.left + group.left,\n        dom: _node.dom,\n        _isDeleteGroup: true\n      });\n      this.addNode(rmNode, true);\n      neighborEdges.forEach((item) => {\n        item.redraw();\n      });\n      return rmNode;\n    });\n    // 删除邻近的线条\n    const neighborEdges = this.getNeighborEdges(group.id, 'group');\n    this.removeEdges(neighborEdges, isNotEventEmit);\n    // 删除group\n    const index = _.findIndex(this.groups, _group => _group.id === groupId);\n    this.groups.splice(index, 1)[0];\n    group.destroy(isNotEventEmit);\n\n    if (isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:removeGroup',\n        data: {\n          group: group,\n          nodes: insideNodes\n        }\n      });\n    }\n    return group;\n  }\n\n  removeGroups(groups, isNotEventEmit) {\n    let groupIds = [];\n    groupIds = groups.map((item) => {\n      if (item instanceof Group) {\n        return item.id\n      } else {\n        return item;\n      }\n    });\n\n    let rmGroups = groupIds.map((item) => {\n      return this.removeGroup(item, isNotEventEmit);\n    });\n\n    return {\n      groups: rmGroups\n    }\n  }\n\n  getNeighborEdges(id, type) {\n\n    let node = undefined;\n    let group = undefined;\n    if (type === 'node') {\n      node = _.find(this.nodes, item => id === item.id);\n    } else if (type === 'group') {\n      group = _.find(this.groups, item => id === item.id);\n    } else {\n      node = _.find(this.nodes, item => id === item.id);\n      node && !type && (type = 'node');\n      group = _.find(this.groups, item => id === item.id);\n      group && !type && (type = 'group');\n    }\n\n    return this.edges.filter((item) => {\n      if (type === 'node') {\n        return _.get(item, 'sourceNode.id') === node.id || _.get(item, 'targetNode.id') === node.id;\n      } else {\n        return _.get(item, 'sourceNode.id') === group.id || _.get(item, 'targetNode.id') === group.id;\n      }\n    });\n  }\n\n  getNeighborEdgesByEndpoint(id, pointId) {\n    let edges = this.getNeighborEdges(id);\n    return edges.filter((item) => {\n      if (item.type === 'node') {\n        return false;\n      } else {\n        return (\n          (item.sourceNode.id === id && item.sourceEndpoint.id === pointId) || \n          (item.targetNode.id === id && item.targetEndpoint.id === pointId)\n        );\n      }\n    });\n  }\n\n  getNeighborNodes(nodeId) {\n    const result = [];\n    const node = _.find(this.nodes, item => nodeId === item.id);\n    if (!node) {\n      console.warn(`找不到id为${nodeId}的节点`);\n    }\n    this.edges.forEach((item) => {\n      if (item.sourceNode && item.sourceNode.id === nodeId) {\n        result.push(item.targetNode.id);\n      } else if (item.targetNode && item.targetNode.id === nodeId) {\n        result.push(item.sourceNode.id);\n      }\n    });\n\n    return result.map(id => this.getNode(id));\n  }\n\n  /**\n   * 查找 N 层节点\n   * \n   * @param {Object} options \n   * @param {Node} options.node\n   * @param {Endpoint} options.endpoint\n   * @param {String} options.type\n   * @param {Number} options.level\n   * @param {Function} options.iteratee\n   * @returns {Object} filteredGraph\n   */\n  getNeighborNodesAndEdgesByLevel({node, endpoint, type = 'out', level = Infinity, iteratee = () => true}) {\n    // 先求source-target level 层\n    if (!node || !this.nodes.length) return {nodes: [], edges: []};\n    if (level == 0 || !this.edges.length) return {nodes: [node], edges: []};\n    let quene = [];\n    let neighbors = [];\n    const visited = new Set();\n\n    // 1. 生成邻接表\n    // adjTable = {[nodeId]: {[endpointId]: [[targetNode, targetEndpoint]]}}\n    const adjTable = this.getAdjcentTable(type);\n\n    if (endpoint) {\n      quene = _.get(adjTable, [node.id, endpoint.id], []).map(d => [...d, 1]);\n    } else {\n      quene = (Object.values(_.get(adjTable, node.id, {})) || []).flatMap(d => d.map(n => n.concat(1)));\n    }\n\n    visited.add(node.id);\n\n    if (!quene.length) return {nodes: [node], edges: []};\n    // 2. BFS,得到 nodes 集合\n    while (quene.length) {\n      const [$node, $endpoint, $level] = quene.shift();\n      if (\n        visited.has($node.id) ||\n        $level > level ||\n        !iteratee($node, $endpoint, $level)\n      ) continue;\n\n      // TODO: 锚点向后传递？节点向后传递？\n      neighbors = (Object.values(_.get(adjTable, $node.id, {})) || []).forEach((neighborsWithEndpoint) => {\n        neighborsWithEndpoint.forEach(neighbor => {\n          const [$nNode, $nEndpoint] = neighbor;\n          if (visited.has($nNode.id)) return;\n          quene.push([...neighbor, $level + 1]);\n        });\n      });\n      visited.add($node.id);\n    }\n    const nodes = new Set();\n    const edges = new Set();\n    // 4. 获取 edges，1. 只考虑点集 2. 考虑边\n    // 目前只考虑点集内的全部边\n    this.edges.forEach(edge => {\n      const {sourceNode, sourceEndpoint, targetNode, targetEndpoint} = edge;\n      if (visited.has(sourceNode.id) && visited.has(targetNode.id)) {\n        nodes.add(sourceNode);\n        nodes.add(targetNode);\n        edges.add(edge);\n      }\n    });\n\n    return {\n      nodes: [...nodes],\n      edges: [...edges]\n    }\n  }\n\n  getAdjcentTable(type) {\n    // 包含正逆的邻接表\n    // {[nodeId]: {[endpointId]: [[targetNode, targetEndpoint]]}}\n    const adjTable = {};\n    this.edges.forEach(edge => {\n      const {sourceNode, sourceEndpoint, targetNode, targetEndpoint} = edge;\n      const sourceNodeId = sourceNode.id;\n      const sourceEndpointId = sourceEndpoint.id;\n      const targetNodeId = targetNode.id;\n      const targetEndpointId = targetEndpoint.id;\n      // in and all\n      if (type !== 'out') {\n        if (!adjTable[targetNodeId]) adjTable[targetNodeId] = {};\n        if (!adjTable[targetNodeId][targetEndpointId]) adjTable[targetNodeId][targetEndpointId] = [];\n\n        adjTable[targetNodeId][targetEndpointId].push([sourceNode, sourceEndpoint]);\n      }\n      // out and all\n      if (type !== 'in') {\n        if (!adjTable[sourceNodeId]) adjTable[sourceNodeId] = {};\n        if (!adjTable[sourceNodeId][sourceEndpointId]) adjTable[sourceNodeId][sourceEndpointId] = [];\n\n        adjTable[sourceNodeId][sourceEndpointId].push([targetNode, targetEndpoint]);\n      }\n\n    });\n    this.nodes.forEach(node => {\n      if (!adjTable[node.id]) adjTable[node.id] = {};\n    });\n    return adjTable;\n  }\n\n  setZoomable(flat, zoomDirection = this._zoomDirection) {\n    if (zoomDirection !== undefined) {\n      this._zoomDirection = zoomDirection;\n    }\n    if (!this._zoomCb) {\n      this._zoomCb = (event) => {\n        event.preventDefault();\n        const deltaY = event.deltaY;\n        if (this._zoomDirection) {\n          this._zoomData -= deltaY * this.theme.zoomGap;\n        } else {\n          this._zoomData += deltaY * this.theme.zoomGap;\n        }\n\n        if (this._zoomData < 0.25) {\n          this._zoomData = 0.25;\n          return;\n        } if (this._zoomData > 5) {\n          this._zoomData = 5;\n          return;\n        }\n\n        const platform = ['webkit', 'moz', 'ms', 'o'];\n        const scale = `scale(${this._zoomData})`;\n        for (let i = 0; i < platform.length; i++) {\n          this.wrapper.style[`${platform[i]}Transform`] = scale;\n        }\n        this.wrapper.style.transform = scale;\n        this._coordinateService._changeCanvasInfo({\n          wrapper: this.wrapper,\n          girdWrapper: this._guidelineService.dom,\n          mouseX: event.clientX,\n          mouseY: event.clientY,\n          scale: this._zoomData\n        });\n        this._guidelineService.zoom(this._zoomData);\n        this.emit('system.canvas.zoom', {\n          zoom: this._zoomData\n        });\n        this.emit('events', {\n          type: 'canvas.zoom',\n          zoom: this._zoomData\n        });\n      };\n    }\n\n    if (flat) {\n      // 双指Mac下缩放正常，Window鼠标滑轮方向相反\n      this.root.addEventListener('wheel', this._zoomCb);\n    } else {\n      this.root.removeEventListener('wheel', this._zoomCb);\n    }\n  }\n\n  setMoveable(flat) {\n    if (flat) {\n      this.moveable = true;\n      if (this._dragType === 'canvas:drag') {\n        this.moveable = false;\n      }\n    } else {\n      this.moveable = false;\n    }\n  }\n\n  setLinkable(flat) {\n    this.linkable = !!flat;\n  }\n\n  setDisLinkable(flat) {\n    this.disLinkable = !!flat;\n  }\n\n  setDraggable(flat) {\n    this.nodes.forEach((node) => {\n      node.setDraggable(flat);\n    });\n    this.draggable = flat;\n  }\n\n  focusNodesWithAnimate(param, type = ['node'], options, callback) {\n    // 画布里的可视区域\n    let canLeft = Infinity;\n    let canRight = -Infinity;\n    let canTop = Infinity;\n    let canBottom = -Infinity;\n    if (_.includes(type, 'node')) {\n      let nodeIds = param.nodes;\n      this.nodes.filter((_node) => {\n        return _.find(nodeIds, (id) => {\n          return _node.id === id;\n        }) !== undefined;\n      }).forEach((_node) => {\n        let _nodeLeft = _node.left;\n        let _nodeRight = _node.left + _node.getWidth();\n        let _nodeTop = _node.top;\n        let _nodeBottom = _node.top + _node.getHeight();\n        if (_node.group) {\n          let group = this.getGroup(_node.group);\n          if (group) {\n            _nodeLeft += group.left;\n            _nodeRight += group.left;\n            _nodeTop += group.top;\n            _nodeBottom += group.top;\n          }\n        }\n        if (_nodeLeft < canLeft) {\n          canLeft = _nodeLeft;\n        }\n        if (_nodeRight > canRight) {\n          canRight = _nodeRight;\n        }\n        if (_nodeTop < canTop) {\n          canTop = _nodeTop;\n        }\n        if (_nodeBottom > canBottom) {\n          canBottom = _nodeBottom;\n        }\n      });\n    }\n\n    if (_.includes(type, 'group')) {\n      let groupIds = param.groups;\n      this.groups.filter((_group) => {\n        return _.find(groupIds, (id) => {\n          return id === _group.id;\n        });\n      }).forEach((_group) => {\n        let _groupLeft = _group.left;\n        let _groupRight = _group.left + _group.getWidth();\n        let _groupTop = _group.top;\n        let _groupBottom = _group.top + _group.getHeight();\n        if (_groupLeft < canLeft) {\n          canLeft = _groupLeft;\n        }\n        if (_groupRight > canRight) {\n          canRight = _groupRight;\n        }\n        if (_groupTop < canTop) {\n          canTop = _groupTop;\n        }\n        if (_groupBottom > canBottom) {\n          canBottom = _groupBottom;\n        }\n      });\n    }\n    let customOffset = _.get(options, 'offset') || [0, 0];\n    let canDisX = canRight - canLeft;\n    let terDisX = this._rootWidth - customOffset[0];\n    let canDisY = canBottom - canTop;\n    let terDisY = this._rootHeight - customOffset[1];\n    let scaleX = terDisX / canDisX;\n    let scaleY = terDisY / canDisY;\n    // 这里要根据scale来判断\n    let scale = scaleX < scaleY ? scaleX : scaleY;\n    if (_.get(options, 'keepPreZoom')) {\n      scale = this._zoomData < scale ? this._zoomData : scale;\n    } else {\n      scale = 1 < scale ? 1 : scale;\n    }\n    let terLeft = this._coordinateService._canvas2terminal('x', canLeft, {\n      scale: scale,\n      canOffsetX: 0,\n      canOffsetY: 0,\n      terOffsetX: 0,\n      terOffsetY: 0,\n      originX: 50,\n      originY: 50\n    });\n    let terRight = this._coordinateService._canvas2terminal('x', canRight, {\n      scale: scale,\n      canOffsetX: 0,\n      canOffsetY: 0,\n      terOffsetX: 0,\n      terOffsetY: 0,\n      originX: 50,\n      originY: 50\n    });\n    let terTop = this._coordinateService._canvas2terminal('y', canTop, {\n      scale: scale,\n      canOffsetX: 0,\n      canOffsetY: 0,\n      terOffsetX: 0,\n      terOffsetY: 0,\n      originX: 50,\n      originY: 50\n    });\n    let terBottom = this._coordinateService._canvas2terminal('y', canBottom, {\n      scale: scale,\n      canOffsetX: 0,\n      canOffsetY: 0,\n      terOffsetX: 0,\n      terOffsetY: 0,\n      originX: 50,\n      originY: 50\n    });\n\n    let offsetX = (terLeft + terRight - this._rootWidth) / 2;\n    let offsetY = (terTop + terBottom - this._rootHeight) / 2;\n\n    offsetX = -offsetX + customOffset[0];\n    offsetY = -offsetY + customOffset[1];\n\n    const time = 500;\n    $(this.wrapper).animate({\n      top: offsetY,\n      left: offsetX,\n    }, time);\n    this._moveData = [offsetX, offsetY];\n\n    this._coordinateService._changeCanvasInfo({\n      canOffsetX: offsetX,\n      canOffsetY: offsetY,\n      scale: scale,\n      originX: 50,\n      originY: 50\n    });\n\n    this.zoom(scale, callback);\n  }\n  focusCenterWithAnimate(options, callback) {\n    let nodeIds = this.nodes.map((item) => {\n      return item.id;\n    });\n    let groupIds = this.groups.map((item) => {\n      return item.id;\n    });\n\n    this.focusNodesWithAnimate({\n      nodes: nodeIds,\n      groups: groupIds\n    }, ['node', 'group'], options, callback);\n  }\n  focusNodeWithAnimate(param, type = 'node', options, callback) {\n    let node = null;\n\n    if (_.isFunction(param)) { // 假如传入的是filter，则按照用户自定义的规则来寻找\n      node = type === 'node' ? _.find(this.nodes, param) : _.find(this.groups, param);\n    } else { // 假如传入的是id，则按照默认规则寻找\n      node = type === 'node' ? _.find(this.nodes, item => item.id === param) : _.find(this.groups, item => item.id === param);\n    }\n\n    let top = 0;\n    let left = 0;\n    if (!node) {\n      return;\n    }\n    top = node.top || node.y;\n    left = node.left || node.x;\n    if (node.height) {\n      top += node.height / 2;\n    }\n    if (node.width) {\n      left += node.width / 2;\n    }\n\n    if (node.group) {\n      const group = _.find(this.groups, _group => _group.id === node.group);\n      if (!group) return;\n      top += group.top || group.y;\n      left += group.left || group.x;\n      if (group.height) {\n        top += group.height / 2;\n      }\n      if (group.width) {\n        left += group.width / 2;\n      }\n    }\n\n    let customOffset = _.get(options, 'offset') || [0, 0];\n\n    const containerW = this._rootWidth;\n    const containerH = this._rootHeight;\n\n    const targetY = containerH / 2 - top + customOffset[1];\n    const targetX = containerW / 2 - left + customOffset[0];\n\n    const time = 500;\n\n    // animate不支持scale，使用setInterval自己实现\n    $(this.wrapper).animate({\n      top: targetY,\n      left: targetX,\n    }, time);\n    this._moveData = [targetX, targetY];\n\n    this._coordinateService._changeCanvasInfo({\n      canOffsetX: targetX,\n      canOffsetY: targetY,\n      originX: 50,\n      originY: 50,\n      scale: 1\n    });\n\n    this.zoom(1, callback);\n\n    this._guidelineService.isActive && this._guidelineService.clearCanvas();\n  }\n\n  zoom(param, callback) {\n    if (param < 0.25) {\n      param = 0.25;\n    } if (param > 5) {\n      param = 5;\n    }\n    const time = 50;\n    let frame = 1;\n    const gap = param - this._zoomData;\n    const interval = gap / 20;\n    clearInterval(this._zoomTimer);\n    this._zoomTimer = null;\n    if (gap !== 0) {\n      this._zoomTimer = setInterval(() => {\n        this._zoomData += interval;\n        let _canvasInfo = {\n          scale: this._zoomData\n        };\n        if (this._coordinateService.originX === undefined || this._coordinateService.originY === undefined) {\n          _canvasInfo['originX'] = 50;\n          _canvasInfo['originY'] = 50;\n        }\n        this._coordinateService._changeCanvasInfo(_canvasInfo);\n        this._guidelineService.zoom(this._zoomData);\n        $(this.wrapper).css({\n          transform: `scale(${this._zoomData})`\n        });\n        if (frame === 20) {\n          clearInterval(this._zoomTimer);\n          this.emit('system.canvas.zoom', {\n            zoom: this._zoomData\n          });\n          this.emit('events', {\n            type: 'canvas.zoom',\n            zoom: this._zoomData\n          });\n          callback && callback();\n        }\n        frame++;\n      }, time / 20);\n    } else {\n      callback && callback();\n    }\n  }\n\n  setOrigin(data) {\n    let originX = (data[0] || '0').toString().replace('%', '');\n    let originY = (data[1] || '0').toString().replace('%', '');\n    this._coordinateService._changeCanvasInfo({\n      originX: parseFloat(originX),\n      originY: parseFloat(originY)\n    });\n  }\n\n  move(position) {\n    $(this.wrapper)\n      .css('left', position[0])\n      .css('top', position[1]);\n    this._coordinateService._changeCanvasInfo({\n      canOffsetX: position[0],\n      canOffsetY: position[1]\n    });\n    this._guidelineService.isActive && this._guidelineService.move(position[0], position[1]);\n    this._moveData = position;\n    this.emit('system.canvas.move');\n    this.emit('events', {type: 'system.canvas.move'});\n  }\n\n  getZoom() {\n    return this._zoomData;\n  }\n\n  getOffset() {\n    return this._moveData;\n  }\n\n  getOrigin() {\n    return [this._coordinateService.originX + '%', this._coordinateService.originY + '%']\n  }\n\n  getDataMap() {\n    return {\n      nodes: this.nodes,\n      edges: this.edges,\n      groups: this.groups\n    };\n  }\n\n  setSelectMode(flat = true, contents = ['node'], selecMode = 'include') {\n    if (flat) {\n      this.isSelectMode = true;\n      this._rmSystemUnion();\n      this.selecContents = contents;\n      this.selecMode = selecMode;\n      this.canvasWrapper.active();\n      this._remarkMove = this.moveable;\n      this._remarkZoom = this.zoomable;\n      this.setZoomable(false);\n      this.setMoveable(false);\n    } else {\n      this.isSelectMode = false;\n      this.canvasWrapper.unActive();\n      if (this._remarkMove) {\n        this.setMoveable(true);\n      }\n      if (this._remarkZoom) {\n        this.setZoomable(true);\n      }\n    }\n  }\n\n  setGirdMode(flat = true, options = this._bgObj, _isResize) {\n    if (flat) {\n      this._bgObjQueue.push(options);\n      if (this._bgTimer) {\n        return;\n      }\n      this._bgTimer = setInterval(() => {\n        if (this._bgObjQueue.length === 0) {\n          clearInterval(this._bgTimer);\n          this._bgTimer = null;\n          return;\n        }\n        this._bgObj = this._bgObjQueue.pop();\n        _isResize && this._gridService._resize();\n        this._gridService.create(this._bgObj);\n        this._bgObjQueue = [];\n      }, 1000);\n    } else {\n      this._gridService.destroy();\n      this._bgObjQueue = [];\n    }\n  }\n\n  setGuideLine(flat = true, options = this._bgObj) {\n    if (flat) {\n      this._bgObjQueue.push(options);\n      if (this._bgTimer) {\n        return;\n      }\n      this._bgTimer = setInterval(() => {\n        if (this._bgObjQueue.length === 0) {\n          clearInterval(this._bgTimer);\n          this._bgTimer = null;\n          return;\n        }\n        this._bgObj = this._bgObjQueue.pop();\n        this._guidelineService.create(this._bgObj);\n        this._bgObjQueue = [];\n      }, 200);\n    } else {\n      this._guidelineService.destroy();\n      this._bgObjQueue = [];\n    }\n  }\n\n  setMinimap(flat = true, options = {}) {\n    if (!options.events) {\n      options.events = [];\n    }\n\n    const updateEvts = [\n      'system.canvas.zoom',\n      'system.node.delete',\n      'system.node.move',\n      'system.nodes.add',\n      'system.group.delete',\n      'system.group.move',\n      'system.drag.move',\n      'system.canvas.move',\n      ...options.events\n    ];\n\n    const getNodes = () => {\n      return this.nodes.map(node => {\n        return {\n          id: node.id,\n          left: node.left,\n          top: node.top,\n          width: node.getWidth(),\n          height: node.getHeight(),\n          group: node.group,\n          minimapActive: _.get(node, 'options.minimapActive')\n        }\n      });\n    }\n\n    const getGroups = () => {\n      return this.groups.map(group => {\n        return {\n          id: group.id,\n          left: group.left,\n          top: group.top,\n          width: group.getWidth(),\n          height: group.getHeight(),\n          minimapActive: _.get(group, 'options.minimapActive')\n        }\n      });\n    }\n\n    if (flat && !this.minimap) {\n      this.minimap = new Minimap({\n        root: this.root,\n        move: this.move.bind(this),\n        terminal2canvas: this.terminal2canvas.bind(this),\n        canvas2terminal: this.canvas2terminal.bind(this),\n        nodes: getNodes(),\n        groups: getGroups(),\n        zoom: this.getZoom(),\n        offset: this.getOffset(),\n        ...options\n      });\n\n      this.updateFn = () => {\n        this.minimap.update({\n          nodes: getNodes(),\n          groups: getGroups(),\n          zoom: this.getZoom(),\n          offset: this.getOffset()\n        });\n      };\n\n      for (let ev of updateEvts) {\n        this.on(ev, this.updateFn);\n      }\n\n      return;\n    }\n\n    if (!this.minimap) {\n      return;\n    }\n\n    this.minimap.destroy();\n    for (let ev of updateEvts) {\n      this.off(ev, this.updateFn);\n    }\n\n    delete this.minimap;\n    delete this.updateFn;\n  }\n\n  getUnion(name) {\n    if (!name) {\n      console.error('传入正确的name');\n      return;\n    }\n    return this._unionData[name];\n  }\n\n  getAllUnion() {\n    return this._unionData;\n  }\n\n  add2Union(name, obj) {\n    if (!name || !obj) {\n      return;\n    }\n\n    if (!this._unionData[name]) {\n      this._unionData[name] = {\n        nodes: [],\n        groups: [],\n        edges: [],\n        endpoints: []\n      }\n    }\n\n    let _data = this._unionData[name];\n    if (obj.nodes) {\n      obj.nodes.forEach((item) => {\n        let isId = _.isString(item);\n        let node = isId ? this.getNode(item) : item;\n        _data.nodes.push(node);\n      });\n      _data.nodes = _.uniqBy(_data.nodes, 'id');\n    }\n\n    if (obj.groups) {\n      obj.groups.forEach((item) => {\n        let isId = _.isString(item);\n        let group = isId ? this.getGroup(item) : item;\n        _data.groups.push(group);\n      });\n      _data.groups = _.uniqBy(_data.groups, 'id');\n    }\n\n    if (obj.edges) {\n      obj.edges.forEach((item) => {\n        let isId = _.isString(item);\n        let edge = isId ? this.getEdge(item) : item;\n        _data.edges.push(edge);\n      });\n      _data.edges = _.uniqBy(_data.edges, 'id');\n    }\n\n    if (obj.endpoints) {\n      _data.endpoints = _data.endpoints.concat(obj.endpoints);\n    }\n  }\n\n  removeUnion(name) {\n    this._unionData[name] = {\n      nodes: [],\n      edges: [],\n      groups: [],\n      endpoints: []\n    };\n  }\n\n  removeAllUnion() {\n    this._unionData = {\n      __system: {\n        nodes: [],\n        edges: [],\n        groups: [],\n        endpoints: []\n      }\n    };\n  }\n\n  _rmSystemUnion() {\n    this._unionData['__system'].nodes = [];\n    this._unionData['__system'].edges = [];\n    this._unionData['__system'].groups = [];\n    this._unionData['__system'].endpoints = [];\n  }\n\n  _findUnion(type, item) {\n    let result = [];\n    for (let key in this._unionData) {\n      let isExist = _.find(_.get(this._unionData, [key, type], []), (_item) => {\n        return _.toString(_item.id) === _.toString(item.id);\n      });\n      if (isExist) {\n        result.push(key);\n      }\n    }\n    return result;\n  }\n\n  canvas2terminal(coordinates, options) {\n    return this._coordinateService.canvas2terminal(coordinates, options);\n  }\n  terminal2canvas(coordinates, options) {\n    return this._coordinateService.terminal2canvas(coordinates, options);\n  }\n\n  save2img(options) {\n    let method = 'toPng';\n\n    switch (options.type) {\n      case 'jpeg':\n      case '.jpeg':\n        method = 'toJpeg';\n        break;\n      case 'png':\n      case '.png':\n        method = 'toPng';\n        break;\n      case 'svg':\n      case '.svg':\n        method = 'toSvg';\n        break;\n    }\n\n    return domtoimage[method](this.root, options)\n      .then(function (dataUrl) {\n        return dataUrl;\n      })\n      .catch(function (error) {\n        console.error('oops, something went wrong!', error);\n      });\n  }\n\n  justifyCoordinate() {\n    this._gridService.justifyAllCoordinate();\n  }\n\n  _genSvgWrapper() {\n\n    function _detectMob() {\n      const toMatch = [\n          /Android/i,\n          /webOS/i,\n          /iPhone/i,\n          /iPad/i,\n          /iPod/i,\n          /BlackBerry/i,\n          /Windows Phone/i\n      ];\n      return toMatch.some((toMatchItem) => {\n          return window.navigator.userAgent.match(toMatchItem);\n      });\n    }\n    let _isMobi = _detectMob();\n    let _SVGWidth = '100%';\n    let _SVGHeight = '100%';\n    \n    let _detectZoom = () => {\n      let ratio = 0;\n      let screen = window.screen;\n      let ua = window.navigator.userAgent.toLowerCase();\n\n      if (window.devicePixelRatio !== undefined) {\n        ratio = window.devicePixelRatio;\n      }\n      else if (~ua.indexOf('msie')) {\n        if (screen.deviceXDPI && screen.logicalXDPI) {\n          ratio = screen.deviceXDPI / screen.logicalXDPI;\n        }\n      }\n      else if (window.outerWidth !== undefined && window.innerWidth !== undefined) {\n        ratio = window.outerWidth / window.innerWidth;\n      }\n\n      if (ratio) {\n        ratio = Math.round(ratio * 100);\n      }\n      return ratio;\n    };\n\n    // hack 适配浏览器的缩放比例\n    if (!_isMobi) {\n      let _sclae = 1 / (_detectZoom() / 200);\n      _SVGWidth = (1 * _sclae) + 'px';\n      _SVGHeight = (1 * _sclae) + 'px';\n    }\n\n    // 生成svg的wrapper\n    const svg = $(document.createElementNS('http://www.w3.org/2000/svg', 'svg'))\n      .attr('class', 'butterfly-svg')\n      .attr('width', _SVGWidth)\n      .attr('height', _SVGHeight)\n      .attr('version', '1.1')\n      .attr('xmlns', 'http://www.w3.org/2000/svg')\n      .appendTo(this.wrapper);\n\n    if(!_isMobi) {\n      // hack 监听浏览器的缩放比例并适配\n      window.onresize = () => {\n        let _sclae = 1 / (_detectZoom() / 200);\n        svg.attr('width', (1 * _sclae) + 'px').attr('height', (1 * _sclae) + 'px');\n      }\n\n      // hack 因为width和height为1的时候会有偏移\n      let wrapperOffset = $(this.wrapper)[0].getBoundingClientRect();\n      let svgOffset = svg[0].getBoundingClientRect();\n      svg.css('top', (wrapperOffset.top - svgOffset.top) + 'px').css('left', (wrapperOffset.left - svgOffset.left) + 'px');\n    }\n\n    return this.svg = svg;\n  }\n\n  _genWrapper() {\n    // 生成wrapper\n    const wrapper = $('<div class=\"butterfly-wrapper\"></div>')\n      .appendTo(this.root);\n    return this.wrapper = wrapper[0];\n  }\n\n  _genCanvasWrapper() {\n    // 生成canvas wrapper\n    this.canvasWrapper = new SelectCanvas();\n    this.canvasWrapper.init({\n      root: this.root,\n      _on: this.on.bind(this),\n      _emit: this.emit.bind(this)\n    });\n  }\n\n  _addEventListener() {\n    if (this.zoomable) {\n      this.setZoomable(true);\n    }\n    if (this.moveable) {\n      this.setMoveable(true);\n    }\n\n    let _isChrome = /Chrome/.test(window.navigator.userAgent) && /Google Inc/.test(window.navigator.vendor);\n    let _getChromeVersion = () => {\n      var raw = window.navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./);\n      return raw ? parseInt(raw[2], 10) : false;\n    };\n    let _isHightVerChrome = _isChrome && _getChromeVersion() >= 64;\n\n    // todo：chrome64版本ResizeObserver对象不存在，但官方文档说64支持，所以加强判断下\n    if (_isHightVerChrome && window.ResizeObserver && this.theme.autoResizeRootSize) {\n      // 监听某个dom的resize事件\n      const _resizeObserver = new ResizeObserver(entries => {\n        this._rootWidth = $(this.root).width();\n        this._rootHeight = $(this.root).height();\n        this._coordinateService._changeCanvasInfo({\n          terOffsetX: $(this.root).offset().left,\n          terOffsetY: $(this.root).offset().top,\n          terWidth: $(this.root).width(),\n          terHeight: $(this.root).height()\n        });\n        this.canvasWrapper.resize({root: this.root});\n        this.setGirdMode(true, undefined , true);\n      });\n      _resizeObserver.observe(this.root);\n    } else {\n      //  降级处理，监控窗口的resize事件\n      window.addEventListener('resize', () => {\n        this._rootWidth = $(this.root).width();\n        this._rootHeight = $(this.root).height();\n        this._coordinateService._changeCanvasInfo({\n          terOffsetX: $(this.root).offset().left,\n          terOffsetY: $(this.root).offset().top,\n          terWidth: $(this.root).width(),\n          terHeight: $(this.root).height()\n        });\n        this.canvasWrapper.resize({root: this.root});\n        this.setGirdMode(true, undefined, true);\n      })\n    }\n\n    // 绑定一大堆事件，group:addMember，groupDragStop，group:removeMember，beforeDetach，connection，\n    this.on('InnerEvents', (data) => {\n      if (data.type === 'node:addEndpoint') {\n        this._addEndpoint(data.data, 'node', data.isInited);\n      } else if (data.type === 'node:removeEndpoint') {\n        let _point = data.data;\n        let rmEdges = this.edges.filter((item) => {\n          return (item.sourceNode.id === _point.nodeId && item.sourceEndpoint.id === _point.id) ||\n                 (item.targetNode.id === _point.nodeId && item.targetEndpoint.id === _point.id);\n        });\n        this.removeEdges(rmEdges);\n      } else if (data.type === 'group:addEndpoint') {\n        this._addEndpoint(data.data, 'group', data.isInited);\n      } else if (data.type === 'node:dragBegin') {\n        this._dragType = 'node:drag';\n        this._dragNode = data.data;\n      } else if (data.type === 'node:mouseDown') {\n        this._dragType = 'node:mouseDown';\n      } else if (data.type === 'group:dragBegin') {\n        this._dragType = 'group:drag';\n        this._dragNode = data.data;\n      } else if (data.type === 'endpoint:drag') {\n        this._dragType = 'endpoint:drag';\n        this._dragEndpoint = data.data;\n      } else if (data.type === 'node:move') {\n        this._moveNode(data.node, data.x, data.y, data.isNotEventEmit);\n      } else if (data.type === 'group:move') {\n        this._moveGroup(data.group, data.x, data.y, data.isNotEventEmit);\n      } else if (data.type === 'link:click') {\n        this._dragType = 'link:click';\n      } else if (data.type === 'multiple:select') {\n        const result = this._selectMultiplyItem(data.range, data.toDirection);\n        // 把框选的加到union的数组\n        _.assign(this._unionData['__system'], this.selectItem);\n\n        this.emit('system.multiple.select', {\n          data: result\n        });\n        this.emit('events', {\n          type: 'multiple:select',\n          data: result\n        });\n\n        this.selectItem = {\n          nodes: [],\n          edges: [],\n          endpoints: []\n        };\n      } else if (data.type === 'group:resize') {\n        this._dragType = 'group:resize';\n        this._dragGroup = data.group;\n      } else if (data.type === 'node:delete') {\n        this.removeNode(data.data.id);\n      } else if (data.type === 'edge:delete') {\n        this.removeEdge(data.data);\n      } else if (data.type === 'group:delete') {\n        this.removeGroup(data.data.id);\n      } else if (data.type === 'group:addNodes') {\n        _.get(data, 'nodes', []).forEach((item) => {\n          let _hasNode = _.find(this.nodes, (_node) => {\n            return item.id === _node.id;\n          });\n          if (!_hasNode) {\n            this.addNode(item);\n          } else {\n            let neighborEdges = [];\n            let rmItem = this.removeNode(item.id, true, true);\n            let rmNode = rmItem.nodes[0];\n            let _group = data.group;\n            neighborEdges = rmItem.edges;\n            rmNode._init({\n              top: item.top - _group.top,\n              left: item.left - _group.left,\n              dom: rmNode.dom,\n              group: _group.id\n            });\n            this.addNode(rmNode, true);\n          }\n        });\n        if (!data.isNotEventEmit) {\n          this.emit('events', {\n            type: 'system.group.addMembers',\n            nodes: data.nodes,\n            group: data.group\n          });\n          this.emit('system.group.addMembers', {\n            nodes: data.nodes,\n            group: data.group\n          });\n        }\n      } else if (data.type === 'group:removeNodes') {\n        let _group = data.group;\n        _.get(data, 'nodes', []).forEach((item) => {\n          this.removeNode(item.id, true, true);\n          item._init({\n            group: undefined,\n            left: item.left + _group.left,\n            top: item.top + _group.top,\n            dom: item.dom,\n            _isDeleteGroup: true\n          });\n          this.addNode(item, true);\n        });\n      } else if (data.type === 'edge:updateLabel') {\n        let labelDom = data.data.labelDom;\n        $(this.wrapper).append(labelDom);\n      } else if (data.type === 'edge:setZIndex') {\n        this.setEdgeZIndex([data.edge], data.index);\n      }\n    });\n\n    // 绑定拖动事件\n    this._attachMouseDownEvent();\n  }\n\n  _isExistNode(node) {\n    const hasNodes = this.nodes.filter(item => item.id === node.id);\n    return hasNodes.length > 0;\n  }\n\n  _isExistGroup(group) {\n    const hasGroups = this.groups.filter(item => item.id === group.id);\n    return hasGroups.length > 0;\n  }\n\n  _addEndpoint(endpoint, type, isInited) {\n    let initOtps = {\n      nodeType: type,\n      _coordinateService: this._coordinateService\n    };\n    endpoint._init(initOtps);\n\n    // 非自定义dom，自定义dom不需要定位\n    if (!endpoint._isInitedDom) {\n      const endpointDom = endpoint.dom;\n      if (_.get(endpoint, '_node.group')) {\n        const group = this.getGroup(endpoint._node.group);\n        $(group.dom).append(endpointDom);\n      } else {\n        $(this.wrapper).prepend(endpointDom);\n      }\n      endpoint.updatePos();\n    }\n    endpoint.mounted && endpoint.mounted();\n  }\n  // 拖动节点判断是否在节点组内\n  _findGroupByCoordinates(node, lx, ty, rx, by) {\n    for (let i = 0; i < this.groups.length; i++) {\n      const _group = this.groups[i];\n      const _groupLeft = _group.left;\n      const _groupRight = _group.left + _group.getWidth();\n      const _groupTop = _group.top;\n      const _groupBottom = _group.top + _group.getHeight();\n      let isInGroup = false;\n      if (rx !== undefined && by !== undefined) {\n        isInGroup = _groupLeft <= lx && _groupRight >= rx && _groupTop <= ty && _groupBottom >= by;\n      } else {\n        isInGroup = lx >= _groupLeft && lx <= _groupRight && ty >= _groupTop && ty <= _groupBottom;\n      }\n      if (isInGroup && _group.id !== node.group) {\n        return _group;\n      }\n    }\n  }\n  // 拖动节点移动节点组高亮, 节流500ms检测一次\n  _hoverGroup(node) {\n    this._hoverGroupQueue.push(node);\n    if (!this._hoverGroupTimer) {\n      this._hoverGroupTimer = setInterval(() => {\n        if (this._hoverGroupQueue.length === 0) {\n          clearInterval(this._hoverGroupTimer);\n          this._hoverGroupTimer = undefined;\n          return;\n        }\n        let targetNode = this._hoverGroupQueue.pop();\n        let targetGroup = this._findGroupByCoordinates(targetNode, targetNode.left, targetNode.top);\n        if (targetGroup && targetGroup.scope && targetGroup.scope !== targetNode.scope) {\n          return;\n        }\n        if (targetGroup) {\n          if (!this._hoverGroupObj || targetGroup.id !== this._hoverGroupObj.id) {\n            this._hoverGroupObj && $(this._hoverGroupObj.dom).removeClass('butterfly-group-hover');\n            $(targetGroup.dom).addClass('butterfly-group-hover');\n            this._hoverGroupObj = targetGroup;\n          }\n        } else {\n          this._hoverGroupObj && $(this._hoverGroupObj.dom).removeClass('butterfly-group-hover');\n          this._hoverGroupObj = undefined;\n        }\n        this._hoverGroupQueue = [];\n      }, 200);\n    }\n  }\n  _clearHoverGroup(group) {\n    this._hoverGroupObj && $(this._hoverGroupObj.dom).removeClass('butterfly-group-hover');\n    this._hoverGroupTimer = undefined;\n    this._hoverGroupObj = undefined;\n    this._hoverGroupQueue = [];\n  }\n  _attachMouseDownEvent() {\n    let canvasOriginPos = {\n      x: 0,\n      y: 0\n    };\n    let nodeOriginPos = {\n      x: 0,\n      y: 0\n    };\n\n    let _isActiveEndpoint = false;\n    let _activeItems = [];\n    // 把其他可连接的point高亮\n    let _activeLinkableEndpoint = (target) => {\n      if (_isActiveEndpoint) {\n        return;\n      }\n      let _allPoints = this._getAllEndpoints();\n      _allPoints.forEach((_point) => {\n        if (target === _point || _point.type === 'source' || _point._tmpType === 'source') {\n          return;\n        }\n        if (_point.canLink && _point.canLink(target)) {\n          if (_point.linkable) {\n            _point.linkable();\n            _point._linkable = true;\n          }\n          return;\n        }\n        if (ScopeCompare(target.scope, _point.scope)) {\n          if (_point.linkable) {\n            _point.linkable();\n            _point._linkable = true;\n          }\n          _activeItems.push(_point);\n          return;\n        }\n      });\n      _isActiveEndpoint = true;\n    };\n    // 把其他可连接的point取消高亮\n    let _unActiveLinkableEndpoint = () => {\n      _isActiveEndpoint = false;\n      _activeItems.forEach((item) => {\n        item.unLinkable && item.unLinkable();\n        item.unHoverLinkable && item.unHoverLinkable();\n        item._linkable = false;\n      });\n      _activeItems = [];\n    };\n\n\n    let _oldFocusPoint = null;\n    let _isFocusing = false;\n    // 检查鼠标是否在可连的锚点上\n    let _focusLinkableEndpoint = (cx, cy) => {\n      if (!_isFocusing) {\n        // if (_focusPoint) {\n        //   _focusPoint.unHoverLinkable && _focusPoint.unHoverLinkable();\n        //   _focusPoint = null;\n        // }\n        _isFocusing = true;\n        setTimeout(() => {\n          let _points = this._getAllEndpoints();\n          let x = this._coordinateService._terminal2canvas('x', cx);\n          let y = this._coordinateService._terminal2canvas('y', cy);\n          let _focusPoint = null;\n          _points.forEach((_point) => {\n            const _maxX = _point._posLeft + _point._width + (_.get(_point, 'expandArea.right') || this.theme.endpoint.expandArea.right);\n            const _maxY = _point._posTop + _point._height + (_.get(_point, 'expandArea.bottom') || this.theme.endpoint.expandArea.bottom);\n            const _minX = _point._posLeft - (_.get(_point, 'expandArea.left') || this.theme.endpoint.expandArea.left);\n            const _minY = _point._posTop - (_.get(_point, 'expandArea.top') || this.theme.endpoint.expandArea.top);\n            if (x > _minX && x < _maxX && y > _minY && y < _maxY) {\n              _focusPoint = _point;\n            }\n          });\n          if (_focusPoint) {\n            if (_focusPoint !== _oldFocusPoint) {\n              _focusPoint.hoverLinkable && _focusPoint.hoverLinkable();\n              _oldFocusPoint = _focusPoint;\n            }\n          } else {\n            if (_oldFocusPoint) {\n              _oldFocusPoint.unHoverLinkable && _oldFocusPoint.unHoverLinkable();\n              _oldFocusPoint = null;\n            }\n          }\n          _isFocusing = false;\n        }, 100);\n      }\n    };\n\n    const _clearDraging = () => {\n      this._dragType = null;\n      this._dragNode = null;\n      this._dragEndpoint = null;\n      this._dragGroup = null;\n      this._dragEdges = [];\n      nodeOriginPos = {\n        x: 0,\n        y: 0\n      };\n      canvasOriginPos = {\n        x: 0,\n        y: 0\n      };\n      this._autoMoveDir = [];\n      this._guidelineService.isActive && this._guidelineService.clearCanvas();\n    };\n\n    const mouseDownEvent = (event) => {\n      const LEFT_BUTTON = 0;\n      if (event.button !== LEFT_BUTTON) {\n        return;\n      }\n\n      if (!this._dragType && this.moveable) {\n        this._dragType = 'canvas:drag';\n      }\n\n      // 假如点击在空白地方且在框选模式下\n      if ((event.target === this.svg[0] || event.target === this.root) && this.isSelectMode) {\n        this.canvasWrapper.active();\n        this.canvasWrapper.dom.dispatchEvent(new MouseEvent('mousedown', {\n          clientX: event.clientX,\n          clientY: event.clientY\n        }));\n        return;\n      }\n\n      canvasOriginPos = {\n        x: event.clientX,\n        y: event.clientY\n      };\n      \n      // 初始化z-index\n      if (!this._isInitEdgeZIndex) {\n        $(this.svg).css('z-index', this._dragEdgeZindex);\n        this.nodes.forEach((item) => {\n          $(item.dom).css('z-index', (this._dragNodeZIndex) * 2 - 1);\n          _.get(item, 'endpoints').forEach((point) => {\n            $(point.dom).css('z-index', this._dragNodeZIndex * 2);\n          });\n        });\n        this.edges.forEach((item) => {\n          if (item.labelDom) {\n            $(item.labelDom).css('z-index', this._dragEdgeZindex + 1);\n          }\n        });\n        this._isInitEdgeZIndex = true;\n      }\n      // 拖动的时候提高z-index\n      if (this._dragNode && this._dragNode.__type == 'node') {\n        $(this._dragNode.dom).css('z-index', (++this._dragNodeZIndex) * 2 - 1);\n        _.get(this._dragNode, 'endpoints').forEach((point) => {\n          $(point.dom).css('z-index', this._dragNodeZIndex * 2);\n        });\n      }\n      if (this._dragNode && this._dragNode.__type == 'group') {\n        $(this._dragNode.dom).css('z-index', (++this._dragGroupZIndex) * 2 - 1);\n        _.get(this._dragNode, 'endpoints').forEach((point) => {\n          $(point.dom).css('z-index', this._dragGroupZIndex * 2);\n        });\n      }\n      \n      this.emit('system.drag.start', {\n        dragType: this._dragType,\n        dragNode: this._dragNode,\n        dragEndpoint: this._dragEndpoint,\n        dragEdges: this._dragEdges,\n        dragGroup: this._dragGroup,\n        position: {\n          clientX: event.clientX,\n          clientY: event.clientY,\n          canvasX: this._coordinateService._terminal2canvas('x', event.clientX),\n          canvasY: this._coordinateService._terminal2canvas('y', event.clientY)\n        }\n      });\n      this.emit('events', {\n        type: 'drag:start',\n        dragType: this._dragType,\n        dragNode: this._dragNode,\n        dragEndpoint: this._dragEndpoint,\n        dragEdges: this._dragEdges,\n        dragGroup: this._dragGroup,\n        position: {\n          clientX: event.clientX,\n          clientY: event.clientY,\n          canvasX: this._coordinateService._terminal2canvas('x', event.clientX),\n          canvasY: this._coordinateService._terminal2canvas('y', event.clientY)\n        }\n      });\n      this._autoMoveDir = [];\n    };\n\n    const mouseMoveEvent = (event) => {\n      const LEFT_BUTTON = 0;\n      if (event.button !== LEFT_BUTTON) {\n        return;\n      }\n      if (this._dragType) {\n        const canvasX = this._coordinateService._terminal2canvas('x', event.clientX);\n        const canvasY = this._coordinateService._terminal2canvas('y', event.clientY);\n        const offsetX = event.clientX - canvasOriginPos.x;\n        const offsetY = event.clientY - canvasOriginPos.y;\n        if (this._dragType === 'canvas:drag') {\n          this.move([offsetX + this._moveData[0], offsetY + this._moveData[1]]);\n          canvasOriginPos = {\n            x: event.clientX,\n            y: event.clientY\n          };\n        } else if (this._dragType === 'node:drag') {\n          if (nodeOriginPos.x === 0 && nodeOriginPos.y === 0) {\n            nodeOriginPos = {\n              x: canvasX,\n              y: canvasY\n            };\n            return;\n          }\n          if (this._dragNode) {\n            let moveNodes = [this._dragNode];\n            const unionKeys = this._findUnion('nodes', this._dragNode);\n            if (unionKeys && unionKeys.length > 0) {\n              unionKeys.forEach((key) => {\n                moveNodes = moveNodes.concat(this._unionData[key].nodes);\n              });\n              moveNodes = _.uniqBy(moveNodes, 'id');\n            } else {\n              this._rmSystemUnion();\n            }\n            $(this.svg).css('visibility', 'hidden');\n            $(this.wrapper).css('visibility', 'hidden');\n            moveNodes.forEach((node) => {\n              this._moveNode(node, node.left + (canvasX - nodeOriginPos.x), node.top + (canvasY - nodeOriginPos.y));\n              if (this._guidelineService.isActive) {\n                this._guidelineService.draw(node, 'node');\n              }\n            });\n            $(this.svg).css('visibility', 'visible');\n            $(this.wrapper).css('visibility', 'visible');\n            nodeOriginPos = {\n              x: canvasX,\n              y: canvasY\n            };\n            this._hoverGroup(this._dragNode);\n            this.emit('system.node.move', {\n              nodes: moveNodes\n            });\n            this.emit('events', {\n              type: 'node:move',\n              nodes: moveNodes\n            });\n            this._autoMoveCanvas(event.clientX, event.clientY, {\n              type: 'node:drag',\n              nodes: moveNodes\n            }, (gap) => {\n              nodeOriginPos.x += gap[0];\n              nodeOriginPos.y += gap[1];\n            });\n          }\n        } else if (this._dragType === 'group:drag') {\n          if (nodeOriginPos.x === 0 && nodeOriginPos.y === 0) {\n            nodeOriginPos = {\n              x: canvasX,\n              y: canvasY\n            };\n            return;\n          }\n          if (this._dragNode) {\n            $(this.svg).css('visibility', 'hidden');\n            $(this.wrapper).css('visibility', 'hidden');\n            const group = this._dragNode;\n            this._moveGroup(group, group.left + (canvasX - nodeOriginPos.x), group.top + (canvasY - nodeOriginPos.y));\n            if (this._guidelineService.isActive) {\n              this._guidelineService.draw(group, 'group');\n            }\n            $(this.svg).css('visibility', 'visible');\n            $(this.wrapper).css('visibility', 'visible');\n            nodeOriginPos = {\n              x: canvasX,\n              y: canvasY\n            };\n            this.emit('system.group.move', {\n              group: group\n            });\n            this.emit('events', {\n              type: 'group:move',\n              group: group\n            });\n            this._autoMoveCanvas(event.clientX, event.clientY, {\n              type: 'group:drag',\n              group: group\n            }, (gap) => {\n              nodeOriginPos.x += gap[0];\n              nodeOriginPos.y += gap[1];\n            });\n          }\n        } else if (this._dragType === 'endpoint:drag') {\n          const endX = this._coordinateService._terminal2canvas('x', event.clientX);\n          const endY = this._coordinateService._terminal2canvas('y', event.clientY);\n\n          // 明确标记source或者是没有type且没有线连上\n          let _isSourceEndpoint = (this._dragEndpoint.type === 'source' || this._dragEndpoint.type === 'onlyConnect' || (!this._dragEndpoint.type && (!this._dragEndpoint._tmpType || this._dragEndpoint._tmpType === 'source')));\n          let _isTargetEndpoint = (this._dragEndpoint.type === 'target' || (!this._dragEndpoint.type && this._dragEndpoint._tmpType === 'target')) && this._dragEndpoint.type !== 'onlyConnect';\n\n          if (_isSourceEndpoint && this.linkable) {\n            let unionKeys = this._findUnion('endpoints', this._dragEndpoint);\n\n            let edges = [];\n            if (!this._dragEdges || this._dragEdges.length === 0) {\n              const EdgeClass = this.theme.edge.Class;\n              let endpoints = [];\n              if (unionKeys && unionKeys.length > 0) {\n                unionKeys.forEach((key) => {\n                  endpoints = endpoints.concat(this._unionData[key].endpoints);\n                });\n                endpoints = _.uniqBy(endpoints, (_point) => {return _point.nodeId + '||' + _point.id});\n              } else {\n                endpoints = [this._dragEndpoint];\n              }\n              endpoints.forEach((point) => {\n                let _sourceNode = point.nodeType === 'node' ? this.getNode(point.nodeId) : this.getGroup(point.nodeId);\n                let _sourceEndpoint = point;\n                let pointObj = {\n                  type: 'endpoint',\n                  shapeType: this.theme.edge.type,\n                  orientationLimit: this.theme.endpoint.position,\n                  _sourceType: point.nodeType,\n                  sourceNode: _sourceNode,\n                  sourceEndpoint: _sourceEndpoint,\n                  arrow: this.theme.edge.arrow,\n                  arrowPosition: this.theme.edge.arrowPosition,\n                  arrowOffset: this.theme.edge.arrowOffset,\n                  label: this.theme.edge.label,\n                  isExpandWidth: this.theme.edge.isExpandWidth\n                };\n                pointObj['options'] = _.assign({}, pointObj, {\n                  sourceNode: _sourceNode.id,\n                  sourceEndpoint: _sourceEndpoint.id\n                });\n                // 检查endpoint限制连接数目\n                let _linkNums = this.edges.filter((_edge) => {\n                  return _edge.sourceEndpoint.id === point.id;\n                }).length + 1;\n                if (_linkNums > point.limitNum) {\n                  console.warn(`id为${point.id}的锚点限制了${point.limitNum}条连线`);\n                  return;\n                }\n                let _newEdge = new EdgeClass(_.assign(pointObj, {\n                  _global: this.global,\n                  _on: this.on.bind(this),\n                  _emit: this.emit.bind(this),\n                }));\n                _newEdge._init();\n                $(this.svg).append(_newEdge.dom);\n                if (_newEdge.labelDom) {\n                  $(this.wrapper).append(_newEdge.labelDom);\n                }\n                if (_newEdge.arrowDom) {\n                  $(this.svg).append(_newEdge.arrowDom);\n                }\n                edges.push(_newEdge);\n              });\n              this._dragEdges = edges;\n            } else {\n              edges = this._dragEdges;\n            }\n\n            $(this.svg).css('visibility', 'hidden');\n            $(this.wrapper).css('visibility', 'hidden');\n            let _targetPoint = {\n              pos: [endX, endY],\n            };\n            edges.forEach((edge) => {\n              let beginX = edge.sourceEndpoint._posLeft + edge.sourceEndpoint._width / 2;\n              let beginY = edge.sourceEndpoint._posTop + edge.sourceEndpoint._height / 2;\n              const _soucePoint = {\n                pos: [beginX, beginY],\n                orientation: edge.sourceEndpoint.orientation\n              };\n              edge.redraw(_soucePoint, _targetPoint);\n            });\n            $(this.svg).css('visibility', 'visible');\n            $(this.wrapper).css('visibility', 'visible');\n\n            if (this.theme.endpoint.linkableHighlight) {\n              _activeLinkableEndpoint(this._dragEndpoint);\n              _focusLinkableEndpoint(event.clientX, event.clientY);\n            }\n\n            this._autoMoveCanvas(event.clientX, event.clientY, {\n              type: 'endpoint:drag',\n              edges: edges\n            }, (gap) => {\n              edges.forEach((edge) => {\n                let beginX = edge.sourceEndpoint._posLeft + edge.sourceEndpoint._width / 2;\n                let beginY = edge.sourceEndpoint._posTop + edge.sourceEndpoint._height / 2;\n                const _soucePoint = {\n                  pos: [beginX, beginY],\n                  orientation: edge.sourceEndpoint.orientation\n                };\n                _targetPoint.pos[0] += gap[0];\n                _targetPoint.pos[1] += gap[1];\n                edge.redraw(_soucePoint, _targetPoint);\n              });\n            });\n\n            this.emit('system.drag.move', {\n              dragType: this._dragType,\n              pos: [event.clientX, event.clientY],\n              dragNode: this._dragNode,\n              dragEndpoint: this._dragEndpoint,\n              dragEdges: edges\n            });\n            this.emit('events', {\n              type: 'drag:move',\n              dragType: this._dragType,\n              pos: [event.clientX, event.clientY],\n              dragNode: this._dragNode,\n              dragEndpoint: this._dragEndpoint,\n              dragEdges: edges\n            });\n          } else if (_isTargetEndpoint && this.disLinkable) {\n            // 从后面搜索线\n            let targetEdge = null;\n            for (let i = this.edges.length - 1; i >= 0; i--) {\n              if (this._dragEndpoint.id === _.get(this.edges, [i, 'targetEndpoint', 'id']) && this._dragEndpoint.nodeId === _.get(this.edges, [i, 'targetNode', 'id'])) {\n                targetEdge = this.edges[i];\n                break;\n              }\n            }\n            if (targetEdge && this._dragEdges.length === 0) {\n              targetEdge._isDeletingEdge = true;\n              this._dragEdges = [targetEdge];\n            }\n\n            if (this._dragEdges.length !== 0) {\n              let edge = this._dragEdges[0];\n              let beginX = edge.sourceEndpoint._posLeft + edge.sourceEndpoint._width / 2;\n              let beginY = edge.sourceEndpoint._posTop + edge.sourceEndpoint._height / 2;\n              const _soucePoint = {\n                pos: [beginX, beginY],\n                orientation: edge.sourceEndpoint.orientation\n              };\n              const _targetPoint = {\n                pos: [endX, endY],\n              };\n              edge.redraw(_soucePoint, _targetPoint);\n            }\n            if (this.theme.endpoint.linkableHighlight) {\n              _activeLinkableEndpoint(this._dragEndpoint);\n              _focusLinkableEndpoint(event.clientX, event.clientY);\n            }\n          }\n        } else if (this._dragType === 'group:resize') {\n          let canvasX = this._coordinateService._terminal2canvas('x', event.clientX);\n          let canvasY = this._coordinateService._terminal2canvas('y', event.clientY);\n\n          let _newWidth = canvasX - this._dragGroup.left;\n          let _newHeight = canvasY - this._dragGroup.top;\n          this._dragGroup.setSize(_newWidth, _newHeight);\n        }\n      }\n    };\n\n    const mouseEndEvent = (event) => {\n      const LEFT_BUTTON = 0;\n      if (event.button !== LEFT_BUTTON) {\n        return;\n      }\n\n      let _unionNodes = [];\n\n      _unActiveLinkableEndpoint();\n\n      // 处理线条的问题\n      if (this._dragType === 'endpoint:drag' && this._dragEdges && this._dragEdges.length !== 0) {\n        // 释放对应画布上的x,y\n        const x = this._coordinateService._terminal2canvas('x', event.clientX);\n        const y = this._coordinateService._terminal2canvas('y', event.clientY);\n\n        let _targetEndpoint = null;\n\n        let _nodes = _.concat(this.nodes, this.groups);\n        _nodes.forEach((_node) => {\n          if (_node.endpoints) {\n            _node.endpoints.forEach((_point) => {\n              const _maxX = _point._posLeft + _point._width + (_.get(_point, 'expandArea.right') || this.theme.endpoint.expandArea.right);\n              const _maxY = _point._posTop + _point._height + (_.get(_point, 'expandArea.bottom') || this.theme.endpoint.expandArea.bottom);\n              const _minX = _point._posLeft - (_.get(_point, 'expandArea.left') || this.theme.endpoint.expandArea.left);\n              const _minY = _point._posTop - (_.get(_point, 'expandArea.top') || this.theme.endpoint.expandArea.top);\n              if (x > _minX && x < _maxX && y > _minY && y < _maxY) {\n                _targetEndpoint = _point;\n              }\n            });\n          }\n        });\n\n        let isDestoryEdges = false;\n        // 找不到点 或者 目标节点不是target\n        if (!_targetEndpoint || _targetEndpoint.type === 'source' || _targetEndpoint._tmpType === 'source') {\n          isDestoryEdges = true;\n        }\n\n        // scope不同\n        if (!isDestoryEdges) {\n          isDestoryEdges = _.some(this._dragEdges, (edge) => {\n            return !ScopeCompare(edge.sourceEndpoint.scope, _targetEndpoint.scope, _.get(this, 'global.isScopeStrict'));\n          });\n        }\n\n        // 检查endpoint限制连接数目\n        if (_targetEndpoint && _targetEndpoint.limitNum !== undefined) {\n          let _linkNum = this.edges.filter((_edge) => {\n            return _edge.targetEndpoint.id === _targetEndpoint.id;\n          }).length + this._dragEdges.length;\n          if (_linkNum > _targetEndpoint.limitNum) {\n            console.warn(`id为${_targetEndpoint.id}的锚点限制了${_targetEndpoint.limitNum}条连线`);\n            isDestoryEdges = true;\n          }\n        }\n\n        if (isDestoryEdges) {\n          this._dragEdges.forEach((edge) => {\n            if (edge._isDeletingEdge) {\n              this.removeEdge(edge);\n            } else {\n              edge.destroy(!edge._isDeletingEdge);\n            }\n          });\n          // 把endpoint重新赋值\n          this._dragEdges.forEach((_rmEdge) => {\n            if (_.get(_rmEdge, 'sourceEndpoint._tmpType') === 'source') {\n              let isExistEdge = _.some(this.edges, (edge) => {\n                return _rmEdge.sourceNode.id === edge.sourceNode.id && _rmEdge.sourceEndpoint.id === edge.sourceEndpoint.id;\n              });\n              !isExistEdge && (_rmEdge.sourceEndpoint._tmpType = undefined);\n            }\n            if (_.get(_rmEdge, 'targetEndpoint._tmpType') === 'target') {\n              let isExistEdge = _.some(this.edges, (edge) => {\n                return _rmEdge.targetNode.id === edge.targetNode.id && _rmEdge.targetEndpoint.id === edge.targetEndpoint.id;\n              });\n              !isExistEdge && (_rmEdge.targetEndpoint._tmpType = undefined);\n            }\n          });\n        } else {\n          let _delEdges = [];\n          let _reconnectInfo = [];\n\n          let _emitEdges = this._dragEdges.filter((edge) => {\n            // 线条去重\n            if (!this.theme.edge.isRepeat) {\n              let _isRepeat = _.some(this.edges, (_edge) => {\n                let _result = false;\n                if (edge.sourceNode) {\n                  if (_edge.type === 'node') {\n                    _result = edge.sourceNode.id === _edge.sourceNode.id;\n                  } else {\n                    _result = edge.sourceNode.id === _edge.sourceNode.id && edge.sourceEndpoint.id === _edge.sourceEndpoint.id;\n                  }\n                }\n\n                if (_targetEndpoint.nodeId) {\n                  if (_edge.type === 'node') {\n                    _result = _result && (_.get(edge, 'targetNode.id') === _.get(_edge, 'targetNode.id'));\n                  } else {\n                    _result = _result && (_targetEndpoint.nodeId === _.get(_edge, 'targetNode.id') && _targetEndpoint.id === _.get(_edge, 'targetEndpoint.id'));\n                  }\n                }\n\n                if (_result && edge._isDeletingEdge) {\n                  _result = false;\n                }\n\n                return _result;\n              });\n              if (_isRepeat) {\n                console.warn(`id为${edge.sourceEndpoint.id}-${_targetEndpoint.id}的线条连接重复，请检查`);\n                edge.destroy();\n                return false;\n              }\n            }\n            let _preTargetNodeId = _.get(edge, 'targetNode.id');\n            let _preTargetPointId = _.get(edge, 'targetEndpoint.id');\n            let _currentTargetNode = _targetEndpoint.nodeType === 'node' ? this.getNode(_targetEndpoint.nodeId) : this.getGroup(_targetEndpoint.nodeId);\n            let _currentTargetEndpoint = _targetEndpoint;\n            if (_preTargetNodeId && _preTargetPointId && `${_preTargetNodeId}||${_preTargetPointId}` !== `${_currentTargetNode.id}||${_currentTargetEndpoint.id}`) {\n              _delEdges.push(_.cloneDeep(edge));\n              _reconnectInfo.push({\n                edge,\n                preTargetNodeId: _preTargetNodeId,\n                preTargetPointId: _preTargetPointId,\n                currentTargetNodeId: _currentTargetNode.id,\n                currentTargetPointId: _currentTargetEndpoint.id\n              });\n            }\n            edge._create({\n              id: edge.id && !edge._isDeletingEdge ? edge.id : `${edge.sourceEndpoint.id}-${_targetEndpoint.id}`,\n              targetNode: _currentTargetNode,\n              _targetType: _targetEndpoint.nodeType,\n              targetEndpoint: _currentTargetEndpoint,\n              type: 'endpoint'\n            });\n            let _isConnect = edge.isConnect ? edge.isConnect() : true;\n            if (!_isConnect) {\n              console.warn(`id为${edge.sourceEndpoint.id}-${_targetEndpoint.id}的线条无法连接，请检查`);\n              edge.destroy();\n              return false;\n            }\n\n            // 正在删除的线重新连接\n            if (edge._isDeletingEdge) {\n              delete edge._isDeletingEdge;\n            } else {\n              edge.mounted && edge.mounted();\n              this.edges.push(edge);\n            }\n\n            // 把endpoint重新赋值\n            if (edge.type === 'endpoint' && !_.get(edge, 'sourceEndpoint.type') && !_.get(edge, 'sourceEndpoint._tmpType')) {\n              edge.sourceEndpoint._tmpType = 'source';\n            }\n            if (edge.type === 'endpoint' && !_.get(edge, 'targetEndpoint.type') && !_.get(edge, 'targetEndpoint._tmpType')) {\n              edge.targetEndpoint._tmpType = 'target';\n            }\n\n            return edge;\n          });\n          if (_delEdges.length !== 0 && _emitEdges.length !== 0) {\n            this.pushActionQueue({\n              type: 'system:reconnectEdges',\n              data: {\n                delLinks: _delEdges,\n                addLinks: _emitEdges,\n                info: _reconnectInfo\n              }\n            });\n            this.emit('system.link.reconnect', {\n              delLinks: _delEdges,\n              addLinks: _emitEdges,\n              info: _reconnectInfo\n            });\n            this.emit('events', {\n              type: 'link:reconnect',\n              delLinks: _delEdges,\n              addLinks: _emitEdges,\n              info: _reconnectInfo\n            });\n          } else {\n            if (_delEdges.length !== 0) {\n              _delEdges.forEach((_edge) => {\n                this.pushActionQueue({\n                  type: 'system:removeEdges',\n                  data: _delEdges\n                });\n                this.emit('system.link.delete', {\n                  link: _edge\n                });\n                this.emit('events', {\n                  type: 'link:delete',\n                  link: _edge\n                });\n              });\n            }\n            if (_emitEdges.length !== 0) {\n              this.pushActionQueue({\n                type: 'system:addEdges',\n                data: this._dragEdges\n              });\n              this.emit('system.link.connect', {\n                links: this._dragEdges\n              });\n              this.emit('events', {\n                type: 'link:connect',\n                links: this._dragEdges\n              });\n            }\n          }\n        }\n      }\n      if (this._dragType === 'node:drag' && this._dragNode) {\n\n        let _handleDragNode = (dragNode) => {\n          let sourceGroup = null;\n          let targetGroup = null;\n          let _nodeLeft = dragNode.left;\n          let _nodeRight = dragNode.left + dragNode.getWidth();\n          let _nodeTop = dragNode.top;\n          let _nodeBottom = dragNode.top + dragNode.getHeight();\n\n          if (dragNode.group) {\n            const _group = this.getGroup(dragNode.group);\n            const _groupLeft = _group.left;\n            const _groupTop = _group.top;\n            if (_nodeRight < 0 || _nodeLeft > _group.getWidth() || _nodeBottom < 0 || _nodeTop > _group.getHeight()) {\n              _nodeLeft += _groupLeft;\n              _nodeTop += _groupTop;\n              _nodeRight += _groupLeft;\n              _nodeBottom += _groupTop;\n              sourceGroup = _group;\n            } else {\n              sourceGroup = _group;\n              targetGroup = _group;\n            }\n          }\n\n          if (!targetGroup) {\n            targetGroup = this._findGroupByCoordinates(dragNode, _nodeLeft, _nodeTop, _nodeRight, _nodeBottom)\n          }\n\n          let neighborEdges = [];\n\n          // 更新edge里面的字段，以防外面操作了里面dom\n          let _updateNeighborEdge = (node, neighborEdges) => {\n            neighborEdges.forEach((_edge) => {\n              if (_edge.sourceNode.id === node.id) {\n                _edge.sourceNode = node;\n                let _sourceEndpoint = _.find(_edge.sourceNode.endpoints, (_point) => {\n                  return _edge.sourceEndpoint.id === _point.id;\n                });\n                _edge.sourceEndpoint = _sourceEndpoint;\n              }\n              if (_edge.targetNode.id === node.id) {\n                _edge.targetNode = node;\n                let _targetEndpoint = _.find(_edge.targetNode.endpoints, (_point) => {\n                  return _edge.targetEndpoint.id === _point.id;\n                });\n                _edge.targetEndpoint = _targetEndpoint;\n              }\n            });\n          };\n          this._hoverGroup(this._dragNode);\n          if (sourceGroup) {\n            // 从源组拖动到目标组\n            if (sourceGroup !== targetGroup) {\n              const rmItem = this.removeNode(dragNode.id, true, true);\n              const rmNode = rmItem.nodes[0];\n              neighborEdges = rmItem.edges;\n              const nodeData = {\n                id: rmNode.id,\n                top: _nodeTop,\n                left: _nodeLeft,\n                dom: rmNode.dom,\n                _isDeleteGroup: true\n              };\n              let step = this.actionQueue[this.actionQueueIndex];\n              if (step.type === 'system:moveNodes') {\n                step.data._isDraging = true;\n              }\n              this.pushActionQueue({\n                type: 'system:groupRemoveMembers',\n                data: {\n                  group: sourceGroup,\n                  nodes: [rmNode],\n                  _isDraging: true\n                }\n              })\n              this.emit('events', {\n                type: 'system.group.removeMembers',\n                group: sourceGroup,\n                nodes: [rmNode]\n              });\n              this.emit('system.group.removeMembers', {\n                group: sourceGroup,\n                nodes: [rmNode]\n              });\n\n              if (targetGroup) {\n                if (ScopeCompare(dragNode.scope, targetGroup.scope, _.get(this, 'global.isScopeStrict'))) {\n                  nodeData.top -= targetGroup.top;\n                  nodeData.left -= targetGroup.left;\n                  nodeData.group = targetGroup.id;\n                  nodeData._isDeleteGroup = false;\n                  this.popActionQueue();\n                  this.pushActionQueue({\n                    type: 'system:groupAddMembers',\n                    data: {\n                      sourceGroup: sourceGroup,\n                      targetGroup: targetGroup,\n                      nodes: [rmNode],\n                      _isDraging: true\n                    }\n                  });\n                  this.emit('events', {\n                    type: 'system.group.addMembers',\n                    nodes: [rmNode],\n                    group: targetGroup\n                  });\n                  this.emit('system.group.addMembers', {\n                    nodes: [rmNode],\n                    group: targetGroup\n                  });\n                  this._clearHoverGroup(targetGroup);\n                } else {\n                  console.warn(`nodeId为${dragNode.id}的节点和groupId${targetGroup.id}的节点组scope值不符，无法加入`);\n                }\n              }\n              rmNode._init(nodeData);\n              this.addNode(rmNode, true);\n              _updateNeighborEdge(rmNode, neighborEdges);\n            }\n          } else {\n            if (targetGroup) {\n              if (ScopeCompare(dragNode.scope, targetGroup.scope, _.get(this, 'global.isScopeStrict'))) {\n                const rmItem = this.removeNode(dragNode.id, true, true);\n                const rmNode = rmItem.nodes[0];\n                neighborEdges = rmItem.edges;\n                rmNode._init({\n                  top: _nodeTop - targetGroup.top,\n                  left: _nodeLeft - targetGroup.left,\n                  dom: rmNode.dom,\n                  group: targetGroup.id\n                });\n                this.addNode(rmNode, true);\n                let step = this.actionQueue[this.actionQueueIndex];\n                if (step.type === 'system:moveNodes') {\n                  step.data._isDraging = true;\n                }\n                _updateNeighborEdge(rmNode, neighborEdges);\n                this.pushActionQueue({\n                  type: 'system:groupAddMembers',\n                  data: {\n                    sourceGroup: undefined,\n                    targetGroup: targetGroup,\n                    nodes: [rmNode],\n                    _isDraging: true\n                  }\n                });\n                this.emit('events', {\n                  type: 'system.group.addMembers',\n                  nodes: [rmNode],\n                  group: targetGroup\n                });\n                this.emit('system.group.addMembers', {\n                  nodes: [rmNode],\n                  group: targetGroup\n                });\n                this._clearHoverGroup(targetGroup);\n              } else {\n                console.warn(`nodeId为${dragNode.id}的节点和groupId${targetGroup.id}的节点组scope值不符，无法加入`);\n              }\n            }\n          }\n          neighborEdges.forEach((item) => {\n            item.redraw();\n          });\n          dragNode.endpoints.forEach((item) => {\n            item.updatePos && item.updatePos();\n          });\n          dragNode._isMoving = false;\n        }\n        let moveNodes = [this._dragNode];\n        const unionKeys = this._findUnion('nodes', this._dragNode);\n        if (unionKeys && unionKeys.length > 0) {\n          unionKeys.forEach((key) => {\n            moveNodes = moveNodes.concat(this._unionData[key].nodes);\n          });\n          moveNodes = _.uniqBy(moveNodes, 'id');\n        }\n        moveNodes.forEach((dragNode) => {\n          _handleDragNode(dragNode);\n        });\n        _unionNodes = moveNodes;\n        this._rmSystemUnion();\n      }\n\n      // 节点组放大缩小\n      if (this._dragType === 'group:resize' && this._dragGroup) {\n        this.emit('events', {\n          type: 'system.group.resize',\n          group: this._dragGroup\n        });\n        this.emit('system.group.resize', {\n          group: this._dragGroup\n        });\n      }\n\n      // 点击空白处触发canvas click，并且框选模式下不触发\n      if ((this._dragType === 'canvas:drag' || !this._dragType) && !this.isSelectMode) {\n        this.emit('system.canvas.click');\n        this.emit('events', {\n          type: 'canvas:click'\n        });\n      }\n\n      if (this._dragType === 'node:drag' || this._dragType === 'group:drag') {\n        this.pushActionQueue({\n          type: '_system:dragNodeEnd'\n        });\n      }\n\n      this.emit('system.drag.end', {\n        dragType: this._dragType,\n        dragNode: this._dragNode,\n        dragEndpoint: this._dragEndpoint,\n        dragEdges: this._dragEdges,\n        dragGroup: this._dragGroup,\n        unionNodes: _unionNodes\n      });\n      this.emit('events', {\n        type: 'drag:end',\n        dragType: this._dragType,\n        dragNode: this._dragNode,\n        dragEndpoint: this._dragEndpoint,\n        dragEdges: this._dragEdges,\n        dragGroup: this._dragGroup,\n        unionNodes: _unionNodes\n      });\n\n      _clearDraging();\n    };\n\n    const mouseLeaveEvent = (event) => {\n      if (this._dragEdges && this._dragEdges.length > 0) {\n        this._dragEdges.forEach((edge) => {\n          if (edge._isDeletingEdge) {\n            this.removeEdge(edge);\n          } else {\n            edge.destroy(!edge._isDeletingEdge);\n          }\n        });\n      }\n      _clearDraging();\n    }\n\n    this.root.addEventListener('mousedown', mouseDownEvent);\n    this.root.addEventListener('mousemove', mouseMoveEvent);\n    // this.root.addEventListener('mouseleave', mouseEndEvent);\n    this.root.addEventListener('mouseup', mouseEndEvent);\n    this.root.addEventListener('mouseleave', mouseLeaveEvent);\n  }\n  _autoMoveCanvas(x, y, data, cb) {\n\n    if (!this.theme.autoFixCanvas.enable) {\n      return;\n    }\n\n    this._autoMoveDir = [];\n    let _terOffsetX = this._coordinateService.terOffsetX;\n    let _terOffsetY = this._coordinateService.terOffsetY;\n\n    clearInterval(this._autoMoveTimer);\n    this._autoMoveTimer = null;\n\n    if (this._autoMoveTimer && this._autoMoveDir.length > 0) {\n      return;\n    }\n    let _autoMovePadding = this.theme.autoFixCanvas.autoMovePadding;\n    if (x - _terOffsetX <= _autoMovePadding[3]) {\n      this._autoMoveDir.push('left');\n    }\n    if (this._rootWidth - (x - _terOffsetX) <= _autoMovePadding[1]) {\n      this._autoMoveDir.push('right');\n    }\n    if (y - _terOffsetY <= _autoMovePadding[0]) {\n      this._autoMoveDir.push('top');\n    }\n    if (this._rootHeight - (y - _terOffsetY) <= _autoMovePadding[2]) {\n      this._autoMoveDir.push('bottom');\n    }\n\n    if (this._autoMoveDir.length === 0) {\n      clearInterval(this._autoMoveTimer);\n      return;\n    }\n\n    if (!this._autoMoveTimer) {\n      let MOVE_GAP = 5;\n      this._autoMoveTimer = setInterval(() => {\n        if (this._autoMoveDir.includes('left')) {\n          this.move([this._moveData[0] + MOVE_GAP, this._moveData[1]]);\n          _moveTarget([-MOVE_GAP, 0]);\n        }\n        if (this._autoMoveDir.includes('right')) {\n          this.move([this._moveData[0] - MOVE_GAP, this._moveData[1]]);\n          _moveTarget([+MOVE_GAP, 0]);\n        }\n        if (this._autoMoveDir.includes('top')) {\n          this.move([this._moveData[0], this._moveData[1] + MOVE_GAP]);\n          _moveTarget([0, -MOVE_GAP]);\n        }\n        if (this._autoMoveDir.includes('bottom')) {\n          this.move([this._moveData[0], this._moveData[1] - MOVE_GAP]);\n          _moveTarget([0, +MOVE_GAP]);\n        }\n      }, 70);\n    }\n\n    // 同时需要移动target\n    let _moveTarget = (gap) => {\n      if (data.type === 'node:drag') {\n        data.nodes.forEach((item) => {\n          item.moveTo(item.left + gap[0], item.top + gap[1]);\n        })\n      } else if (data.type === 'group:drag') {\n        let group = data.group;\n        group.moveTo(group.left + gap[0], group.top + gap[1]);\n      }\n      cb && cb(gap);\n    }\n  }\n  _moveNode(node, x, y, isNotEventEmit) {\n    \n    let _isInGroup = !!node.group;\n    if (_isInGroup) {\n      let groupObj = this.getGroup(node.group);\n      let groupType = groupObj.type || this.theme.group.type;\n      if (groupType === 'inner') {\n        let _groupW = $(groupObj.dom).width();\n        let _groupH = $(groupObj.dom).height();\n        let _nodeW = $(node.dom).width();\n        let _nodeH = $(node.dom).height();\n        if (x < 0 || (x + _nodeW) > _groupW || y < 0 || (y + _nodeH) > _groupH) {\n          return ;\n        }\n      }\n    }\n\n    if (!isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:moveNodes',\n        data: {\n          node: node,\n          top: y,\n          left: x\n        }\n      });\n    }\n\n    // todo 防抖\n    node._moveTo(x, y);\n    node.endpoints && node.endpoints.forEach((item) => {\n      item.updatePos();\n    });\n    this.edges.forEach((edge) => {\n      if (edge.type === 'endpoint') {\n        const isLink = _.find(node.endpoints, (point) => {\n          return (point.nodeId === edge.sourceNode.id && !!edge.sourceNode.getEndpoint(point.id, 'source')) || (point.nodeId === edge.targetNode.id && !!edge.targetNode.getEndpoint(point.id, 'target'));\n        });\n        isLink && edge.redraw();\n      } else if (edge.type === 'node') {\n        const isLink = edge.sourceNode.id === node.id || edge.targetNode.id === node.id;\n        isLink && edge.redraw();\n      }\n    });\n  }\n  _moveGroup(group, x, y, isNotEventEmit) {\n    if (!isNotEventEmit) {\n      this.pushActionQueue({\n        type: 'system:moveGroups',\n        data: {\n          group: group,\n          top: y,\n          left: x\n        }\n      });\n    }\n    group._moveTo(x, y);\n    this.edges.forEach((edge) => {\n      let hasUpdate = _.get(edge, 'sourceNode.group') === group.id ||\n        _.get(edge, 'targetNode.group') === group.id ||\n        (_.get(edge, '_sourceType') === 'group' && _.get(edge, 'sourceNode.id') === group.id) ||\n        (_.get(edge, '_targetType') === 'group' && _.get(edge, 'targetNode.id') === group.id);\n\n      hasUpdate && (edge.redraw());\n    });\n  }\n  _autoLayout(data) {\n    const width = this._rootWidth;\n    const height = this._rootHeight;\n\n    if (_.isFunction(this.layout)) {\n      this.layout({\n        width: width,\n        height: height,\n        data: data\n      });\n    } else {\n      // 重力布局\n      if (_.get(this.layout, 'type') === 'forceLayout') {\n        const _opts = $.extend({\n          // 布局画布总宽度\n          width,\n          // 布局画布总长度\n          height,\n          // 布局相对中心点\n          center: {\n            x: width / 2,\n            y: height / 2\n          },\n          // 节点互斥力，像电荷原理一样\n          chargeStrength: -150,\n          link: {\n            // 以node的什么字段为寻找id，跟d3原理一样\n            id: 'id',\n            // 线条的距离\n            distance: 200,\n            // 线条的粗细\n            strength: 1\n          }\n        }, _.get(this.layout, 'options'), true);\n\n        // 自动布局\n        if (_.get(this.layout, 'type') === 'forceLayout') {\n          Layout.forceLayout({\n            opts: _opts,\n            data: {\n              groups: data.groups,\n              nodes: data.nodes,\n              // 加工线条数据，兼容endpoint为id的属性，d3没这个概念\n              edges: data.edges.map(item => ({\n                source: item.type === 'endpoint' ? item.sourceNode : item.source,\n                target: item.type === 'endpoint' ? item.targetNode : item.target\n              }))\n            }\n          });\n        }\n      } else if (_.get(this.layout, 'type') === 'drageLayout') {\n        Layout.drageLayout({\n          //  /** layout 方向, 可选 TB, BT, LR, RL */\n          // public rankdir: 'TB' | 'BT' | 'LR' | 'RL' = 'TB';\n          rankdir: _.get(this.layout, 'options.rankdir') || 'TB',\n          // /** 节点对齐方式，可选 UL, UR, DL, DR */\n          // public align: undefined | 'UL' | 'UR' | 'DL' | 'DR';\n          align: _.get(this.layout, 'options.align'),\n          // /** 节点大小 */\n          // public nodeSize: number | number[] | undefined;\n          nodeSize: _.get(this.layout, 'options.nodeSize'),\n          // /** 节点水平间距(px) */\n          // public nodesepFunc: ((d?: any) => number) | undefined;\n          nodesepFunc: _.get(this.layout, 'options.nodesepFunc'),\n          // /** 每一层节点之间间距 */\n          // public ranksepFunc: ((d?: any) => number) | undefined;\n          ranksepFunc: _.get(this.layout, 'options.ranksepFunc'),\n          // /** 节点水平间距(px) */\n          // public nodesep: number = 50;\n          nodesep: _.get(this.layout, 'options.nodesep') || 50,\n          // /** 每一层节点之间间距 */\n          // public ranksep: number = 50;\n          ranksep: _.get(this.layout, 'options.ranksep') || 50,\n          // /** 是否保留布局连线的控制点 */\n          // public controlPoints: boolean = false;\n          controlPoints: _.get(this.layout, 'options.controlPoints') || false,\n          data: {\n            // groups: data.groups,\n            nodes: data.nodes,\n            edges: data.edges.map(item => ({\n              source: item.type === 'endpoint' ? item.sourceNode : item.source,\n              target: item.type === 'endpoint' ? item.targetNode : item.target\n            }))\n          }\n        })\n      } else if (_.get(this.layout, 'type') === 'concentricLayout') {\n        Layout.concentLayout({\n          /** 布局中心 默认值：图的中心 */\n          // public center: [number, number];\n          center: _.get(this.layout, 'options.center') || [width / 2, height / 2],\n          // /** 节点大小（直径）。用于防止节点重叠时的碰撞检测 */\n          // public nodeSize: number | [number, number] = 30;\n          nodeSize: _.get(this.layout, 'options.nodeSize') || 30,\n          // /** 环与环之间最小间距，用于调整半径 */\n          // public minNodeSpacing: number = 10;\n          minNodeSpacing: _.get(this.layout, 'options.minNodeSpacing') || 10,\n          // /** 是否防止重叠，必须配合上面属性 nodeSize，只有设置了与当前图节点大小相同的 nodeSize 值，才能够进行节点重叠的碰撞检测 */\n          // public preventOverlap: boolean = false;\n          preventOverlap: _.get(this.layout, 'options.preventOverlap') || false,\n          // /** 第一个节点与最后一个节点之间的弧度差。若为 undefined ，则将会被设置为  2 _ Math.PI _ (1 - 1 / |level.nodes|) ，其中 level.nodes 为该算法计算出的每一层的节点，|level.nodes| 代表该层节点数量 */\n          // public sweep: number | undefined;\n          sweep: _.get(this.layout, 'options.sweep'),\n          // /** 环与环之间的距离是否相等 */\n          // public equidistant: boolean = false;\n          equidistant: _.get(this.layout, 'options.equidistant') || false,\n          // /** 开始方式节点的弧度 */\n          // public startAngle: number = (3 / 2) * Math.PI;\n          startAngle: (3 / 2) * Math.PI,\n          // /** 是否按照顺时针排列 */\n          // public clockwise: boolean = true;\n          clockwise: _.get(this.layout, 'options.clockwise') || true,\n          // /** 每一层同心值的求和。若为 undefined，则将会被设置为 maxValue / 4 ，其中 maxValue 为最大的排序依据的属性值。例如，若 sortBy 为 'degree'，则 maxValue 为所有节点中度数最大的节点的度数 */\n          //public maxLevelDiff: undefined | number;\n          maxLevelDiff: _.get(this.layout, 'options.maxLevelDiff'),\n          // /** 指定排序的依据（节点属性名），数值越高则该节点被放置得越中心。若为 undefined，则会计算节点的度数，度数越高，节点将被放置得越中心 */\n          // public sortBy: string = 'degree';\n          sortBy: _.get(this.layout, 'options.sortBy') || 'degree',\n          // 布局画布总宽度\n          width: width,\n          // 布局画布总长度\n          height: height,\n          data: {\n            groups: data.groups,\n            nodes: data.nodes,\n            edges: data.edges.map(item => ({\n              source: item.type === 'endpoint' ? item.sourceNode : item.source,\n              target: item.type === 'endpoint' ? item.targetNode : item.target\n            }))\n          }\n        });\n      } else if (_.get(this.layout, 'type') === 'circleLayout') {\n        Layout.circleLayout({\n          radius: _.get(this.layout, 'options.radius'),\n          getWidth: _.get(this.layout, 'options.getWidth'),\n          getHeight: _.get(this.layout, 'options.getHeight'),\n          data: {\n            nodes: data.nodes,\n            edges: data.edges.map(item => ({\n              source: item.type === 'endpoint' ? item.sourceNode : item.source,\n              target: item.type === 'endpoint' ? item.targetNode : item.target\n            }))\n          }\n        });\n      } else if(_.get(this.layout, 'type') === 'gridLayout') {\n        const _opts = $.extend({\n          // 布局画布总宽度\n          width: 150,\n          // 布局画布总长度\n          height: 100,\n          // 布局相对起始点\n          begin: [0, 0],\n          preventOverlap: true,\n          preventOverlapPadding: 10,\n          condense: false,\n          //宽高\n          rows: undefined,\n          cols: undefined,\n          //位置\n          position: undefined,\n          // 排序方式\n          sortBy: 'degree',\n          nodeSize: 30,\n          link: {\n            // 以node的什么字段为寻找id，跟d3原理一样\n            id: 'id',\n            // 线条的距离\n            distance: 100,\n            // 线条的粗细\n            strength: 1\n          }\n        }, _.get(this.layout, 'options'), true);\n        // 自动布局\n        if (_.get(this.layout, 'type') === 'gridLayout') {\n\n          Layout.gridLayout({\n            opts: _opts,\n            data: {\n              groups: data.groups,\n              nodes: data.nodes,\n              // 加工线条数据，兼容endpoint为id的属性，d3没这个概念\n              edges: data.edges.map(item => ({\n                source: item.type === 'endpoint' ? item.sourceNode : item.source,\n                target: item.type === 'endpoint' ? item.targetNode : item.target\n              }))\n            }\n          })\n        }\n      } else if(_.get(this.layout, 'type') === 'fruchterman') {\n        const _opts = $.extend({\n           // 布局画布总宽度\n           width,\n           // 布局画布总长度\n           height,\n            /** 停止迭代的最大迭代数 */\n          maxIteration: 1000,\n            /** 布局中心 */\n          center: [width / 2, height / 2],\n            /** 重力大小，影响图的紧凑程度 */\n          gravity: 5,\n          /** 速度 */\n          speed: 5,\n           /** 是否产生聚类力 */\n          clustering: false,\n           /** 聚类力大小 */\n          clusterGravity: 10,\n          link: {\n            // 以node的什么字段为寻找id，跟d3原理一样\n            id: 'id',\n            // 线条的距离\n            distance: 100,\n            // 线条的粗细\n            strength: 1\n          }\n        }, _.get(this.layout, 'options'), true);\n        // 自动布局\n        if (_.get(this.layout, 'type') === 'fruchterman') {\n\n          Layout.fruchterman({\n            opts: _opts,\n            data: {\n              groups: data.groups,\n              nodes: data.nodes,\n              // 加工线条数据，兼容endpoint为id的属性，d3没这个概念\n              edges: data.edges.map(item => ({\n                source: item.type === 'endpoint' ? item.sourceNode : item.source,\n                target: item.type === 'endpoint' ? item.targetNode : item.target\n              }))\n            }\n          })\n        }\n      }else if(_.get(this.layout, 'type') === 'radial') {\n        const _opts = $.extend({\n          // 布局画布总宽度\n          width: _.get(this.layout, 'options.width') || 500,\n          // 布局画布总长度\n          height: _.get(this.layout, 'options.height') || 500,\n           /** 停止迭代的最大迭代数 */\n         maxIteration:  _.get(this.layout, 'options.maxIteration')|| 1000,\n           /** 布局中心 */\n         center: _.get(this.layout, 'options.center')|| [width / 2, height / 2],\n           /** 中心点，默认为数据中第一个点 */\n         focusNode: _.get(this.layout, 'options.focusNode') || null,\n           /** 每一圈半径 */\n         unitRadius: _.get(this.layout, 'options.unitRadius') || null,\n           /** 默认边长度 */\n         linkDistance: _.get(this.layout, 'options.linkDistance') || 50,\n           /** 是否防止重叠 */\n         preventOverlap: _.get(this.layout, 'options.preventOverlap') || false,\n           /** 节点直径 */\n         nodeSize: _.get(this.layout, 'options.nodeSize') || undefined,\n           /** 节点间距，防止节点重叠时节点之间的最小距离（两节点边缘最短距离） */\n         nodeSpacing: _.get(this.layout, 'options.nodeSpacing') || undefined,\n           /** 是否必须是严格的 radial 布局，即每一层的节点严格布局在一个环上。preventOverlap 为 true 时生效 */\n         strictRadial: _.get(this.layout, 'options.strictRadial') || true,\n           /** 防止重叠步骤的最大迭代次数 */\n         maxPreventOverlapIteration: _.get(this.layout, 'options.maxPreventOverlapIteration') || 200,\n         sortBy: _.get(this.layout, 'options.sortBy') || undefined,\n         sortStrength: _.get(this.layout, 'options.sortStrength') || 10,\n         link: {\n           // 以node的什么字段为寻找id，跟d3原理一样\n           id: 'id',\n           // 线条的距离\n           distance: 100,\n           // 线条的粗细\n           strength: 1\n         }\n       }, _.get(this.layout, 'options'), true);\n       // 自动布局\n       if (_.get(this.layout, 'type') === 'radial') {\n         Layout.radial({\n           opts: _opts,\n           data: {\n             groups: data.groups,\n             nodes: data.nodes,\n             // 加工线条数据，兼容endpoint为id的属性，d3没这个概念\n             edges: data.edges.map(item => ({\n               source: item.type === 'endpoint' ? item.sourceNode : item.source,\n               target: item.type === 'endpoint' ? item.targetNode : item.target\n             }))\n           }\n         })\n       }\n      }\n    }\n  }\n  _selectMultiplyItem(range, toDirection) {\n\n    // 确认一下终端的偏移值\n    const startX = this._coordinateService._terminal2canvas('x', range[0]);\n    const startY = this._coordinateService._terminal2canvas('y', range[1]);\n    const endX = this._coordinateService._terminal2canvas('x', range[2]);\n    const endY = this._coordinateService._terminal2canvas('y', range[3]);\n\n    const includeNode = _.includes(this.selecContents, 'node');\n    const includeEdge = _.includes(this.selecContents, 'edge');\n    const includeEndpoint = _.includes(this.selecContents, 'endpoint');\n\n    let _isSelected = (option) => {\n      let _itemLeft = option.left;\n      let _itemRight = option.right;\n      let _itemTop = option.top;\n      let _itemBottom = option.bottom;\n      if (this.selecMode === 'include' || (this.selecMode === 'senior' && toDirection === 'right')) {\n        return startX < _itemLeft && endX > _itemRight && startY < _itemTop && endY > _itemBottom;\n      }\n      if (this.selecMode === 'touch' || (this.selecMode === 'senior' && toDirection === 'left')) {\n        let result = true;\n        if (endX < _itemLeft) {\n          result = false;\n        }\n        if (startX > _itemRight) {\n          result = false;\n        }\n        if (endY < _itemTop) {\n          result = false;\n        }\n        if (startY > _itemBottom) {\n          result = false;\n        }\n        return result;\n      }\n    }\n\n    // 框选节点\n    if (includeNode) {\n      this.nodes.forEach((item) => {\n        let nodeLeft = item.left;\n        let nodeRight = item.left + $(item.dom).width();\n        let nodeTop = item.top;\n        let nodeBottom = item.top + $(item.dom).height();\n        if (item.group) {\n          let _group = this.getGroup(item.group);\n          nodeLeft += _group.left;\n          nodeRight += _group.left;\n          nodeTop += _group.top;\n          nodeBottom += _group.top;\n        }\n        let isSelected = _isSelected({\n          left: nodeLeft,\n          right: nodeRight,\n          top: nodeTop,\n          bottom: nodeBottom\n        });\n        if (isSelected) {\n          this.selectItem.nodes.push(item);\n        }\n      });\n    }\n\n    // 框选锚点\n    if (includeEndpoint) {\n      this.nodes.forEach((node) => {\n        node.endpoints.forEach((item) => {\n          const pointLeft = item._posLeft;\n          const pointRight = item._posLeft + $(item.dom).width();\n          const pointTop = item._posTop;\n          const pointBottom = item._posTop + $(item.dom).height();\n          let isSelected = _isSelected({\n            left: pointLeft,\n            right: pointRight,\n            top: pointTop,\n            bottom: pointBottom\n          });\n          if (isSelected) {\n            this.selectItem.endpoints.push(item);\n          }\n        });\n      });\n    }\n\n    // 框选线条\n    if (includeEdge) {\n      this.edges.forEach((item) => {\n        if (item.type === 'endpoint') {\n          const left = item.sourceEndpoint._posLeft < item.targetEndpoint._posLeft ? item.sourceEndpoint._posLeft : item.targetEndpoint._posLeft;\n          const right = (item.sourceEndpoint._posLeft + item.sourceEndpoint._width) > (item.targetEndpoint._posLeft + item.targetEndpoint._width) ? (item.sourceEndpoint._posLeft + item.sourceEndpoint._width) : (item.targetEndpoint._posLeft + item.targetEndpoint._width);\n          const top = item.sourceEndpoint._posTop < item.targetEndpoint._posTop ? item.sourceEndpoint._posTop : item.targetEndpoint._posTop;\n          const bottom = (item.sourceEndpoint._posTop + item.sourceEndpoint._height) > (item.targetEndpoint._posTop + item.targetEndpoint._height) ? (item.sourceEndpoint._posTop + item.sourceEndpoint._height) : (item.targetEndpoint._posTop + item.targetEndpoint._height);\n          let isSelected = _isSelected({\n            left: left,\n            right: right,\n            top: top,\n            bottom: bottom\n          });\n          if (isSelected) {\n            this.selectItem.edges.push(item);\n          }\n        } else if (item.type === 'node') {\n          // 后续补\n        }\n      });\n    }\n\n    // 框选节点组，准备支持\n\n    return this.selectItem;\n  }\n  _getAllEndpoints() {\n    let points = [];\n    points = points.concat(this.nodes.map((_node) => {\n      return _node.endpoints;\n    }));\n    points = points.concat(this.groups.map((_node) => {\n      return _node.endpoints;\n    }));\n    points = points.filter((item) => {\n      return !!item;\n    });\n    return _.flatten(points);\n  }\n  undo() {\n    let result = [];\n    if (this.actionQueueIndex <= -1) {\n      console.warn('回退堆栈已空，无法再undo');\n      return;\n    }\n    let step = this.actionQueue[this.actionQueueIndex--];\n    if (step.type === '_system:dragNodeEnd') {\n      step = this.actionQueue[this.actionQueueIndex--];\n    }\n    result.push(step);\n    if (step.type === 'system:addNodes') {\n      this.removeNodes(step.data, false, true);\n    } else if (step.type === 'system:removeNodes') {\n      this.addNodes(step.data.nodes, true);\n      this.addEdges(step.data.edges, true);\n    } else if (step.type === 'system:addEdges') {\n      this.removeEdges(step.data, true, true);\n    } else if (step.type === 'system:removeEdges') {\n      this.addEdges(step.data, true);\n    } else if (step.type === 'system:moveNodes') {\n      for (let key in step.data.nodes) {\n        let _nodeInfo = step.data.nodes[key];\n        let _node = this.getNode(key);\n        _node.moveTo(_nodeInfo.fromLeft, _nodeInfo.fromTop, true);\n      }\n    } else if (step.type === 'system:moveGroups') {\n      for (let key in step.data.groups) {\n        let _groupInfo = step.data.groups[key];\n        let _group = this.getGroup(key);\n        _group.moveTo(_groupInfo.fromLeft, _groupInfo.fromTop, true);\n      }\n    } else if (step.type === 'system:addGroups') {\n      step.data.forEach((item) => {\n        if (item.nodes.length > 0) {\n          this.removeNodes(item.nodes);\n        }\n        this.removeGroup(item.group.id, true);\n      });\n    } else if (step.type === 'system:removeGroup') {\n      this.addGroup(step.data.group, step.data.nodes || [], undefined, true);\n    } else if (step.type === 'system:groupAddMembers') {\n      let sourceGroup = step.data.sourceGroup;\n      let targetGroup = step.data.targetGroup;\n\n      if (targetGroup) {\n        targetGroup.removeNodes(step.data.nodes, true);\n      }\n\n      if (sourceGroup) {\n        sourceGroup.addNodes(step.data.nodes, true);\n      }\n\n      let _preStep = {};\n      if (step.data._isDraging) {\n        _preStep = this.actionQueue[this.actionQueueIndex];\n        if (_preStep.type === 'system:moveNodes') {\n          for (let key in _preStep.data.nodes) {\n            let _nodeInfo = _preStep.data.nodes[key];\n            let _node = this.getNode(key);\n            _node.moveTo(_nodeInfo.fromLeft, _nodeInfo.fromTop, true);\n          }\n          result.unshift(_preStep);\n        }\n      }\n\n      this.actionQueueIndex--;\n\n    } else if (step.type === 'system:groupRemoveMembers') {\n\n      let group = step.data.group;\n\n      if (group) {\n        group.addNodes(step.data.nodes, true);\n      }\n\n      let _preStep = {};\n      if (step.data._isDraging) {\n        _preStep = this.actionQueue[this.actionQueueIndex];\n        if (_preStep.type === 'system:moveNodes') {\n          for (let key in _preStep.data.nodes) {\n            let _nodeInfo = _preStep.data.nodes[key];\n            let _node = this.getNode(key);\n            _node.moveTo(_nodeInfo.fromLeft, _nodeInfo.fromTop, true);\n          }\n          result.unshift(_preStep);\n          this.actionQueueIndex--;\n        }\n      }\n\n      this.actionQueueIndex--;\n    } else if (step.type === 'system:reconnectEdges') {\n\n      _.get(step, 'data.info', []).forEach((info) => {\n        let targetNode = this.getNode(info.preTargetNodeId);\n        let targetEndpoint = targetNode.getEndpoint(info.preTargetPointId);\n        info.edge._create({\n          id: `${info.edge.sourceEndpoint.id}-${targetEndpoint.id}`,\n          targetNode: targetNode,\n          _targetType: targetEndpoint.nodeType,\n          targetEndpoint: targetEndpoint,\n          type: 'endpoint'\n        })\n      });\n    }\n\n    this.emit('system.canvas.undo', {\n      steps: result\n    });\n    this.emit('events', {\n      type: 'canvas.undo',\n      steps: result\n    });\n  }\n  redo() {\n    let result = [];\n    if (this.actionQueueIndex >= this.actionQueue.length - 1) {\n      console.warn('重做堆栈已到顶，无法再redo');\n      return;\n    }\n    let step = this.actionQueue[++this.actionQueueIndex];\n    result.push(step);\n    if (step.type === 'system:moveNodes' && step.data._isDraging) {\n      step = this.actionQueue[++this.actionQueueIndex];\n      result.push(step);\n    }\n    if (step.type === 'system:addNodes') {\n      this.addNodes(step.data, true);\n    } else if (step.type === 'system:removeNodes') {\n      this.removeNodes(step.data.nodes, false, true);\n    } else if (step.type === 'system:addEdges') {\n      this.addEdges(step.data, true);\n    } else if (step.type === 'system:removeEdges') {\n      this.removeEdges(step.data, true);\n    } else if (step.type === 'system:moveNodes') {\n      for (let key in step.data.nodes) {\n        let _nodeInfo = step.data.nodes[key];\n        let _node = this.getNode(key);\n        _node.moveTo(_nodeInfo.toLeft, _nodeInfo.toTop, true);\n      }\n    } else if (step.type === 'system:moveGroups') {\n      for (let key in step.data.groups) {\n        let _groupInfo = step.data.groups[key];\n        let _group = this.getGroup(key);\n        _group.moveTo(_groupInfo.toLeft, _groupInfo.toTop, true);\n      }\n    } else if (step.type === 'system:addGroups') {\n      step.data.forEach((item) => {\n        this.addGroup(item.group, item.nodes || [], undefined, true);\n      })\n    } else if (step.type === 'system:removeGroup') {\n      this.removeGroup(step.data.group, true);\n    } else if (step.type === 'system:groupAddMembers') {\n      let sourceGroup = step.data.sourceGroup;\n      let targetGroup = step.data.targetGroup;\n\n      let _preStep = this.actionQueue[this.actionQueueIndex - 1];\n\n      if (_preStep.type === 'system:moveNodes' && _preStep.data._isDraging) {\n        for (let key in _preStep.data.nodes) {\n          let _nodeInfo = _preStep.data.nodes[key];\n          let _node = this.getNode(key);\n          _node.moveTo(_nodeInfo.toLeft, _nodeInfo.toTop, true);\n        }\n      }\n\n      if (targetGroup) {\n        targetGroup.addNodes(step.data.nodes, true);\n      }\n\n      if (sourceGroup) {\n        sourceGroup.removeNodes(step.data.nodes, true);\n      }\n\n    } else if (step.type === 'system:groupRemoveMembers') {\n      let group = step.data.group;\n\n      if (group) {\n        group.removeNodes(step.data.nodes, true);\n      }\n\n      let _preStep = {};\n      if (step.data._isDraging) {\n        _preStep = this.actionQueue[this.actionQueueIndex];\n        if (_preStep.type === 'system:moveNodes') {\n          for (let key in _preStep.data.nodes) {\n            let _nodeInfo = _preStep.data.nodes[key];\n            let _node = this.getNode(key);\n            _node.moveTo(_nodeInfo.fromLeft, _nodeInfo.fromTop, true);\n          }\n          this.actionQueueIndex--;\n        }\n      }\n    } else if (step.type === 'system:reconnectEdges') {\n      _.get(step, 'data.info', []).forEach((info) => {\n        let targetNode = this.getNode(info.currentTargetNodeId);\n        let targetEndpoint = targetNode.getEndpoint(info.currentTargetPointId);\n        info.edge._create({\n          id: `${info.edge.sourceEndpoint.id}-${targetEndpoint.id}`,\n          targetNode: targetNode,\n          _targetType: targetEndpoint.nodeType,\n          targetEndpoint: targetEndpoint,\n          type: 'endpoint'\n        })\n      });\n    }\n\n    this.emit('system.canvas.redo', {\n      steps: result\n    });\n    this.emit('events', {\n      type: 'canvas.redo',\n      steps: result\n    });\n\n    if (_.get(this.actionQueue, [this.actionQueueIndex + 1, 'type']) === '_system:dragNodeEnd') {\n      this.actionQueueIndex++;\n    }\n  }\n  isActionQueueTop() {\n    return this.actionQueueIndex >= this.actionQueue.length - 1;\n  }\n  isActionQueueBottom() {\n    return this.actionQueueIndex <= -1;\n  }\n  pushActionQueue(option) {\n\n    let step = option;\n    //移动节点需要合并堆栈\n    if (option.type === 'system:moveNodes' || option.type === 'system:moveGroups') {\n\n      let _type = {\n        'system:moveNodes': 'node',\n        'system:moveGroups': 'group'\n      }[option.type];\n      let _types = _type + 's';\n\n      // 堆栈前一个不是moveNode\n      let currentStep = this.actionQueue[this.actionQueueIndex] || {};\n      if (currentStep.type === option.type && currentStep.data[_types][option.data[_type].id]) {\n        currentStep.data[_types][option.data[_type].id]['toTop'] = option.data.top;\n        currentStep.data[_types][option.data[_type].id]['toLeft'] = option.data.left;\n        return;\n      } else {\n        let moveItems = [option.data[_type]];\n        const unionKeys = this._findUnion(_types, option.data[_type]);\n        if (unionKeys && unionKeys.length > 0) {\n          unionKeys.forEach((key) => {\n            moveItems = moveItems.concat(this._unionData[key][_types]);\n          });\n          moveItems = _.uniqBy(moveItems, 'id');\n        }\n\n        step = {\n          type: option.type,\n          data: {\n            [_types]: {}\n          }\n        };\n\n        moveItems.forEach((item) => {\n          step.data[_types][item.id] = {\n            fromTop: item.top,\n            fromLeft: item.left,\n            toTop: item.top,\n            toLeft: item.left\n          }\n        });\n        step.data[_types][option.data[_type].id]['toTop'] = option.data.top;\n        step.data[_types][option.data[_type].id]['toLeft'] = option.data.left;\n      }\n    }\n\n    // 堆栈满了，清理\n    if (this.actionQueueIndex >= this.global.limitQueueLen) {\n      this.actionQueue.shift();\n      this.actionQueueIndex--;\n    }\n    // 把index前的步骤覆盖掉\n    this.actionQueue.splice(this.actionQueueIndex + 1, this.actionQueue.length); // todo可能有问题\n    this.actionQueue.push(step);\n    this.actionQueueIndex++;\n\n    if (_.get(this.actionQueue, [this.actionQueueIndex - 1, 'type']) === '_system:dragNodeEnd') {\n      this.actionQueue.splice(this.actionQueueIndex - 1, 1);\n      this.actionQueueIndex--;\n    }\n  }\n  popActionQueue() {\n    if (this.actionQueue.length > 0) {\n      let action = this.actionQueue.pop();\n      return action;\n    } else {\n      console.warn('操作队列已为空，请确认');\n    }\n  }\n  clearActionQueue() {\n    this.actionQueue = [];\n    this.actionQueueIndex = -1;\n  }\n  // 设置线段的z-index\n  setEdgeZIndex(edges = [], zIndex = 0) {\n    if (edges.length === 0) {\n      return;\n    }\n    edges.forEach((edge) => {\n      edge._zIndex = zIndex;\n      let index = _.findIndex(this.edges, (item) => {\n        return item === edge;\n      });\n      if (index !== -1) {\n        let delEdge = this.edges.splice(index, 1);\n        $(delEdge.dom).detach();\n        delEdge.eventHandlerDom && $(delEdge.eventHandlerDom).detach();\n        delEdge.arrowDom && $(delEdge.arrowDom).detach();\n      } else {\n        return;\n      }\n    });\n    let addIndex = this._findEdgeIndex(edges[0]);\n    let addEdgesDom = [];\n    edges.forEach((item) => {\n      addEdgesDom.push(item.dom);\n      item.eventHandlerDom && addEdgesDom.push(item.eventHandlerDom);\n      item.arrowDom && addEdgesDom.push(item.arrowDom);\n    });\n\n    // 插入dom\n    let beforeEdge = this.edges[addIndex];\n    let afterEdge = this.edges[addIndex + 1];\n    \n    if (beforeEdge) {\n      let targetDom = beforeEdge.dom;\n      beforeEdge.eventHandlerDom && (targetDom = beforeEdge.eventHandlerDom);\n      beforeEdge.arrowDom && (targetDom = beforeEdge.arrowDom);\n      $(targetDom).after(addEdgesDom);\n    } else if (afterEdge) {\n      $(afterEdge.dom).before(addEdgesDom);\n    } else {\n      $(this.svg).append(addEdgesDom);\n    }\n\n    this.edges.splice(addIndex + 1, 0 , ...edges);\n  }\n  _findEdgeIndex(edge) {\n    let index = 0;\n    let currentZIndex = edge._zIndex || 0;\n    this.edges.forEach((item, i) => {\n      if (currentZIndex < (item._zIndex || 0)) {\n        index = i;\n        return;\n      }\n      if (i === this.edges.length - 1) {\n        index = i;\n      }\n    });\n    return index;\n  }\n}\n\nexport default BaseCanvas;\n","'use strict';\n\nimport Node from './baseNode';\n\nclass TreeNode extends Node {\n  constructor(options) {\n    super(options);\n    this.children = options.children;\n    this.parent = options.parent;\n    this.collapsed = options.collapsed || false;\n    if (options.isRoot) {\n      this.isRoot = options.isRoot;\n    }\n  }\n  collapse() {\n    this._emit('InnerEvents', {\n      type: 'node:collapse',\n      nodeId: this.id\n    });\n    this.collapsed = true;\n  }\n  expand(nodes = []) {\n    this._emit('InnerEvents', {\n      type: 'node:expand',\n      nodeId: this.id,\n      nodes: nodes\n    });\n    delete this.collapsed;\n  }\n  detectLeaf() {\n    return !!!(this.children && this.children.length > 0);\n  }\n  detectRoot() {\n    return this.isRoot;\n  }\n}\n\nexport default TreeNode;","const Hierarchy = require('@antv/hierarchy');\n\nfunction tranlateData(data) {\n  let queue = [data];\n  let nodeList = [];\n  while (queue.length > 0) {\n    let node = queue.pop();\n    let newNode = node.data;\n    newNode.left = node.x;\n    newNode.top = node.y;\n    newNode.treePos = {\n      hgap: node.hgap,\n      vgap: node.vgap,\n      x: node.x,\n      y: node.y,\n      depth: node.depth,\n      side: node.side\n    };\n    nodeList.push(newNode);\n    queue = queue.concat(node.children);\n  }\n  return nodeList[0];\n}\n\nexport default {\n  compactBox: (data, options) => {\n    return tranlateData(Hierarchy.compactBox(data, options));\n  },\n  dendrogram: (data, options) => {\n    return tranlateData(Hierarchy.dendrogram(data, options));\n  },\n  indented: (data, options) => {\n    return tranlateData(Hierarchy.indented(data, options));\n  },\n  mindmap: (data, options) => {\n    return tranlateData(Hierarchy.mindmap(data, options));\n  }\n};\n","'use strict';\n\nimport Canvas from \"./baseCanvas\";\nconst _ = require('lodash');\nimport TreeNode from '../node/treeNode';\nimport Hierarchy from '../utils/layout/hierarchy';\n\nclass TreeCanvas extends Canvas {\n  constructor(options) {\n    super(options);\n    this._NodeClass = TreeNode;\n  }\n  _handleTreeNodes(data, isFlat) {\n    if (isFlat) {\n      return data;\n    } else {\n      let queue = [data];\n      let nodeList = [];\n      while (queue.length > 0) {\n        let node = queue.pop();\n        nodeList.push(node);\n        if (node.children && node.children.length > 0) {\n          node.children.forEach((child) => {\n            child.parent = node.id;\n          });\n          queue = queue.concat(node.children);\n        }\n      }\n      return nodeList;\n    }\n  }\n  _isExistNode(node) {\n    let result = super._isExistNode(node);\n    if (result && node.subCollapsed) {\n      result = false;\n    }\n    return;\n  }\n  _addEventListener() {\n    super._addEventListener();\n    this.on('InnerEvents', (data) => {\n      if (data.type === 'node:collapse') {\n        this.collapseNode(data.nodeId);\n      } else if (data.type == 'node:expand') {\n        this.expandNode(data.nodeId);\n      }\n    });\n  }\n  findSubTree(item) {\n    let queue = [item];\n    let result = [];\n    while (queue.length > 0) {\n      let _item = queue.pop();\n      result.push(_item);\n      if (_item.children?.length > 0) {\n        queue = queue.concat(_item.children);\n      }\n    }\n    return result;\n  }\n  collapseNode (nodeId) {\n    let collapseNodes = [];\n    let collapseEdges = [];\n    let targetNode = this.getNode(nodeId);\n    targetNode.collapsed = true;\n    targetNode.options.collapsed = true;\n    if (!targetNode) {\n      return;\n    }\n    let queue = [targetNode];\n    while (queue.length > 0) {\n      let node = queue.pop();\n      collapseNodes.push(node);\n      if (node.children && node.children.length > 0) {\n        queue = queue.concat(node.children);\n      }\n    }\n    // 先去掉target node做filter\n    collapseNodes = collapseNodes.filter((item) => {\n      return item.id !== targetNode.id;\n    });\n    let tmp = {};\n    collapseNodes.forEach((item) => {\n      tmp[item.id] = item;\n      item.subCollapsed = true;\n    });\n    collapseEdges = this.edges.filter((item) => {\n      let _isCollapsed = false;\n      if (item.type === 'endpoint') {\n        _isCollapsed = !!tmp[item.sourceNode.id] || !!tmp[item.targetNode.id]\n      } else {\n        _isCollapsed = !!tmp[item.source.id] || !!tmp[item.target.id];\n      }\n      if (item.sourceNode.id === targetNode.id) {\n        _isCollapsed = true;\n      }\n\n      if (_isCollapsed) {\n        item.collapsed = true;\n      }\n      return _isCollapsed;\n    });\n    collapseNodes.unshift(targetNode);\n\n    collapseNodes.forEach((item) => {\n      if (item.subCollapsed) {\n        item.destroy(true);\n      }\n\n      // 重置子节点的collapsed状态\n      if (item.id !== nodeId && item.collapsed) {\n        delete item.collapsed;\n      }\n    });\n    collapseEdges.forEach((item) => {\n      item.destroy(true);\n    });\n\n    this.redraw();\n\n    return {\n      nodes: collapseNodes,\n      edges: collapseEdges\n    }\n  }\n\n  expandNode(nodeId, nodes) {\n    let targetNode = this.getNode(nodeId);\n    let subNodes = [];\n    let collapseEdges = [];\n    let queue = [targetNode];\n    while (queue.length > 0) {\n      let node = queue.pop();\n      subNodes.push(node);\n      if (node.children && node.children.length > 0) {\n        queue = queue.concat(node.children);\n      }\n    }\n    // 先去掉target node做filter\n    subNodes = subNodes.filter((item) => {\n      return item.id !== targetNode.id;\n    });\n    let tmp = {};\n    subNodes.forEach((item) => {\n      tmp[item.id] = item;\n      item.subCollapsed = true;\n    });\n    collapseEdges = this.edges.filter((item) => {\n      let _isCollapsed = false;\n      if (item.type === 'endpoint') {\n        _isCollapsed = !!tmp[item.sourceNode.id] || !!tmp[item.targetNode.id]\n      } else {\n        _isCollapsed = !!tmp[item.source.id] || !!tmp[item.target.id];\n      }\n      if (item.sourceNode.id === targetNode.id) {\n        _isCollapsed = true;\n      }\n      return _isCollapsed;\n    });\n    this.nodes = _.differenceBy(this.nodes, subNodes, 'id');\n    this.addNodes(subNodes, true);\n    this.edges = _.filter(this.edges, (a) => {\n      if (a.type === 'endpoint') {\n        return !_.some(collapseEdges, ((b) => {\n          return a.sourceNode.id === b.sourceNode.id && a.targetNode.id === b.targetNode.id && a.source === b.source && a.target === b.target;\n        }));\n      } else {\n        return !_.some(collapseEdges, ((b) => {\n          return a.source === b.source && a.target === b.target;\n        }));\n      }\n    });\n    this.addEdges(collapseEdges, true);\n    subNodes.forEach((item) => {\n      delete item.subCollapsed;\n    });\n    delete targetNode.collapsed;\n    collapseEdges.forEach((item) => {\n      delete item.collapsed;\n    });\n    this.redraw();\n  }\n\n  redraw() {\n    let rootNode = this.getRootNode();\n    let tree = [];\n    let tmpTreeObj = {};\n    let queue = [rootNode];\n    while (queue.length > 0) {\n      let node = queue.pop();\n      let obj = {\n        id: node.id\n      };\n      if (tmpTreeObj[node.id]) {\n        obj = tmpTreeObj[node.id];\n      } else {\n        tmpTreeObj[obj.id] = obj;\n      }\n      if (node.isRoot) {\n        obj['isRoot'] = node.isRoot;\n      }\n      if (node.collapsed) {\n        obj['collapsed'] = node.collapsed;\n      }\n      tree.push(obj);\n      if (node.children && node.children.length > 0) {\n        obj.children = [];\n        node.children.forEach((child) => {\n          let _childObj = {\n            id: child.id\n          };\n          if (tmpTreeObj[child.id]) {\n            _childObj = tmpTreeObj[child.id];\n          } else {\n            tmpTreeObj[child.id] = _childObj;\n          }\n          if (child.isRoot) {\n            _childObj['isRoot'] = child.isRoot;\n          }\n          if (child.collapsed) {\n            _childObj['collapsed'] = child.collapsed;\n          }\n          obj.children.push(_childObj);\n        });\n        queue = queue.concat(node.children);\n      }\n    }\n    let nodes = tree.filter((item) => {\n      return true;\n    });\n    this._autoLayout({\n      nodes: nodes,\n      edges: [],\n      groups: []\n    });\n    this.nodes.forEach((item) => {\n      if (item.subCollapsed) {\n        return;\n      }\n      item?.endpoints?.forEach(endpoint => {\n        endpoint.updatePos();\n      });\n      let obj = tmpTreeObj[item.id];\n      if (item.top !== obj.top || item.left !== obj.left) {\n        item.options.top = obj.top;\n        item.options.left = obj.left;\n        item.options.treePos = obj.treePos;\n        item.moveTo(obj.left, obj.top);\n      }\n    });\n    this.edges.forEach((item) => {\n      item.redraw();\n    });\n  }\n  addNodes(data, isNotEventEmit) {\n    let nodes = super.addNodes(data, isNotEventEmit);\n    nodes.forEach((item) => {\n      if(item.parent) {\n        let parentNode = this.getNode(item.parent);\n        if (!_.some(parentNode.children, ['id', item.id])) {\n          !parentNode.children && (parentNode.children = []);\n          parentNode.children.push(item);\n        }\n      }\n    });\n    return nodes;\n  }\n  removeNodes(data, isNotDelEdge, isNotEventEmit) {\n\n    let nodes = data.map((item) => {\n      if (item instanceof Node) {\n        return item;\n      } else {\n        return this.getNode(item);\n      }\n    });\n\n    let rmNodes = [];\n\n    nodes.forEach((item) => {\n      let _subTree = this.findSubTree(item);\n      rmNodes = rmNodes.concat(_subTree);\n\n      // 如果是某个节点的子节点,将此节点从父节点的children中移除\n      if (item.parent) {\n        const parentNode = this.getNode(item.parent);\n\n        if (parentNode) {\n          parentNode.children = parentNode.children.filter((node) => node.id !== item.id);\n        }\n      }\n    });\n\n    rmNodes = _.unionBy(rmNodes, 'id');\n\n    let result = super.removeNodes(rmNodes, isNotDelEdge, isNotEventEmit);\n\n    return result;\n  }\n  getRootNode() {\n    return this.nodes.filter((item) => {\n      return item.isRoot;\n    })[0];\n  }\n  draw(opts, params, callback) {\n    const nodes = this._handleTreeNodes(opts.nodes || [], _.get(params, 'isFlatNode', false));\n    // 需要过滤掉collapsed的\n    super.draw({\n      nodes: nodes,\n      edges: opts.edges,\n      groups: opts.groups\n    }, () => {\n      let tmp = {};\n      this.nodes.forEach((item) => {\n        tmp[item.id] = item;\n        item.children = [];\n      });\n      this.nodes.forEach((item) => {\n        if (item.isRoot || !item.parent) {\n          return;\n        }\n        let parentNode = tmp[item.parent];\n        if (!parentNode) {\n          return;\n        }\n        !parentNode.children && (parentNode.children = []);\n        parentNode.children.unshift(item);\n      });\n      callback && callback({\n        nodes: this.nodes,\n        edges: this.edges,\n        groups: this.groups\n      });\n    });\n  }\n  // getDataMap(isFlat) {\n\n  // }\n  _autoLayout(options) {\n    let rootNode = options.nodes.filter((item) => {\n      return item.isRoot;\n    })[0];\n    if (!rootNode) {\n      return;\n    }\n\n    // 这部分需要优化\n    let type = _.get(this, 'layout.type', 'compactBox');\n    if (Hierarchy[type]) {\n      const NODE_SIZE = 16;\n      const NODE_WIDTH = 30;\n      const PEM = 5;\n      Hierarchy[type](rootNode, _.assign({\n        direction: 'H',\n        getId(d) {\n          return d.id;\n        },\n        getHeight(d) {\n          if (d.isRoot) {\n            return NODE_SIZE * 2;\n          }\n          return NODE_SIZE;\n        },\n        getWidth(d) {\n          if (d.isRoot) {\n            return NODE_WIDTH * 2;\n          }\n          return NODE_WIDTH;\n        },\n        getHGap(d) {\n          return 100;\n        },\n        getVGap(d) {\n          return 30;\n        },\n        getSubTreeSep(d) {\n          if (!d.children || !d.children.length) {\n            return 0;\n          }\n          return PEM;\n        }\n      }, _.get(this, 'layout.options', {})));\n    }\n  }\n}\n\nexport default TreeCanvas;","'use strict';\n\nimport './toolTip.less';\n\nconst $ = require('jquery');\n\nconst DEFUALT = {\n  TEMPLATE:\n    '<div class=\"butterfly-tooltip-container\"><div class=\"butterfly-tooltip-arrow\"></div><div class=\"butterfly-tooltip-inner\"></div></div>',\n  $viewAppend: 'body',\n  $viewCon: {\n    tips: '.butterfly-tips',\n    menu: '.butterfly-menu',\n    common: '.butterfly-tooltip-container'\n  },\n  $inner: '.butterfly-tooltip-inner'\n};\n\nconst _toFixed_3 = (num) => {\n  if (!num) {\n    return 0;\n  }\n  if (Number(num)) {\n    return Number(parseFloat(num).toFixed(3));\n  }\n};\n\nconst _getTipOffset = (placement, pos) => {\n  const _pos = {};\n  let { left, top, width, height, actualWidth, actualHeight } = pos;\n  left = _toFixed_3(left);\n  top = _toFixed_3(top);\n  width = _toFixed_3(width);\n  height = _toFixed_3(height);\n  actualWidth = _toFixed_3(actualWidth);\n  actualHeight = _toFixed_3(actualHeight);\n\n  switch (placement) {\n    case 'top':\n      _pos.left = left + width / 2 - actualWidth / 2;\n      _pos.top = top - actualHeight - 5;\n      break;\n    case 'left':\n      _pos.left = left - actualWidth - 5;\n      _pos.top = top + height / 2 - actualHeight / 2;\n      break;\n    case 'right':\n      _pos.left = left + width + 5;\n      _pos.top = top + height / 2 - actualHeight / 2;\n      break;\n    case 'bottom':\n      _pos.left = left + width / 2 - actualWidth / 2;\n      _pos.top = top + height + 5;\n      break;\n    default:\n      _pos.left = left + width / 2 - actualWidth / 2;\n      _pos.top = top - height - 5;\n  }\n  return _pos;\n};\n\nconst show = (opts, type, tipsDom, targetDom, callback) => {\n  $(DEFUALT.$viewCon[type]).remove();\n\n  let tipsContainer = $(DEFUALT.TEMPLATE);\n  tipsContainer.find(DEFUALT.$inner).append(tipsDom);\n  $(tipsContainer).appendTo(DEFUALT.$viewAppend);\n\n  let placement = opts.placement || 'top';\n\n  $(tipsContainer)\n    .addClass(DEFUALT.$viewCon[type].replace('.', ''))\n    .addClass(placement)\n    .addClass('in'); // todo in的动画\n  if (opts.className) {\n    tipsContainer.addClass(opts.className);\n  }\n\n  const pos = {\n    top: $(targetDom).offset().top,\n    left: $(targetDom).offset().left,\n    width: $(targetDom).outerWidth(),\n    height: $(targetDom).outerHeight(),\n    actualWidth: $(tipsContainer).outerWidth(),\n    actualHeight: $(tipsContainer).outerHeight()\n  };\n\n  let posInit = {}\n  if (opts.x || opts.x === 0) {\n    posInit = {\n      left: opts.x,\n      top: opts.y\n    }\n  } else {\n    posInit = _getTipOffset(placement, pos);\n  }\n\n  const position = `top: ${posInit.top}px; left: ${posInit.left}px;`;\n  $(tipsContainer).attr('style', position);\n  callback && callback(tipsContainer[0]);\n  return tipsContainer[0];\n}\n\nconst hide = (tipsDom, callback) => {\n  $(tipsDom).removeClass('in').remove();\n  callback && callback(tipsDom);\n};\n\nlet createTip = (opts, callback) => {\n  let currentTips = null;\n  let {data, targetDom, genTipDom} = opts;\n  targetDom.addEventListener('mouseover', (e) => {\n    // e.preventDefault();\n    // e.stopPropagation();\n    let tipstDom = genTipDom(data);\n    currentTips = show(opts, 'tips', tipstDom, targetDom, callback);\n  });\n\n  targetDom.addEventListener('mouseout', (e) => {\n    // e.preventDefault();\n    // e.stopPropagation();\n    hide(currentTips);\n  });\n};\n\nlet currentMenu = null;\nlet _hideMenu = (e) => {\n  if (e.target === currentMenu || $(currentMenu).find(e.target).length > 0) {\n    return ;\n  }\n  currentMenu && hide(currentMenu);\n  document.removeEventListener('click', _hideMenu);\n}\nlet createMenu = (opts, callback) => {\n  let {data, targetDom, genTipDom} = opts;\n  let _createMenu = () => {\n    let tipstDom = genTipDom(data);\n    currentMenu = show(opts, 'menu', tipstDom, targetDom, callback);\n    if (opts.closable) {\n      document.addEventListener('click', _hideMenu);\n    }\n  }\n  if (opts.action === 'click') {\n    targetDom.addEventListener('click', _createMenu);\n  } else {\n    _createMenu();\n  }\n}\n\nlet closeMenu = (callback) => {\n  hide(currentMenu, callback);\n  document.removeEventListener('click', _hideMenu);\n}\n\nexport default {\n  createTip,\n  createMenu,\n  closeMenu\n};","'use strict';\n\nconst _ = require('lodash');\n\nimport Canvas from './src/canvas/baseCanvas';\nimport TreeCanvas from './src/canvas/treeCanvas';\nimport Edge from './src/edge/baseEdge';\nimport Endpoint from './src/endpoint/baseEndpoint';\nimport Group from './src/group/baseGroup';\nimport Node from './src/node/baseNode';\nimport TreeNode from './src/node/treeNode';\nimport Minimap from './src/utils/minimap';\nimport Tips from './src/utils/toolTip';\nimport Layout from './src/utils/layout/layout';\nimport './src/index.less';\n\nmodule.exports = {\n  Canvas,\n  TreeCanvas,\n  Edge,\n  Endpoint,\n  Group,\n  Node,\n  TreeNode,\n  Minimap,\n  Tips,\n  Layout\n};\n"],"names":["EventEmit3","require","Canvas","Node","Endpoint","$","_","BaseEndpoint","opts","id","options","orientation","pos","type","nodeType","get","nodeId","root","scope","expandArea","limitNum","__type","_node","_global","_on","_emit","_top","_left","_posTop","_posLeft","_width","_height","_linkable","_coordinateService","dom","_isInitedDom","obj","draw","outerWidth","outerHeight","_terminal2canvas","offset","left","scrollLeft","top","scrollTop","attachEvent","_dom","attr","_currentNode","_currentDom","_currentNodeType","nodeW","nodeH","targetDom","targetDomW","targetDomH","find","width","height","eOffsetX","eOffsetY","_offsetTop","_offsetLeft","_orientation","_pos","result","_ox","_oy","_px","_py","nodeDomOffsets","targetDomOffsets","_group","css","updated","x","y","addClass","removeClass","on","e","LEFT_KEY","button","preventDefault","stopPropagation","emit","data","isNotEvent","off","remove","removeAllListeners","detach","BaseNode","group","draggable","endpoints","_endpointsData","_endpointLimitNum","_isMoving","node","undefined","isInited","EndpointClass","Class","endpoint","assign","global","push","pointId","rmEndpointIndex","findIndex","point","rmEndpoint","splice","destroy","_isInited","_isDeleteGroup","_addEventListener","forEach","item","moveTo","isNotEventEmit","addEndpoint","map","includes","target","nodeName","setDraggable","callback","MINDIST","TOL","TOLxTOL","LEFT","RIGHT","TOP","BOTTOM","Point","drawBezier","sourcePoint","targetPoint","_calcOrientation","Math","abs","_sx","_sy","_tx","_ty","_so","_to","sourceCtrlPoint","_findControlPoint","targetCtrlPoint","offsetX","offsetY","concat","join","drawAdvancedBezier","dist","sqrt","percent","minorDist","so_offsetX","so_offsetY","to_offsetX","to_offsetY","drawStraight","drawFlow","orientationLimit","stub","midpoint","w","h","sx","sy","tx","ty","so","to","oProduct","sourceAxis","startStubX","startStubY","endStubX","endStubY","isXGreaterThanStubTimes2","isYGreaterThanStubTimes2","anchorOrientation","_commonStubCalculator","stubCalculators","perpendicular","orthogonal","opposite","axis","idx","areInProximity","lastx","lasty","segments","_sgn","n","_addSegment","lx","ly","o","sgnx","sgny","stubs","oidx","ss","oss","es","oes","midx","midy","orientations","_lineCalculators","sis","midLines","linesToEnd","startToEnd","startToMidToEnd","otherStubs","soIdx","toIdx","otherFlipped","stub1","stub2","segmentIndexes","_quadrant","p1","p2","segment","startStub","otherStartStub","endStub","otherEndStub","extent","min","max","comparator","p","i","length","_drawFlowSegment","drawManhattan","pointArr","fromPt","toPt","_route","path","reduce","current","next","lw","_drawStraight","d","x1","y1","x2","y2","cloneDeep","dx","dy","_line","beginX","beginY","endX","endY","_calcWithLimit","rank","isInLimit","some","limit","posX","posY","k","majorAnchor","minorAnchor","conn","fromDir","toDir","xDiff","yDiff","dir","arrow","default1","calcSlope","shapeType","arrowPosition","coordinates","split","p0","getPointAtLength","getTotalLength","_initTime","Date","getTime","init","_svg","addAnimate","animateDom","_animateDom","circle","motion","document","createElementNS","append","_isContinue","_startTime","setAttribute","radius","color","dur","repeatCount","setTimeout","parseFloat","parseInt","insertAfter","Edge","BaseEdge","targetNode","_targetType","targetEndpoint","sourceNode","_sourceType","sourceEndpoint","label","arrowOffset","isExpandWidth","defaultAnimate","labelDom","arrowDom","eventHandlerDom","_path","_isDeletingEdge","_labelWidth","_labelHeight","_updateTimer","_UPDATE_INTERVAL","_sourcePoint","_targetPoint","_zIndex","drawLabel","drawArrow","calcPath","DrawUtil","pathLength","centerPoint","offsetWidth","offsetHeight","isDom","HTMLElement","createElement","className","innerText","arrowFinalPosition","ArrowUtil","vector","deg","atan2","PI","_calcPath","redrawLabel","redrawArrow","redrawAnimate","LinkAnimateUtil","num","index","edge","_emitEvent","set","redraw","Group","scope1","scope2","isScopeStrict","_scope1","filter","_scope2","totalScope","uniqScope","uniq","BaseGroup","resize","nodes","_container","titleDom","text","setResize","ScopeCompare","console","log","addNodes","rmNodes","targetGroup","removeNodes","flat","container","resizeDom","mouseDown","event","icon","appendTo","updatePos","isChildNodeMoving","indexOf","circleLayout","params","_isCircle","_preAngle","_halfWidth","getWidth","_halfHeight","getHeight","radian","angle","sin","cos","_textTop","_textLeft","posInfo","SPEED_DIVISOR","fruchterman","param","self","center","nodeMap","nodeIdxMap","isNumber","random","run","edges","maxIteration","window","innerWidth","innerHeight","maxDisplace","gravity","speed","clustering","clusterMap","cluster","name","cx","cy","count","c","key","displacements","j","applyCalculate","clusterGravity","distLength","gravityForce","limitedDist","calRepulsive","calAttractive","v","u","vecX","vecY","vecLengthSqr","sign","common","source","uIndex","vIndex","vecLength","module","gridLayout","layoutNodes","sortBy","isNaN","degree","values","getDegree","sort","n1","n2","oRows","rows","oCols","cols","columns","cells","ceil","splits","round","cellWidth","cellHeight","condense","preventOverlap","nodew","nodeh","size","nodeSize","preventOverlapPadding","cellUsed","row","col","id2manPos","rcPos","position","used","use","getPos","degrees","moveToNextCell","begin","forceLayout","groupNodes","groups","_edge","souceNode","simulation","d3","forceSimulation","force","chargeStrength","forceManyBody","strength","forceCenter","forceLink","link","distance","stop","alphaMin","alphaDecay","tick","concentLayout","minNodeSpacing","sweep","equidistant","startAngle","clockwise","maxLevelDiff","curnode","curedges","maxValueNode","maxNodeSize","isArray","isString","len","levels","currentLevel","diff","minDist","firstLvlHasMulti","maxR","rStep","r","level","dTheta","dcos","dsin","rMin","rDeltaMax","rr","rDelta","theta","drageLayout","rankdir","nodesepFunc","ranksepFunc","nodesep","ranksep","controlPoints","g","dagre","graphlib","Graph","nodeSizeFunc","horisep","getFunc","vertisep","verti","hori","setNode","setEdge","weight","setDefaultEdgeLabel","setGraph","layout","coord","it","_out","_in","_preds","_sucs","shape","points","slice","func","value","defaultValue","resultFunc","MDS","distances","dimension","linkDistance","M","MLMatrix","mul","pow","rowMeans","mean","colMeans","totalMean","add","subRowVector","subColumnVector","ret","SingularValueDecomposition","eigenValues","diagonalMatrix","diagonal","leftSingularVectors","toJSON","res","RadialNonoverlapForce","positions","adjMatrix","focusID","radii","iterations","strictRadial","disp","getRepulsion","updatePositions","vecx","vecy","f","di","vx","vy","vLength","vpx","vpy","diLength","alpha","acos","tdispLength","nfDis","floydWarshall","Infinity","getAdjMatrix","directed","matrix","Error","sIndex","tIndex","getWeightMatrix","getIndexById","array","a","getEDistance","RadialLayout","focusNode","String","found","focusIndex","D","maxDistance","maxToFocus","handleInfinity","focusNodeD","semiWidth","semiHeight","maxRadius","maxD","unitRadius","eIdealD","eIdealDisMatrix","eIdealDistances","W","weights","mds","nodeSpacing","nodeSpacingFunc","isFunction","nonoverlapForceParams","maxPreventOverlapIteration","nonoverlapForce","eIdealDis","oneIteration","vparam","originDis","reciODis","xMolecule","yMolecule","denominator","edis","reciEdis","idealDis","reciR","linkDis","newRow","sortStrength","iValue","jValue","charCodeAt","step","minus","forceTreeLayout","forceX","forceY","treeLayout","Layout","radial","SelectCanvas","cxt","getContext","canvasTop","canvasLeft","canvasHeight","canvasWidth","canScrollX","canScrollY","startX","startY","isDraw","isActive","addEventListener","bind","mouseUp","mouseMove","mouseLeave","evt","clientX","clientY","clearCanvas","toDirection","startLeft","startTop","endLeft","endTop","range","unActive","drawRect","beginPath","rect","fillStyle","fill","lineWidth","strokeStyle","stroke","clearRect","terScrollX","terScrollY","CoordinateService","canvas","terOffsetX","terOffsetY","terWidth","terHeight","canOffsetX","canOffsetY","scale","scrollTimer","_calcScrollPos","originX","originY","_currentTerX","_currentTerY","_lastScale","_isChangeOrigin","wrapper","style","transformOrigin","_isChangeMouse","mouseX","mouseY","oldOffset","_localtionX","_localtionY","newOriginX","newOriginY","_newLeft","_newTop","move","_canvas2terminal","coordinate","transformOriginX","transformOriginY","rectSize","getBoundingClientRect","GridService","domWrapper","theme","gap","adsorbGap","backgroud","lineColor","circleRadiu","circleColor","merge","_resize","createCircle","createLine","_ctx","_p","_gap","arc","lineTo","closePath","_justifyItem","_ex","_ey","_right","_bottom","_posRight","_posBottom","right","bottom","_moveNode","_moveGroup","GuidelineService","guideLineCanvas","process","floor","_leftDis","_rightDis","_topDis","_bottomDis","_leftItem","_rightItem","_topItem","_bottomItem","_groupLeft","_groupRight","_groupTop","_groupBottom","_nodeLeft","_nodeRight","_nodeTop","_nodeBottom","guidLine","transform","DOT_COLOR","GROUP_COLOR","DOT_ACTIVE_COLOR","GROUP_ACTIVE_COLOR","SAFE_DISTANCE","modifyCSS","ele","cssStyle","Object","keys","getPixelRatio","context","backingStore","backingStorePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","devicePixelRatio","checkOpts","terminal2canvas","Minimap","canvas2terminal","$root","rleft","rtop","leftTop","rightBottom","screenLeftTop","screenRightBottom","$viewport","viewportDOM","parent","offsetParent","poffset","debounce","renderViewPort","renderBG","containerStyle","viewportStyle","backgroudStyle","nodeColor","groupColor","activeNodeColor","activeGroupColor","containerWidth","containerHeight","zoom","safeDistance","ratio","initContainer","getItemsPoint","check","allNTop","allNLeft","allNBottom","allNRight","allGTop","allGLeft","allGBottom","allGRight","allTop","allLeft","allBottom","allRight","minX","minY","maxX","maxY","graphSize","getBBox","Number","toFixed","debounceRender","backgroundDOM","initStyle","overflow","border","appendChild","initBGCanvas","initViewportEvts","canvasDom","cvsCtx","cvsRatio","dragging","viewportEvents","mousedown","viewportBBox","getViewportBBox","mousemove","isNil","mapWidth","mapHeight","vpWidth","vpHeight","boffset","ddx","ddy","mouseleave","mouseup","minimapActive","fillRect","setRatio","rootWidth","rootHeight","vwidth","vheight","vleft","vtop","removeChild","domtoimage","BaseCanvas","zoomable","moveable","linkable","disLinkable","isRepeat","isLinkMyself","linkableHighlight","zoomGap","autoFixCanvas","enable","autoMovePadding","autoResizeRootSize","limitQueueLen","_zoomData","_moveData","_zoomTimer","isSelectMode","selecContents","selecMode","selectItem","_remarkZoom","_remarkMove","svg","canvasWrapper","_genWrapper","_genSvgWrapper","_genCanvasWrapper","_dragType","_dragNode","_dragEndpoint","_dragEdges","_dragGroup","_rootWidth","_rootHeight","_dragGroupZIndex","_dragNodeZIndex","_dragEdgeZindex","_isInitEdgeZIndex","_hoverGroupQueue","_hoverGroupObj","_hoverGroupTimer","_gridService","_guidelineService","_bgObjQueue","_bgObj","_bgTimer","_unionData","__system","_NodeClass","actionQueue","actionQueueIndex","_autoMoveDir","_autoMoveTimer","_changeCanvasInfo","_autoLayout","drawPromise","Promise","resolve","reject","addGroups","then","addEdges","removeGroups","clearActionQueue","GroupClass","_newNodes","_groupObj","_isExistGroup","warn","prepend","_createEndpoint","mounted","_isAbsolutePos","_moveTo","newNode","_existNode","__node","removeNode","_init","addNode","_nodeObj","_groupWidth","_groupHeight","_w","_h","setSize","pushActionQueue","_canvasFragment","createDocumentFragment","_existGroup","getGroup","_isExistNode","initObj","existGroup","_appendNodes","links","_edgeFragment","_labelFragment","EdgeClass","getNode","getEndpoint","_isRepeat","_result","_tmpType","_soucePoint","datas","addGroup","isNotDelEdge","nodeIds","rmEdges","neighborEdges","getNeighborEdges","removeEdges","_rmNodes","isNotPushActionQueue","edgeIndex","_rmEdge","isExistEdge","groupId","_isDeleting","insideNodes","rmItem","rmNode","groupIds","rmGroups","removeGroup","iteratee","quene","visited","Set","adjTable","getAdjcentTable","flatMap","shift","$node","$endpoint","$level","has","neighbors","neighborsWithEndpoint","neighbor","$nNode","sourceNodeId","sourceEndpointId","targetNodeId","targetEndpointId","zoomDirection","_zoomDirection","_zoomCb","deltaY","platform","girdWrapper","removeEventListener","canLeft","canRight","canTop","canBottom","customOffset","canDisX","terDisX","canDisY","terDisY","scaleX","scaleY","terLeft","terRight","terTop","terBottom","time","animate","focusNodesWithAnimate","containerW","containerH","targetY","targetX","frame","interval","clearInterval","setInterval","_canvasInfo","toString","replace","contents","_rmSystemUnion","active","setZoomable","setMoveable","_isResize","pop","create","events","updateEvts","getNodes","getGroups","minimap","getZoom","getOffset","updateFn","update","ev","error","_data","isId","uniqBy","getEdge","isExist","_item","method","dataUrl","justifyAllCoordinate","_detectMob","toMatch","toMatchItem","navigator","userAgent","match","_isMobi","_SVGWidth","_SVGHeight","_detectZoom","screen","ua","toLowerCase","deviceXDPI","logicalXDPI","_sclae","onresize","wrapperOffset","svgOffset","_isChrome","test","vendor","_getChromeVersion","raw","_isHightVerChrome","ResizeObserver","_resizeObserver","entries","setGirdMode","observe","_addEndpoint","_point","_selectMultiplyItem","removeEdge","_hasNode","setEdgeZIndex","_attachMouseDownEvent","hasNodes","hasGroups","initOtps","endpointDom","rx","by","isInGroup","_findGroupByCoordinates","canvasOriginPos","nodeOriginPos","_isActiveEndpoint","_activeItems","_activeLinkableEndpoint","_allPoints","_getAllEndpoints","canLink","_unActiveLinkableEndpoint","unLinkable","unHoverLinkable","_oldFocusPoint","_isFocusing","_focusLinkableEndpoint","_points","_focusPoint","_maxX","_maxY","_minX","_minY","hoverLinkable","_clearDraging","mouseDownEvent","LEFT_BUTTON","dispatchEvent","MouseEvent","dragType","dragNode","dragEndpoint","dragEdges","dragGroup","canvasX","canvasY","mouseMoveEvent","moveNodes","unionKeys","_findUnion","_hoverGroup","_autoMoveCanvas","_isSourceEndpoint","_isTargetEndpoint","_sourceNode","_sourceEndpoint","pointObj","_linkNums","_newEdge","targetEdge","_newWidth","_newHeight","mouseEndEvent","_unionNodes","_targetEndpoint","_nodes","isDestoryEdges","_linkNum","_delEdges","_reconnectInfo","_emitEdges","_preTargetNodeId","_preTargetPointId","_currentTargetNode","_currentTargetEndpoint","preTargetNodeId","preTargetPointId","currentTargetNodeId","currentTargetPointId","_create","_isConnect","isConnect","delLinks","addLinks","info","_handleDragNode","sourceGroup","_updateNeighborEdge","nodeData","_isDraging","popActionQueue","_clearHoverGroup","unionNodes","mouseLeaveEvent","cb","_terOffsetX","_terOffsetY","_autoMovePadding","MOVE_GAP","_moveTarget","_isInGroup","groupObj","groupType","_groupW","_groupH","_nodeW","_nodeH","isLink","hasUpdate","_opts","extend","align","includeNode","includeEdge","includeEndpoint","_isSelected","option","_itemLeft","_itemRight","_itemTop","_itemBottom","nodeLeft","nodeRight","nodeTop","nodeBottom","isSelected","pointLeft","pointRight","pointTop","pointBottom","flatten","_nodeInfo","fromLeft","fromTop","_groupInfo","_preStep","unshift","steps","toLeft","toTop","_type","_types","currentStep","moveItems","action","zIndex","delEdge","addIndex","_findEdgeIndex","addEdgesDom","beforeEdge","afterEdge","after","before","currentZIndex","TreeNode","children","collapsed","isRoot","Hierarchy","tranlateData","queue","nodeList","treePos","hgap","vgap","depth","side","compactBox","dendrogram","indented","mindmap","TreeCanvas","isFlat","child","subCollapsed","collapseNode","expandNode","collapseNodes","collapseEdges","tmp","_isCollapsed","subNodes","differenceBy","b","rootNode","getRootNode","tree","tmpTreeObj","_childObj","parentNode","_subTree","findSubTree","unionBy","_handleTreeNodes","NODE_SIZE","NODE_WIDTH","PEM","direction","getId","getHGap","getVGap","getSubTreeSep","DEFUALT","TEMPLATE","$viewAppend","$viewCon","tips","menu","$inner","_toFixed_3","_getTipOffset","placement","actualWidth","actualHeight","show","tipsDom","tipsContainer","posInit","hide","createTip","currentTips","genTipDom","tipstDom","currentMenu","_hideMenu","createMenu","_createMenu","closable","closeMenu","exports","Tips"],"mappings":"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"}